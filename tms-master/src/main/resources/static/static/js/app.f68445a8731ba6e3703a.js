webpackJsonp([1],{"0XQa":function(t,e){},"2/Do":function(t,e){},"2WvI":function(t,e){},"4gtQ":function(t,e){},"9QEf":function(t,e){},"9TkA":function(t,e){},AaCG:function(t,e){},G2V6:function(t,e){},GGDo:function(t,e){},NHnr:function(t,e,a){"use strict";function i(t){return null!=t&&t==t.window}function l(t){return null==t?String(t):E[R.call(t)]||"object"}function o(t){if(!t||"object"!==l(t)||i(t))return!1;try{if(t.constructor&&!z.call(t,"constructor")&&!z.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var e;for(e in t);return void 0===e||z.call(t,e)}function r(t){throw new Error(t)}function n(t,e,a){if("lower"===a)for(var i in t)A.isPlainObject(t[i])||A.isArray(t[i])?e[i.toLowerCase()]=s(t[i],a):e[i.toLowerCase()]=t[i];else if("upper"===a)for(var i in t)A.isPlainObject(t[i])||A.isArray(t[i])?e[i.toUpperCase()]=s(t[i],a):e[i.toUpperCase()]=t[i];return e}function s(t,e){var a,i;return i=e||"lower",o(t)?(a={},n(t,a,i)):A.isArray(t)?(a=[],n(t,a,i)):t}function c(t){return d(u(m(t)))}function u(t){return p(h(f(t),8*t.length))}function d(t){for(var e,a=Z?"0123456789ABCDEF":"0123456789abcdef",i="",l=0;l<t.length;l++)e=t.charCodeAt(l),i+=a.charAt(e>>>4&15)+a.charAt(15&e);return i}function m(t){for(var e,a,i="",l=-1;++l<t.length;)e=t.charCodeAt(l),a=l+1<t.length?t.charCodeAt(l+1):0,55296<=e&&e<=56319&&56320<=a&&a<=57343&&(e=65536+((1023&e)<<10)+(1023&a),l++),e<=127?i+=String.fromCharCode(e):e<=2047?i+=String.fromCharCode(192|e>>>6&31,128|63&e):e<=65535?i+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):e<=2097151&&(i+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return i}function f(t){for(var e=Array(t.length>>2),a=0;a<e.length;a++)e[a]=0;for(a=0;a<8*t.length;a+=8)e[a>>5]|=(255&t.charCodeAt(a/8))<<a%32;return e}function p(t){for(var e="",a=0;a<32*t.length;a+=8)e+=String.fromCharCode(t[a>>5]>>>a%32&255);return e}function h(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var a=1732584193,i=-271733879,l=-1732584194,o=271733878,r=0;r<t.length;r+=16){var n=a,s=i,c=l,u=o;i=y(i=y(i=y(i=y(i=_(i=_(i=_(i=_(i=b(i=b(i=b(i=b(i=v(i=v(i=v(i=v(i,l=v(l,o=v(o,a=v(a,i,l,o,t[r+0],7,-680876936),i,l,t[r+1],12,-389564586),a,i,t[r+2],17,606105819),o,a,t[r+3],22,-1044525330),l=v(l,o=v(o,a=v(a,i,l,o,t[r+4],7,-176418897),i,l,t[r+5],12,1200080426),a,i,t[r+6],17,-1473231341),o,a,t[r+7],22,-45705983),l=v(l,o=v(o,a=v(a,i,l,o,t[r+8],7,1770035416),i,l,t[r+9],12,-1958414417),a,i,t[r+10],17,-42063),o,a,t[r+11],22,-1990404162),l=v(l,o=v(o,a=v(a,i,l,o,t[r+12],7,1804603682),i,l,t[r+13],12,-40341101),a,i,t[r+14],17,-1502002290),o,a,t[r+15],22,1236535329),l=b(l,o=b(o,a=b(a,i,l,o,t[r+1],5,-165796510),i,l,t[r+6],9,-1069501632),a,i,t[r+11],14,643717713),o,a,t[r+0],20,-373897302),l=b(l,o=b(o,a=b(a,i,l,o,t[r+5],5,-701558691),i,l,t[r+10],9,38016083),a,i,t[r+15],14,-660478335),o,a,t[r+4],20,-405537848),l=b(l,o=b(o,a=b(a,i,l,o,t[r+9],5,568446438),i,l,t[r+14],9,-1019803690),a,i,t[r+3],14,-187363961),o,a,t[r+8],20,1163531501),l=b(l,o=b(o,a=b(a,i,l,o,t[r+13],5,-1444681467),i,l,t[r+2],9,-51403784),a,i,t[r+7],14,1735328473),o,a,t[r+12],20,-1926607734),l=_(l,o=_(o,a=_(a,i,l,o,t[r+5],4,-378558),i,l,t[r+8],11,-2022574463),a,i,t[r+11],16,1839030562),o,a,t[r+14],23,-35309556),l=_(l,o=_(o,a=_(a,i,l,o,t[r+1],4,-1530992060),i,l,t[r+4],11,1272893353),a,i,t[r+7],16,-155497632),o,a,t[r+10],23,-1094730640),l=_(l,o=_(o,a=_(a,i,l,o,t[r+13],4,681279174),i,l,t[r+0],11,-358537222),a,i,t[r+3],16,-722521979),o,a,t[r+6],23,76029189),l=_(l,o=_(o,a=_(a,i,l,o,t[r+9],4,-640364487),i,l,t[r+12],11,-421815835),a,i,t[r+15],16,530742520),o,a,t[r+2],23,-995338651),l=y(l,o=y(o,a=y(a,i,l,o,t[r+0],6,-198630844),i,l,t[r+7],10,1126891415),a,i,t[r+14],15,-1416354905),o,a,t[r+5],21,-57434055),l=y(l,o=y(o,a=y(a,i,l,o,t[r+12],6,1700485571),i,l,t[r+3],10,-1894986606),a,i,t[r+10],15,-1051523),o,a,t[r+1],21,-2054922799),l=y(l,o=y(o,a=y(a,i,l,o,t[r+8],6,1873313359),i,l,t[r+15],10,-30611744),a,i,t[r+6],15,-1560198380),o,a,t[r+13],21,1309151649),l=y(l,o=y(o,a=y(a,i,l,o,t[r+4],6,-145523070),i,l,t[r+11],10,-1120210379),a,i,t[r+2],15,718787259),o,a,t[r+9],21,-343485551),a=F(a,n),i=F(i,s),l=F(l,c),o=F(o,u)}return Array(a,i,l,o)}function g(t,e,a,i,l,o){return F(function(t,e){return t<<e|t>>>32-e}(F(F(e,t),F(i,o)),l),a)}function v(t,e,a,i,l,o,r){return g(e&a|~e&i,t,e,l,o,r)}function b(t,e,a,i,l,o,r){return g(e&i|a&~i,t,e,l,o,r)}function _(t,e,a,i,l,o,r){return g(e^a^i,t,e,l,o,r)}function y(t,e,a,i,l,o,r){return g(a^(e|~i),t,e,l,o,r)}function F(t,e){var a=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(a>>16)<<16|65535&a}Object.defineProperty(e,"__esModule",{value:!0});var D=a("XwMK"),w={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("transition",{attrs:{name:"slide-fade"}},[e("router-view")],1)],1)},staticRenderFns:[]},x=a("/Xao")({name:"app"},w,!1,function(t){a("U/hr")},null,null).exports,S=a("zO6J"),C=a("aA9S"),k=a.n(C),$=a("2sCs"),L=a.n($),I=a("hRKE"),P=a.n(I),V=a("HzJ8"),T=a.n(V),R=Object.prototype.toString,z=Object.prototype.hasOwnProperty,N=(Array.prototype.push,Array.prototype.slice,String.prototype.trim),E=(Array.prototype.indexOf,{}),q=["\\","$","(",")","*","+",".","[","]","?","^","{","}","|"],A={escapeExprSpecialWord:function(t){if(!t||""===t)return"";var e=!0,a=!1,i=void 0;try{for(var l,o=T()(q);!(e=(l=o.next()).done);e=!0){var r=l.value;t.includes(r)&&(t=t.replace(r,"\\"+r))}}catch(t){a=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(a)throw i}}return t},getWebRootPath:function(){var t=window.document.location.pathname,e=t.substring(0,t.substr(1).indexOf("/")+1);return console.log("projectName",e),e},isFunction:function(t){return"function"===l(t)},renderDate:function(t){if(0==t||"undefined"==t||null==t||""==t)return"";try{var e=new Date(parseInt(t,10)),a=(e.getMonth()+1).toString(),i=e.getFullYear().toString(),l=e.getDate().toString();return[i,a.length<2?"-0":"-",a,l.length<2?"-0":"-",l].join("")}catch(e){return t}},renderDateTime:function(t){if(0==t||"undefined"==t||null==t||""==t)return"";try{var e=new Date(parseInt(t,10)),a=(e.getMonth()+1).toString(),i=e.getFullYear().toString(),l=e.getDate().toString(),o=e.getHours().toString(),r=e.getMinutes().toString(),n=e.getSeconds().toString();return[i,a.length<2?"-0":"-",a,l.length<2?"-0":"-",l,o.length<2?" 0":" ",o,r.length<2?":0":":",r,n.length<2?":0":":",n].join("")}catch(e){return t}},isArray:Array.isArray||function(t){return"array"===l(t)},isWindow:i,isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},isNumber:function(t,e,a){var i="^";return e?"-"==e&&(i+="-"):i+="-?",i+=a?"0"==a?"(0|([1-9]+\\d*))$":"\\d+(\\.\\d{1,"+a+"})?$":"\\d+(\\.\\d+)?$",new RegExp(i,"g").test(t)},type:l,isPlainObject:o,isEmptyObject:function(t){for(var e in t)return!1;return!0},error:r,parseJSON:function(t){return"string"==typeof t&&t?(t=A.trim(t),window.JSON&&window.JSON.parse?window.JSON.parse(t):rvalidchars.test(t.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))?new Function("return "+t)():void r("Invalid JSON: "+t)):null},noop:function(){},trim:N?function(t){return null==t?"":N.call(t)}:function(t){return null==t?"":t.toString().replace(trimLeft,"").replace(trimRight,"")},toggleObjKey:s,formatMoney:function(t,e,a){if(IsNumber(t)){e=e>0&&e<=20?e:2,a=void 0===a?"":a,t=parseFloat((t+"").replace(/[^\d\.-]/g,""));for(var i=new Number(t+1).toFixed(e),l=(t=new Number(i-1).toFixed(e)+"").split(".")[0].split("").reverse(),o=t.split(".")[1],r="",n=0;n<l.length;n++)r+=l[n]+((n+1)%3==0&&n+1!=l.length?a:"");return r.split("").reverse().join("")+"."+o.substring(0,e)}return""},isEmpty:function(t){return""===t||null===t||void 0===t},extend:function(){var t,e,a,i,l,o,r=arguments[0]||{},n=1,s=arguments.length,c=!1;for("boolean"==typeof r&&(c=r,r=arguments[1]||{},n=2),"object"===(void 0===r?"undefined":P()(r))||A.isFunction(r)||(r={}),s===n&&(r=this,--n);n<s;n++)if(null!=(t=arguments[n]))for(e in t)a=r[e],r!==(i=t[e])&&(c&&i&&(A.isPlainObject(i)||(l=A.isArray(i)))?(l?(l=!1,o=a&&A.isArray(a)?a:[]):o=a&&A.isPlainObject(a)?a:{},r[e]=A.extend(c,o,i)):void 0!==i&&(r[e]=i));return r},serializeObj:function(t){var e="";if(A.isPlainObject(t))for(var a in t)e+="&"+a+"="+t[a];return e}},B=A,O={suffix:"?format=json",prefix:B.getWebRootPath()},W={manager:"/manager",timer:"/timer",plus:"/plus"},j={url:"",param:{},model:W.manager,success:function(t){},error:function(t){alert(t.error)},fail:function(t){alert(t)}},M={post:function(t){var e={};k()(e,j,t);var a=O.prefix+e.model+e.url+O.suffix;L.a.post(a,e.param).then(function(t){if(200===t.status)if(t.data&&!0===t.data.success){var a=B.toggleObjKey(t.data);e.success(a)}else e.error(t.data)}).catch(function(t){e.fail(t)})},get:function(t){var e={};k()(e,j,t);var a=O.prefix+e.model+e.url+O.suffix;L.a.get(a).then(function(t){if(200===t.status)if(t.data&&!0===t.data.success){var a=B.toggleObjKey(t.data);e.success(a)}else e.error(t.data)}).catch(function(t){e.fail(t)})},model:W},U={data:function(){return{loginForm:{username:"",password:""}}},methods:{onSubmit:function(){M.post("/login",this.loginForm,function(t){this.$message("登录成功。"),console.log(t)})},resetForm:function(t){this.$refs[t].resetFields()}}},X={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{ref:"loginForm",attrs:{model:t.loginForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{model:{value:t.loginForm.username,callback:function(e){t.$set(t.loginForm,"username",e)},expression:"loginForm.username"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("登录")]),t._v(" "),a("el-button",{on:{click:function(e){t.resetForm("loginForm")}}},[t._v("重置")])],1)],1)},staticRenderFns:[]},G=a("/Xao")(U,X,!1,function(t){a("Pfk1")},null,null).exports,K={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-container",{staticClass:"wrapper",staticStyle:{height:"100%",border:"1px solid #eee"}},[e("el-header",{staticStyle:{"text-align":"right","font-size":"12px"}},[e("el-dropdown",[e("span",{staticClass:"el-dropdown-link"},[this._v("\n        admin"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),this._v(" "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",[e("i",{staticClass:"el-icon-setting",staticStyle:{"margin-right":"5px"}}),this._v("修改密码")]),this._v(" "),e("el-dropdown-item",[e("i",{staticClass:"el-icon-circle-close",staticStyle:{"margin-right":"5px"}}),this._v("退出")])],1)],1)],1),this._v(" "),e("el-container",[e("el-aside",{attrs:{width:"220px"}},[e("el-menu",{attrs:{"default-openeds":["1","3","4"]}},[e("el-submenu",{attrs:{index:"1"}},[e("template",{slot:"title"},[e("i",{staticClass:"el-icon-message"}),this._v("运行管理")]),this._v(" "),e("router-link",{attrs:{to:{name:"txn"},tag:"li",replace:""}},[e("el-menu-item",{attrs:{index:"1-1"}},[this._v("交易模型")])],1),this._v(" "),e("router-link",{attrs:{to:{name:"list"},tag:"li",replace:""}},[e("el-menu-item",{attrs:{index:"1-2"}},[this._v("名单管理")])],1)],2),this._v(" "),e("el-submenu",{attrs:{index:"3"}},[e("template",{slot:"title"},[e("i",{staticClass:"el-icon-setting"}),this._v("权限管理")]),this._v(" "),e("router-link",{attrs:{to:{name:"user"},tag:"li",replace:""}},[e("el-menu-item",{attrs:{index:"3-1"}},[this._v("操作员管理")])],1),this._v(" "),e("router-link",{attrs:{to:{name:"role"},tag:"li",replace:""}},[e("el-menu-item",{attrs:{index:"3-2"}},[this._v("角色管理")])],1),this._v(" "),e("router-link",{attrs:{to:{name:"func"},tag:"li",replace:""}},[e("el-menu-item",{attrs:{index:"3-3"}},[this._v("功能管理")])],1)],2),this._v(" "),e("el-submenu",{attrs:{index:"4"}},[e("template",{slot:"title"},[e("i",{staticClass:"el-icon-setting"}),this._v("系统管理")]),this._v(" "),e("router-link",{attrs:{to:{name:"codedict"},tag:"li",replace:""}},[e("el-menu-item",{attrs:{index:"4-1"}},[this._v("数据字典管理")])],1),this._v(" "),e("router-link",{attrs:{to:{name:"ipaddr"},tag:"li",replace:""}},[e("el-menu-item",{attrs:{index:"4-3"}},[this._v("IP地址维护")])],1),this._v(" "),e("router-link",{attrs:{to:{name:"authCenter"},tag:"li",replace:""}},[e("el-menu-item",{attrs:{index:"4-4"}},[this._v("授权中心")])],1),this._v(" "),e("router-link",{attrs:{to:{name:"log"},tag:"li",replace:""}},[e("el-menu-item",{attrs:{index:"4-4"}},[this._v("操作日志管理")])],1)],2),this._v(" "),e("el-submenu",{attrs:{index:"5"}},[e("template",{slot:"title"},[e("i",{staticClass:"el-icon-setting"}),this._v("综合查询")]),this._v(" "),e("router-link",{attrs:{to:{name:"txnEventQuery"},tag:"li",replace:""}},[e("el-menu-item",{attrs:{index:"5-1"}},[this._v("交易事件查询")])],1),this._v(" "),e("router-link",{attrs:{to:{name:"alarmEventQuery"},tag:"li",replace:""}},[e("el-menu-item",{attrs:{index:"5-2"}},[this._v("报警事件查询")])],1)],2)],1)],1),this._v(" "),e("el-main",[e("router-view")],1)],1)],1)},staticRenderFns:[]},H=a("/Xao")({data:function(){return{defaultProps:{children:"children",label:"label"}}},methods:{}},K,!1,function(t){a("j6g3")},null,null).exports,Q={checkSpecialCode:function(t){if(B.isEmpty(t))return!0;for(var e="~`#$￥%^&*{}=][【】《》><?？/\\'",a=0;a<e.length;a++)if(-1!=t.indexOf(e.charAt(a)))return!1;return!0},checkFormSpecialCode:function(t,e,a){if(!Q.checkSpecialCode(e))return a(new Error("请不要输入特殊字符！如($,%)"));a()},checkFormEnSpecialCharacter:function(t,e,a){if(!Q.checkSpecialCharacter(e,1))return a(new Error("请以字母开头，包括字母、数字和下划线"));a()},checkFormZhSpecialCharacter:function(t,e,a){if(!Q.checkSpecialCharacter(e,2))return a(new Error("只能包含汉字,字母,数字和下划线"));a()},checkSpecialCharacter:function(t,e){return"1"==e?/^[a-zA-Z][\w]*$/.test(t):/^[\w\u4e00-\u9fa5]*$/.test(t)},checkSpecialCharacterInTxn:function(t,e,a){var i=Q.checkSpecialCharacter(e,a);return i||alert(t+"只能包含汉字,字母,数字和下划线"),i}},J=Q,Z=0,Y=function(t){return c(t).toUpperCase()},tt={created:function(){this.selUser(),this.selRole()},methods:{handleSizeChange:function(t){console.log("每页 "+t+" 条")},handleCurrentChange:function(t){console.log("当前页: "+t)},handleSelectionChange:function(t){this.multipleSelection=t},resetForm:function(t){this.$refs[t].resetFields()},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return e.$message("请正确填写用户信息"),!1;"add"===e.flag?e.addUser():"edit"===e.flag&&e.updateUser()})},bindGridData:function(t){this.roleData=t.page.list,this.currentPage=t.page.index,this.pagesize=t.page.size,this.total=t.page.total},selRole:function(){var t=this,e={url:"/role/listNormalRole",success:function(e){t.roles=e.row}};M.post(e)},selUser:function(){var t=this,e={url:"/operator/list",param:{login_name:this.userForm.login_name,real_name:this.userForm.real_name,flag:this.userForm.flag,role:this.userForm.role,pageindex:1,pagesize:10},success:function(e){e.page&&t.bindGridData(e)}};M.post(e)},openDialog:function(t){var e=this;if(this.flag=t,"edit"===t){this.dialogTitle="编辑用户";if(1!==this.multipleSelection.length)return void this.$message("请选择一行用户信息。");var a={url:"/operator/get",param:{operatorId:this.multipleSelection[0].operator_id},success:function(t){var a=t.row;e.userDialogForm={operator_id:a.operator_id,login_name:a.login_name,flag:a.flag,real_name:a.real_name,role:a.role,credentialtype:a.credentialtype,credentialnum:a.credentialnum,phone:a.phone,mobile:a.mobile,email:a.email,address:a.address,memo:a.memo,repwd:a.password,password:a.password}}};M.post(a)}else"add"===t&&(this.dialogTitle="新建用户",this.userDialogForm={operator_id:"",login_name:"",flag:"1",real_name:"",role:"",credentialtype:"",credentialnum:"",phone:"",mobile:"",email:"",address:"",memo:"",repwd:Y("123456"),password:Y("123456")});this.roleDialogVisible=!0,this.$refs.userDialogForm&&this.$refs.userDialogForm.clearValidate()},addUser:function(){var t=this,e={url:"/operator/add",param:this.userDialogForm,success:function(e){t.$message("创建成功。"),t.roleDialogVisible=!1,t.selUser()}};M.post(e)},updateUser:function(){var t=this,e={url:"/operator/mod",param:this.userDialogForm,success:function(e){t.$message("更新成功。"),t.roleDialogVisible=!1,t.selUser()}};M.post(e)},delUser:function(){var t=this,e=this;if(1===this.multipleSelection.length){var a=this.multipleSelection[0];this.$confirm("确定删除","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={url:"/operator/del",param:{operatorId:a.operator_id},success:function(t){e.$message("删除成功。"),e.selUser()}};M.post(t)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}else this.$message("请选择一行用户信息。")},resetPwd:function(){var t=this,e=this;if(1===this.multipleSelection.length){var a=Y("123456"),i=this.multipleSelection[0];this.$confirm("确定重置密码吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={url:"/operator/reset",param:{operatorId:i.operator_id,loginName:i.login_name,passWord:a},success:function(t){e.$message("密码重置成功。"),e.selUser()}};M.post(t)}).catch(function(){t.$message({type:"info",message:"已取消密码重置"})})}else this.$message("请选择一行用户信息。")},resetFlag:function(){var t=this,e=this;if(1===this.multipleSelection.length){var a=this.multipleSelection[0];this.$confirm("确定要解锁吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={url:"/operator/resetLoginFailedAttempts",param:{operatorId:a.operator_id},success:function(t){e.$message("用户解锁成功。"),e.selUser()}};M.post(t)}).catch(function(){t.$message({type:"info",message:"已取消用户解锁"})})}else this.$message("请选择一行用户信息。")}},data:function(){var t=this;return{inline:!0,roles:[],userForm:{login_name:"",real_name:"",flag:"",role:""},roleData:[{operator_id:"123123123123123123",login_name:"测试假用户",real_name:"王某某",role_name:"tms系统管理员",flag:"1",failed_login_attempts:"0",lockout:"0",lockout_date:(new Date).toLocaleDateString(),email:"123@qwe.com",mobile:"13366666666"}],currentPage:4,pagesize:10,total:100,roleDialogVisible:!1,userDialogForm:{operator_id:"",login_name:"",flag:"1",real_name:"",role:"",credentialtype:"",credentialnum:"",phone:"",mobile:"",email:"",address:"",memo:"",repwd:"123456",password:"123456"},dialogTitle:"",formLabelWidth:"100px",rules:{login_name:[{required:!0,message:"请输入用户名",trigger:"blur"},{len:6,message:"用户名只能由6位数字或字母组成",trigger:"blur"},{validator:function(t,e,a){if(!/^[0-9a-zA-Z]*$/.test(e)||6!==e.length)return a(new Error("用户名只能由6位数字或字母组成"));a()},trigger:"blur"},{validator:function(e,a,i){if("edit"===t.flag&&t.multipleSelection[0].login_name===a)i();else{var l={url:"/operator/check/username",param:{username:a},success:function(t){if("false"===t.checke_result)return i(new Error("用户名已被占用"));i()}};M.post(l)}},trigger:"blur"}],real_name:[{required:!0,message:"请输入姓名",trigger:"blur"},{max:50,message:"长度在50个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"blur"}],credentialtype:[{validator:function(e,a,i){var l=t;if(""===a.trim()&&""!==l.userDialogForm.credentialnum)return i(new Error("请选择证件类型"));""!==a.trim()&&""!==l.userDialogForm.credentialnum?(l.$refs.userDialogForm.validateField("credentialnum"),i()):i()},trigger:"blur"}],credentialnum:[{max:50,message:"证件号码不能超过32个字符",trigger:"blur"},{validator:function(t,e,a){if(!/^[0-9a-zA-Z]*$/.test(e))return a(new Error("证件号码只能有数字和字母组成"));a()},trigger:"blur"},{validator:function(e,a,i){var l=t;if(""===a.trim()&&""!==l.userDialogForm.credentialtype)return i(new Error("证件号码不能为空"));if(""!==a.trim()){var o=l.userDialogForm.credentialtype.toString();if("0"===o&&!/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[A-Z])$/.test(o))return i(new Error("身份证号码格式错误"));l.$refs.userDialogForm.validateField("credentialtype"),i()}else i()},trigger:"blur"}],phone:[{validator:function(t,e,a){if(""!==e.trim()&&!/^(([0+]\d{2,3}-)?(0\d{2,3})-)?(\d{7,8})(-(\d{3,}))?$/.test(e))return a(new Error("固定电话号码不正确"));a()},trigger:"blur"}],mobile:[{required:!0,message:"请输入移动电话",trigger:"blur"},{validator:function(t,e,a){if(!/(^13\d{9}$)|(^15\d{9}$)|(^18\d{9}$)/.test(e))return a(new Error("移动电话号码不正确"));a()},trigger:"blur"}],email:[{required:!0,message:"请输入电子邮件",trigger:"blur"},{type:"email",message:"请输入正确的电子邮件",trigger:"blur"},{max:50,message:"长度在50个字符以内",trigger:"blur"}],address:[{max:200,message:"长度在200个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}],memo:[{max:300,message:"长度在300个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}]},multipleSelection:[],flag:""}}},et={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{staticStyle:{"text-align":"left"},attrs:{"label-position":"right","label-width":"80px",model:t.userForm,inline:t.inline}},[a("el-form-item",{attrs:{label:"用户名",prop:"login_name"}},[a("el-input",{model:{value:t.userForm.login_name,callback:function(e){t.$set(t.userForm,"login_name",e)},expression:"userForm.login_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"姓名",prop:"real_name"}},[a("el-input",{model:{value:t.userForm.real_name,callback:function(e){t.$set(t.userForm,"real_name",e)},expression:"userForm.real_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{placeholder:"状态"},model:{value:t.userForm.flag,callback:function(e){t.$set(t.userForm,"flag",e)},expression:"userForm.flag"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),a("el-option",{attrs:{label:"停用",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"正常",value:"2"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"角色"}},[a("el-select",{attrs:{placeholder:"角色"},model:{value:t.userForm.role,callback:function(e){t.$set(t.userForm,"role",e)},expression:"userForm.role"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),t._l(t.roles,function(t){return a("el-option",{key:t.role_id,attrs:{label:t.role_name,value:t.role_id}})})],2)],1)],1),t._v(" "),a("div",{staticStyle:{"margin-bottom":"10px","text-align":"left"}},[a("el-button",{staticClass:"el-icon-plus",attrs:{plain:""},on:{click:function(e){t.openDialog("add")}}},[t._v("新建")]),t._v(" "),a("el-button",{staticClass:"el-icon-edit",attrs:{plain:""},on:{click:function(e){t.openDialog("edit")}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticClass:"el-icon-delete",attrs:{plain:""},on:{click:t.delUser}},[t._v("删除")]),t._v(" "),a("el-button",{staticClass:"el-icon-refresh",attrs:{plain:""},on:{click:t.resetPwd}},[t._v("密码重置")]),t._v(" "),a("el-button",{staticClass:"el-icon-setting",attrs:{plain:""},on:{click:t.resetFlag}},[t._v("用户解锁")]),t._v(" "),a("el-button",{staticClass:"el-icon-search",attrs:{type:"primary"},on:{click:t.selUser}},[t._v("查询")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.roleData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"35",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"login_name",label:"用户名",align:"left",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"real_name",label:"姓名",align:"left",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"role_name",label:"角色",align:"left",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"flag",label:"状态",align:"left",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"failed_login_attempts",label:"登录失败次数",align:"left",width:"95"}}),t._v(" "),a("el-table-column",{attrs:{prop:"lockout",label:"锁定次数",align:"left",width:"75"}}),t._v(" "),a("el-table-column",{attrs:{prop:"lockout_date",label:"锁定时间",align:"left",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"email",label:"电子邮件",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mobile",label:"移动电话",align:"left",width:"160"}})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{"current-page":t.currentPage,"page-sizes":[10,25,50,100],"page-size":t.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.roleDialogVisible},on:{"update:visible":function(e){t.roleDialogVisible=e}}},[a("el-form",{ref:"userDialogForm",staticStyle:{"max-height":"55vh","overflow-y":"auto"},attrs:{model:t.userDialogForm,rules:t.rules}},[a("el-form-item",{attrs:{label:"用户名","label-width":t.formLabelWidth,prop:"login_name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.userDialogForm.login_name,callback:function(e){t.$set(t.userDialogForm,"login_name",e)},expression:"userDialogForm.login_name"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"状态","label-width":t.formLabelWidth}},[a("el-radio",{attrs:{label:"1"},model:{value:t.userDialogForm.flag,callback:function(e){t.$set(t.userDialogForm,"flag",e)},expression:"userDialogForm.flag"}},[t._v("正常")]),t._v(" "),a("el-radio",{attrs:{label:"2"},model:{value:t.userDialogForm.flag,callback:function(e){t.$set(t.userDialogForm,"flag",e)},expression:"userDialogForm.flag"}},[t._v("停用")])],1),t._v(" "),a("el-form-item",{attrs:{label:"姓名","label-width":t.formLabelWidth,prop:"real_name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.userDialogForm.real_name,callback:function(e){t.$set(t.userDialogForm,"real_name",e)},expression:"userDialogForm.real_name"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"角色","label-width":t.formLabelWidth,prop:"role"}},[a("el-select",{attrs:{placeholder:"角色"},model:{value:t.userDialogForm.role,callback:function(e){t.$set(t.userDialogForm,"role",e)},expression:"userDialogForm.role"}},[a("el-option",{attrs:{label:"全部",value:"0"}}),t._v(" "),t._l(t.roles,function(t){return a("el-option",{key:t.role_id,attrs:{label:t.role_name,value:t.role_id}})})],2)],1),t._v(" "),a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"证件类型","label-width":t.formLabelWidth,prop:"credentialtype"}},[a("el-select",{attrs:{placeholder:"证件类型"},model:{value:t.userDialogForm.credentialtype,callback:function(e){t.$set(t.userDialogForm,"credentialtype",e)},expression:"userDialogForm.credentialtype"}},[a("el-option",{attrs:{label:"",value:""}}),t._v(" "),a("el-option",{attrs:{label:"身份证",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"临时居民身份证",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"军人身份证",value:"4"}}),t._v(" "),a("el-option",{attrs:{label:"武装警察身份证",value:"5"}}),t._v(" "),a("el-option",{attrs:{label:"港澳居民通行证",value:"6"}}),t._v(" "),a("el-option",{attrs:{label:"台湾居民通行证",value:"7"}}),t._v(" "),a("el-option",{attrs:{label:"护照",value:"8"}}),t._v(" "),a("el-option",{attrs:{label:"其他证件",value:"9"}}),t._v(" "),a("el-option",{attrs:{label:"港澳台居民往来内地通行证",value:"10"}}),t._v(" "),a("el-option",{attrs:{label:"外交人员身份证",value:"11"}}),t._v(" "),a("el-option",{attrs:{label:"外国人居留许可证",value:"12"}}),t._v(" "),a("el-option",{attrs:{label:"边民出入境通行证",value:"13"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"证件号码","label-width":t.formLabelWidth,prop:"credentialnum"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.userDialogForm.credentialnum,callback:function(e){t.$set(t.userDialogForm,"credentialnum",e)},expression:"userDialogForm.credentialnum"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"固定电话","label-width":t.formLabelWidth,prop:"phone"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.userDialogForm.phone,callback:function(e){t.$set(t.userDialogForm,"phone",e)},expression:"userDialogForm.phone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"移动电话","label-width":t.formLabelWidth,prop:"mobile"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.userDialogForm.mobile,callback:function(e){t.$set(t.userDialogForm,"mobile",e)},expression:"userDialogForm.mobile"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"电子邮件","label-width":t.formLabelWidth,prop:"email"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.userDialogForm.email,callback:function(e){t.$set(t.userDialogForm,"email",e)},expression:"userDialogForm.email"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"通讯地址","label-width":t.formLabelWidth,prop:"address"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.userDialogForm.address,callback:function(e){t.$set(t.userDialogForm,"address",e)},expression:"userDialogForm.address"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注信息","label-width":t.formLabelWidth,prop:"memo"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.userDialogForm.memo,callback:function(e){t.$set(t.userDialogForm,"memo",e)},expression:"userDialogForm.memo"}})],1),t._v(" "),a("el-form-item",{staticStyle:{display:"none"},attrs:{label:"密码1","label-width":t.formLabelWidth,prop:"repwd"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.userDialogForm.repwd,callback:function(e){t.$set(t.userDialogForm,"repwd",e)},expression:"userDialogForm.repwd"}})],1),t._v(" "),a("el-form-item",{staticStyle:{display:"none"},attrs:{label:"密码2","label-width":t.formLabelWidth,prop:"password"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.userDialogForm.password,callback:function(e){t.$set(t.userDialogForm,"password",e)},expression:"userDialogForm.password"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.roleDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("userDialogForm")}}},[t._v("保 存")])],1)],1)],1)},staticRenderFns:[]},at=a("/Xao")(tt,et,!1,function(t){a("mU65")},null,null).exports,it=a("NUMX"),lt=a.n(it),ot={};Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in e)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)));return t};var rt={getCodeData:function(){B.isEmptyObject(ot)&&M.get({url:"/common/dict",success:function(t){ot=t.codes?t.codes:{}}})},rendCode:function(t,e){var a=ot[t]?ot[t].items:[];e+="";for(var i=0;i<a.length;i++)if(a[i].value===e)return a[i].label;return e},getCodeItems:function(t){var e=ot[t]?ot[t].items:[];return lt()(e).slice(0)},getCode:function(t){return ot[t]},rendDatetime:function(t){return t=parseInt(t),new Date(t).format("yyyy-MM-dd hh:mm:ss")}},nt={created:function(){this.sel()},methods:{handleSizeChange:function(t){this.sel({pageindex:this.pageindex,pagesize:t})},handleCurrentChange:function(t){this.sel({pageindex:t,pagesize:this.pagesize})},openDialog:function(t){if(this.flag=t,"edit"===t){this.dialogTitle="编辑角色";if(1!==this.multipleSelection.length)return void this.$message("请选择一行角色信息。");this.roleDialogform=B.extend({},this.multipleSelection[0])}else"add"===t&&(this.dialogTitle="新建角色",this.$refs.roleDialogform?this.$refs.roleDialogform.resetFields():this.roleDialogform={role_name:"",flag:"1",info:""});this.roleDialogVisible=!0},handleSelectionChange:function(t){this.multipleSelection=t,1===t.length?this.btnStatus=!1:(t.length,this.btnStatus=!0)},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;"add"===e.flag?e.add():"edit"===e.flag&&e.update()})},bindGridData:function(t){this.roleData=t.page.list,this.currentPage=t.page.index,this.pagesize=t.page.size,this.total=t.page.total},add:function(){var t=this;M.post({url:"/role/add",param:this.roleDialogform,success:function(e){t.$message("创建成功。"),t.roleDialogVisible=!1,t.sel()}})},del:function(){var t=this,e=this.multipleSelection[0];M.post({url:"/role/del",param:{roleid:e.role_id},success:function(e){t.$message("删除成功。"),t.sel()}})},sel:function(t){var e,a=this;e=t&&(t.pageindex||t.pagesize)?B.extend({pageindex:this.pageindex,pagesize:this.pagesize},this.roleForm,t):B.extend({pageindex:this.pageindex,pagesize:this.pagesize},this.roleForm),M.post({url:"/role/list",param:e,success:function(t){t.page&&a.bindGridData(t)}})},update:function(){var t=this;M.post({url:"/role/mod",param:this.roleDialogform,success:function(e){t.$message("更新成功。"),t.roleDialogVisible=!1,t.sel()}})},grant:function(){this.grantData=[{id:1,label:"一级 1",children:[{id:4,label:"二级 1-1",children:[{id:9,label:"三级 1-1-1"},{id:10,label:"三级 1-1-2"}]}]},{id:2,label:"一级 2",children:[{id:5,label:"二级 2-1"},{id:6,label:"二级 2-2"}]},{id:3,label:"一级 3",children:[{id:7,label:"二级 3-1"},{id:8,label:"二级 3-2"}]}],this.grantDialogVisible=!0},selectFocus:function(){this.flagOptions=rt.getCodeItems("cmc.cmc_role.flag")},formatter:function(t,e,a){switch(e.property){case"flag":return rt.rendCode("cmc.cmc_role.flag",a);default:return a}}},data:function(){return{inline:!0,roleForm:{ROLE_NAME:""},roleData:[],pageindex:1,pagesize:10,total:100,roleDialogVisible:!1,grantDialogVisible:!1,roleDialogform:{role_name:"",flag:"1",info:""},dialogTitle:"",formLabelWidth:"100px",btnStatus:!0,rules:{ROLE_NAME:[{required:!0,message:"请输入角色名称",trigger:"blur"},{max:50,message:"长度在50个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}],INFO:[{max:200,message:"长度在200个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}]},multipleSelection:[],flag:"",flagOptions:[],clearable:!0,grantData:[],defaultProps:{children:"children",label:"label"}}}},st={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{staticStyle:{"text-align":"left"},attrs:{"label-position":"right","label-width":"80px",model:t.roleForm,inline:t.inline}},[a("el-form-item",{attrs:{label:"角色名称"}},[a("el-input",{model:{value:t.roleForm.role_name,callback:function(e){t.$set(t.roleForm,"role_name",e)},expression:"roleForm.role_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:t.clearable},on:{focus:function(e){t.selectFocus()}},model:{value:t.roleForm.flag,callback:function(e){t.$set(t.roleForm,"flag",e)},expression:"roleForm.flag"}},t._l(t.flagOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),a("div",{staticStyle:{"margin-bottom":"10px","text-align":"left"}},[a("el-button",{staticClass:"el-icon-search",attrs:{type:"primary"},on:{click:t.sel}},[t._v("查询")]),t._v(" "),a("el-button",{staticClass:"el-icon-plus",attrs:{plain:""},on:{click:function(e){t.openDialog("add")}}},[t._v("新建")]),t._v(" "),a("el-button",{staticClass:"el-icon-edit",attrs:{plain:"",disabled:t.btnStatus},on:{click:function(e){t.openDialog("edit")}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticClass:"el-icon-delete",attrs:{plain:"",disabled:t.btnStatus},on:{click:t.del}},[t._v("删除")]),t._v(" "),a("el-button",{staticClass:"el-icon-setting",attrs:{plain:"",disabled:t.btnStatus},on:{click:t.grant}},[t._v("功能授权")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.roleData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"role_name",label:"角色名称",align:"left",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"flag",label:"状态",align:"left",width:"180",formatter:t.formatter}}),t._v(" "),a("el-table-column",{attrs:{prop:"info",label:"描述信息",align:"left"}})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{"current-page":t.pageindex,"page-sizes":[10,25,50,100],"page-size":t.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.roleDialogVisible},on:{"update:visible":function(e){t.roleDialogVisible=e}}},[a("el-form",{ref:"roleDialogform",attrs:{model:t.roleDialogform,rules:t.rules}},[a("el-form-item",{attrs:{label:"角色名称","label-width":t.formLabelWidth,prop:"role_name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.roleDialogform.role_name,callback:function(e){t.$set(t.roleDialogform,"role_name",e)},expression:"roleDialogform.role_name"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"状态","label-width":t.formLabelWidth}},[a("el-radio",{attrs:{label:"1"},model:{value:t.roleDialogform.flag,callback:function(e){t.$set(t.roleDialogform,"flag",e)},expression:"roleDialogform.flag"}},[t._v("正常")]),t._v(" "),a("el-radio",{attrs:{label:"0"},model:{value:t.roleDialogform.flag,callback:function(e){t.$set(t.roleDialogform,"flag",e)},expression:"roleDialogform.flag"}},[t._v("停用")])],1),t._v(" "),a("el-form-item",{attrs:{label:"描述信息","label-width":t.formLabelWidth,prop:"info"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.roleDialogform.info,callback:function(e){t.$set(t.roleDialogform,"info",e)},expression:"roleDialogform.info"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.roleDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("roleDialogform")}}},[t._v("保 存")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"功能授权",visible:t.grantDialogVisible},on:{"update:visible":function(e){t.grantDialogVisible=e}}},[a("el-tree",{ref:"tree",attrs:{data:t.grantData,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":"",props:t.defaultProps}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.roleDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("roleDialogform")}}},[t._v("保 存")])],1)],1)],1)},staticRenderFns:[]},ct=a("/Xao")(nt,st,!1,null,null,null).exports,ut={created:function(){this.selTree()},data:function(){var t=this;return{toolBtn:{addBtn:!0,editBtn:!0,delBtn:!0},treeList:[],treeData:[{id:"-1",func_type:"-1",flag:"1",ftype_name:"",text:"功能树",icon:"ticon-root",onum:0}],nodeTypes:["子系统","模块","功能","子功能"],defaultProps:{children:"children",label:"text"},expendKey:["-1"],formLabelWidth:"120px",funcFormReadonly:!0,funcFormVisible:{form:!0,func_id:!0,parent_id:!0,func_type:!0,func_name:!0,conf:!0,ftype_name:!0,isgrant:!0,menu:!0,flag:!0,onum:!0,info:!0,islog:!0,logconf:!0},funcForm:{func_id:"",parent_id:"",func_type:"",func_name:"",conf:"",ftype_name:"",isgrant:"",menu:"1",flag:"1",onum:"",info:"",islog:"",logconf:"",logurlMethod:"",loguri:""},breadcrumbData:[],rules:{func_name:[{required:!0,message:"请输入节点名称",trigger:"blur"},{max:32,message:"长度在32个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"},{validator:function(e,a,i){var l=t.funcForm,o=t.treeList;for(var r in o){var n=o[r];if(n.text===a&&n.id!==l.func_id)return i(new Error("[节点名称]不能重复"))}return i()},trigger:"blur"}],conf:[{max:500,message:"长度在500个字符以内",trigger:"blur"}],onum:[{required:!0,message:"请输入节点名称",trigger:"blur"},{type:"number",max:100,min:0,message:"年龄必须为小于100的正整数",trigger:"blur"},{validator:function(e,a,i){var l=t,o=l.$refs.tree.currentNode.node,r=l.funcForm;if(""===r.func_id){var n=o.childNodes;for(var s in n)if(n[s].data.onum===a)return i(new Error("[顺序]不能重复"))}else{var c=o.parent.childNodes;for(var u in c)if(c[u].data.onum===a&&c[u].data.id!==r.func_id)return i(new Error("[顺序]不能重复"))}return i()},trigger:"blur"}],info:[{max:300,message:"长度在300个字符以内",trigger:"blur"}],logconf:[{validator:function(e,a,i){var l=t;if(0===a.indexOf("GET:"))l.funcForm.logurlMethod="0",l.funcForm.loguri=a.substring(4);else{if(0!==a.indexOf("POST:"))return i(new Error("[日志记录配置]只支持GET: 或POST:开头"));l.funcForm.logurlMethod="1",l.funcForm.loguri=a.substring(5)}return i()},trigger:"blur"}]}}},methods:{renderContent:function(t,e){var a=e.node;e.data,e.store;return"0"===a.data.flag?t("span",{class:"el-tree-node__label disabledFlag"},[a.label]):t("span",{class:"el-tree-node__label"},[a.label])},selTree:function(){var t=this,e={url:"/func/tree",success:function(e){if(e.list){var a=[{id:"-1",fid:"",func_type:"-1",flag:"1",ftype_name:"",text:"功能树",icon:"ticon-root",onum:0}];a=a.concat(e.list),t.treeList=a,t.treeData=t.formatTreeData(a),t.expendNodesByLevel(2)}}};M.post(e)},formatTreeData:function(t,e){function a(t,e){var i=[];for(var l in t){var o=t[l];o.fid===e&&(o.children=a(t,o.id),i.push(o))}return i}var i=[];if(void 0===e||0===e.length){e=[];for(var l in t)void 0!==t[l].fid&&null!==t[l].fid&&""!==t[l].fid||void 0!==t[l].id&&null!==t[l].id&&""!==t[l].id&&e.push(t[l])}0===e.length&&(console.error("根节点不存在，请确认树结构是否正确"),console.info("树结构的根节点是fid不存在（或为空）的节点，否则需手动添加指定得根节点（参数）"));for(var o in e){var r=e[o];r.children=a(t,r.id),i.push(r)}return i},expendNodesByLevel:function(t){for(var e=[],a=this.treeData[0],i=1;i<=t;)e.push(a.id),a=a.children[0],i++;this.expendKey=e},handleNodeClick:function(t,e){if(this.funcForm.func_id!==t.id){this.$refs.funcForm.clearValidate();var a=t.func_type;a<"3"&&"1"===t.flag?this.toolBtn.addBtn=!1:this.toolBtn.addBtn=!0,"-1"===a?(this.toolBtn.editBtn=!0,this.toolBtn.delBtn=!0):(this.toolBtn.editBtn=!1,this.toolBtn.delBtn=!1),this.syncBreadcrumb(e),this.funcFormReadonly=!0,this.showNodeAttr(e.data.func_type),this.showNodeValue(t)}},syncBreadcrumb:function(t){for(var e=[];null!==t.parent;)e.unshift({text:t.data.text}),t=t.parent;this.breadcrumbData=e},showNodeAttr:function(t){var e={form:!1,func_id:!0,parent_id:!0,func_type:!0,func_name:!1,conf:!1,ftype_name:!1,isgrant:!1,menu:!1,flag:!1,onum:!1,info:!1,islog:!1,logconf:!1};"-1"===t?(e.ftype_name=!0,e.isgrant=!0,e.menu=!0,e.flag=!0,e.onum=!0,e.islog=!0,e.logconf=!0,this.funcFormVisible=e):"0"===t||"1"===t?(e.isgrant=!0,e.islog=!0,e.logconf=!0,this.funcFormVisible=e):"2"===t?this.funcFormVisible=e:"3"===t?(e.isgrant=!0,e.menu=!0,this.funcFormVisible=e):this.funcFormVisible=e},showNodeValue:function(t){var e={func_id:t.id,parent_id:t.fid,func_type:t.func_type,func_name:t.text,conf:t.conf,ftype_name:this.nodeTypes[t.func_type],isgrant:"1"===t.isgrant,menu:t.menu?t.menu:"1",flag:t.flag?t.flag:"1",onum:t.onum,info:t.info,islog:"1"===t.islog,logconf:"",logurlMethod:t.logurlmethod,loguri:t.loguri};switch(t.logurlmethod){case"0":e.logconf="GET:"+t.loguri;break;case"1":e.logconf="POST:"+t.loguri}this.funcForm=e},resetPage:function(){this.funcFormVisible.form=!0,this.breadcrumbData=[],this.toolBtn={addBtn:!0,editBtn:!0,delBtn:!0}},addFunc:function(){this.$refs.funcForm.resetFields();var t=this.$refs.tree.getCurrentNode();console.info(t),this.funcForm.ftype_name=this.nodeTypes[Number(t.func_type)+1],this.funcFormReadonly=!1,this.showNodeAttr(Number(t.func_type)+1+"")},editFunc:function(){this.funcFormReadonly=!1},delFunc:function(){var t=this,e=this,a=e.$refs.tree.currentNode.node;this.$confirm("确定要删除功能节点吗？其下级节点将都会被删除！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={url:"/func/del",param:{funcId:a.id,rf:"json"},success:function(t){a.visible=!1,e.resetPage(),e.$message("删除功能成功")}};M.post(t)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},closeFuncForm:function(){""===this.funcForm.func_id?this.resetPage():this.funcFormReadonly=!0},submitFunc:function(){var t=this,e={url:""===t.funcForm.func_id?"/func/add":"/func/mod",param:t.funcForm,success:function(e){t.$message("操作成功。"),t.selTree(),t.resetPage()}};M.post(e)}}},dt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",{staticStyle:{height:"100%",border:"1px solid #eee"}},[a("el-col",{staticStyle:{"border-right":"1px solid #eee"},attrs:{span:6}},[a("div",{staticStyle:{height:"38px","margin-top":"5px","text-align":"left","border-bottom":"1px solid #eee"}},[a("el-button",{staticClass:"el-icon-plus",staticStyle:{"margin-left":"5px"},attrs:{plain:"",disabled:t.toolBtn.addBtn},on:{click:t.addFunc}},[t._v("新建\n        ")]),t._v(" "),a("el-button",{staticClass:"el-icon-edit",staticStyle:{"margin-left":"0px"},attrs:{plain:"",disabled:t.toolBtn.editBtn},on:{click:t.editFunc}},[t._v("编辑\n        ")]),t._v(" "),a("el-button",{staticClass:"el-icon-delete",staticStyle:{"margin-left":"0px"},attrs:{plain:"",disabled:t.toolBtn.delBtn},on:{click:t.delFunc}},[t._v("删除\n        ")])],1),t._v(" "),a("el-tree",{ref:"tree",staticStyle:{height:"76vh","overflow-y":"auto"},attrs:{data:t.treeData,"node-key":"id","default-expanded-keys":t.expendKey,props:t.defaultProps,"highlight-current":!0,"expand-on-click-node":!1,"render-content":t.renderContent},on:{"node-click":t.handleNodeClick}})],1),t._v(" "),a("el-col",{attrs:{span:18}},[a("div",{staticStyle:{height:"38px",width:"100%","margin-top":"5px","text-align":"left","border-bottom":"1px solid #eee"}},[a("el-breadcrumb",{staticStyle:{padding:"10px 15px"},attrs:{id:"funcPath",separator:">"}},t._l(t.breadcrumbData,function(e){return a("el-breadcrumb-item",{key:e.text},[t._v(t._s(e.text))])}))],1),t._v(" "),a("el-main",{staticStyle:{"max-height":"76vh","overflow-y":"auto"}},[a("el-form",{ref:"funcForm",class:{hidden:t.funcFormVisible.form},staticStyle:{"text-align":"left"},attrs:{model:t.funcForm,rules:t.rules,"label-suffix":"：","label-width":t.formLabelWidth}},[a("el-form-item",{class:{hidden:t.funcFormVisible.func_id},attrs:{label:"功能编号",prop:"func_id"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.funcForm.func_id,callback:function(e){t.$set(t.funcForm,"func_id",e)},expression:"funcForm.func_id"}})],1),t._v(" "),a("el-form-item",{class:{hidden:t.funcFormVisible.parent_id},attrs:{label:"父节点编号",prop:"parent_id"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.funcForm.parent_id,callback:function(e){t.$set(t.funcForm,"parent_id",e)},expression:"funcForm.parent_id"}})],1),t._v(" "),a("el-form-item",{class:{hidden:t.funcFormVisible.func_type},attrs:{label:"功能类型",prop:"func_type"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.funcForm.func_type,callback:function(e){t.$set(t.funcForm,"func_type",e)},expression:"funcForm.func_type"}})],1),t._v(" "),a("el-form-item",{class:{hidden:t.funcFormVisible.func_name},attrs:{label:"节点名称",prop:"func_name"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:t.funcFormReadonly},model:{value:t.funcForm.func_name,callback:function(e){t.$set(t.funcForm,"func_name",e)},expression:"funcForm.func_name"}})],1),t._v(" "),a("el-form-item",{class:{hidden:t.funcFormVisible.conf},attrs:{label:"节点配置",prop:"conf"}},[a("el-input",{attrs:{type:"textarea",readonly:t.funcFormReadonly},model:{value:t.funcForm.conf,callback:function(e){t.$set(t.funcForm,"conf",e)},expression:"funcForm.conf"}})],1),t._v(" "),a("el-form-item",{class:{hidden:t.funcFormVisible.ftype_name},attrs:{label:"节点类型",prop:"ftype_name"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:t.funcFormReadonly},model:{value:t.funcForm.ftype_name,callback:function(e){t.$set(t.funcForm,"ftype_name",e)},expression:"funcForm.ftype_name"}})],1),t._v(" "),a("el-form-item",{class:{hidden:t.funcFormVisible.isgrant},attrs:{label:"访问授权",prop:"isgrant"}},[a("el-checkbox",{attrs:{label:"需要授权",name:"type",disabled:t.funcFormReadonly},model:{value:t.funcForm.isgrant,callback:function(e){t.$set(t.funcForm,"isgrant",e)},expression:"funcForm.isgrant"}})],1),t._v(" "),a("el-form-item",{class:{hidden:t.funcFormVisible.menu},attrs:{label:"是否菜单"}},[a("el-radio",{attrs:{label:"1",disabled:t.funcFormReadonly},model:{value:t.funcForm.menu,callback:function(e){t.$set(t.funcForm,"menu",e)},expression:"funcForm.menu"}},[t._v("是")]),t._v(" "),a("el-radio",{attrs:{label:"0",disabled:t.funcFormReadonly},model:{value:t.funcForm.menu,callback:function(e){t.$set(t.funcForm,"menu",e)},expression:"funcForm.menu"}},[t._v("否")])],1),t._v(" "),a("el-form-item",{class:{hidden:t.funcFormVisible.flag},attrs:{label:"状态"}},[a("el-radio",{attrs:{label:"1",disabled:t.funcFormReadonly},model:{value:t.funcForm.flag,callback:function(e){t.$set(t.funcForm,"flag",e)},expression:"funcForm.flag"}},[t._v("正常")]),t._v(" "),a("el-radio",{attrs:{label:"0",disabled:t.funcFormReadonly},model:{value:t.funcForm.flag,callback:function(e){t.$set(t.funcForm,"flag",e)},expression:"funcForm.flag"}},[t._v("停用")])],1),t._v(" "),a("el-form-item",{class:{hidden:t.funcFormVisible.onum},attrs:{label:"顺序",prop:"onum"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:t.funcFormReadonly},model:{value:t.funcForm.onum,callback:function(e){t.$set(t.funcForm,"onum",t._n(e))},expression:"funcForm.onum"}})],1),t._v(" "),a("el-form-item",{class:{hidden:t.funcFormVisible.info},attrs:{label:"描述信息",prop:"info"}},[a("el-input",{attrs:{type:"textarea",readonly:t.funcFormReadonly},model:{value:t.funcForm.info,callback:function(e){t.$set(t.funcForm,"info",e)},expression:"funcForm.info"}})],1),t._v(" "),a("el-form-item",{class:{hidden:t.funcFormVisible.islog},attrs:{label:"记录日志",prop:"islog"}},[a("el-checkbox",{attrs:{label:"记录",name:"type",disabled:t.funcFormReadonly},model:{value:t.funcForm.islog,callback:function(e){t.$set(t.funcForm,"islog",e)},expression:"funcForm.islog"}})],1),t._v(" "),a("el-form-item",{class:{hidden:t.funcFormVisible.logconf},attrs:{label:"日志记录配置",prop:"logconf"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:t.funcFormReadonly},model:{value:t.funcForm.logconf,callback:function(e){t.$set(t.funcForm,"logconf",e)},expression:"funcForm.logconf"}})],1),t._v(" "),a("el-form-item",{class:{hidden:t.funcFormReadonly},staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.submitFunc}},[t._v("保 存")]),t._v(" "),a("el-button",{on:{click:t.closeFuncForm}},[t._v("取 消")])],1)],1)],1)],1)],1)],1)},staticRenderFns:[]},mt=a("/Xao")(ut,dt,!1,function(t){a("AaCG")},null,null).exports,ft={created:function(){this.sel()},methods:{handleSizeChange:function(t){this.sel({pageindex:this.pageindex,pagesize:t})},handleCurrentChange:function(t){this.sel({pageindex:t,pagesize:this.pagesize})},openDialog:function(t){if(this.flag=t,"edit"===t){this.dialogTitle="编辑名单",this.status=!0;if(1!==this.multipleSelection.length)return void this.$message("请选择一行名单信息。");this.listDialogform=B.extend({},this.multipleSelection[0])}else"add"===t&&(this.dialogTitle="新建名单",this.status=!1,this.$refs.listDialogform?this.$refs.listDialogform.resetFields():this.listDialogform={rostername:"",rosterdesc:"",datatype:"",rostertype:"",iscache:"1",remark:""});this.listDialogVisible=!0},handleSelectionChange:function(t){this.multipleSelection=t,1===t.length?(this.btnStatus=!1,this.delBtnStatus=!1):t.length>1?(this.btnStatus=!0,this.delBtnStatus=!1):(this.btnStatus=!0,this.delBtnStatus=!0)},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;"add"===e.flag?e.add():"edit"===e.flag&&e.update()})},bindGridData:function(t){this.gridData=t.page.list,this.pageindex=t.page.index,this.pagesize=t.page.size,this.total=t.page.total},add:function(){var t=this;M.post({url:"/mgr/add",param:this.listDialogform,success:function(e){t.$message("创建成功。"),t.listDialogVisible=!1,t.sel()}})},del:function(){var t=this;M.post({url:"/mgr/del",param:{del:this.multipleSelection},success:function(e){t.$message("删除成功。"),t.sel()}})},sel:function(t){var e,a=this;e=t&&(t.pageindex||t.pagesize)?B.extend({pageindex:this.pageindex,pagesize:this.pagesize},this.listForm,t):B.extend({pageindex:this.pageindex,pagesize:this.pagesize},this.listForm),M.post({url:"/mgr/list",param:e,success:function(t){t.page&&a.bindGridData(t)}})},update:function(){var t=this;M.post({url:"/mgr/mod",param:this.listDialogform,success:function(e){t.$message("更新成功。"),t.listDialogVisible=!1,t.sel()}})},showValueList:function(){var t=this.multipleSelection[0].rosterid,e=this.multipleSelection[0].datatype;this.$router.push({name:"valuelist",params:{rosterid:t,datatype:e}})},importList:function(){this.importDialogVisible=!0},exportList:function(){0!==this.multipleSelection[0].valuecount?this.exportDialogVisible=!0:this.$message("名单中没有名单值。")},selectFocus:function(t){"datatype"===t&&0===this.datatypeOptions.length&&(this.datatypeOptions=rt.getCodeItems("tms.model.datatype.roster")),"rostertype"===t&&0===this.rostertypeOptions.length&&(this.rostertypeOptions=rt.getCodeItems("tms.mgr.rostertype"))},formatter:function(t,e,a){switch(e.property){case"datatype":return rt.rendCode("tms.model.datatype.roster",a);case"rostertype":return rt.rendCode("tms.mgr.rostertype",a);case"createtime":return rt.rendDatetime(a);case"iscache":return rt.rendCode("tms.mgr.iscache",a);default:return a}},submitUpload:function(){this.$refs.upload.submit()},handleRemove:function(t,e){console.log(t,e)},handlePreview:function(t){console.log(t)},exportAction:function(t){var e=this.multipleSelection[0],a="&rosterid="+e.rosterid+"&rosterdesc="+e.rosterdesc,i="/context/manager/mgr/export?"+(B.serializeObj(this.listForm)+a+"&flag="+t);window.open(i),this.exportDialogVisible=!1}},data:function(){return{inline:!0,clearable:!0,listForm:{rosterdesc:"",datatype:"",rostertype:""},gridData:[],pageindex:1,pagesize:10,total:100,listDialogVisible:!1,listDialogform:{rostername:"",rosterdesc:"",datatype:"",rostertype:"",iscache:"1",remark:""},status:!0,btnStatus:!0,delBtnStatus:!0,dialogTitle:"",formLabelWidth:"150px",datatypeOptions:[],rostertypeOptions:[],rules:{rostername:[{required:!0,message:"请输入名单英文名",trigger:"blur"},{max:32,message:"长度在32个字符以内",trigger:"blur"},{validator:J.checkFormEnSpecialCharacter,trigger:"blur"}],listFormFosterdesc:[{max:64,message:"长度在64个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}],rosterdesc:[{required:!0,message:"请输入名单名称",trigger:"blur"},{max:64,message:"长度在64个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}],datatype:[{required:!0,message:"请输入名单数据类型",trigger:"blur"}],rostertype:[{required:!0,message:"请输入名单类型",trigger:"blur"}],remark:[{max:512,message:"长度在512个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}]},multipleSelection:[],flag:"",importDialogVisible:!1,exportDialogVisible:!1}}},pt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{staticStyle:{"text-align":"left"},attrs:{"label-position":"right","label-width":"100px",model:t.listForm,inline:t.inline}},[a("el-form-item",{attrs:{label:"名单名称",prop:"listFormFosterdesc"}},[a("el-input",{model:{value:t.listForm.rosterdesc,callback:function(e){t.$set(t.listForm,"rosterdesc",e)},expression:"listForm.rosterdesc"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"名单数据类型"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:t.clearable},on:{focus:function(e){t.selectFocus("datatype")}},model:{value:t.listForm.datatype,callback:function(e){t.$set(t.listForm,"datatype",e)},expression:"listForm.datatype"}},t._l(t.datatypeOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"名单类型"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:t.clearable},on:{focus:function(e){t.selectFocus("rostertype")}},model:{value:t.listForm.rostertype,callback:function(e){t.$set(t.listForm,"rostertype",e)},expression:"listForm.rostertype"}},t._l(t.rostertypeOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),a("div",{staticStyle:{"margin-bottom":"10px","text-align":"left"}},[a("el-button",{ref:"selBtn",staticClass:"el-icon-search",attrs:{type:"primary",id:"selBtn"},on:{click:t.sel}},[t._v("查询")]),t._v(" "),a("el-button",{staticClass:"el-icon-plus",attrs:{plain:"",id:"addBtn"},on:{click:function(e){t.openDialog("add")}}},[t._v("新建")]),t._v(" "),a("el-button",{staticClass:"el-icon-edit",attrs:{plain:"",disabled:t.btnStatus},on:{click:function(e){t.openDialog("edit")}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticClass:"el-icon-delete",attrs:{plain:"",disabled:t.delBtnStatus},on:{click:t.del}},[t._v("删除")]),t._v(" "),a("el-button",{staticClass:"el-icon-edit",attrs:{plain:"",disabled:t.btnStatus},on:{click:t.showValueList}},[t._v("名单值")]),t._v(" "),a("el-button",{staticClass:"el-icon-upload",attrs:{plain:"",disabled:t.btnStatus},on:{click:t.importList}},[t._v("导入")]),t._v(" "),a("el-button",{staticClass:"el-icon-download",attrs:{plain:"",disabled:t.btnStatus},on:{click:t.exportList}},[t._v("导出")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.gridData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rostername",label:"名单英文名",align:"left",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rosterdesc",label:"名单名称",align:"left",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"datatype",label:"名单数据类型",align:"left",width:"120",formatter:t.formatter}}),t._v(" "),a("el-table-column",{attrs:{prop:"rostertype",label:"名单类型",align:"left",width:"120",formatter:t.formatter}}),t._v(" "),a("el-table-column",{attrs:{prop:"valuecount",label:"值数量",align:"left",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"createtime",label:"创建时间",align:"left",width:"150",formatter:t.formatter}}),t._v(" "),a("el-table-column",{attrs:{prop:"iscache",label:"是否缓存",align:"left",width:"120",formatter:t.formatter}}),t._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"left",width:"120"}})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{"current-page":t.pageindex,"page-sizes":[10,25,50,100],"page-size":t.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.listDialogVisible},on:{"update:visible":function(e){t.listDialogVisible=e}}},[a("el-form",{ref:"listDialogform",staticStyle:{"text-align":"left"},attrs:{model:t.listDialogform,rules:t.rules,"label-width":t.formLabelWidth}},[a("el-form-item",{attrs:{label:"名单英文名",prop:"rostername",data:"rostername"}},[a("el-input",{attrs:{"auto-complete":"off",disabled:t.status},model:{value:t.listDialogform.rostername,callback:function(e){t.$set(t.listDialogform,"rostername",e)},expression:"listDialogform.rostername"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"名单名称",prop:"rosterdesc",data:"rosterdesc"}},[a("el-input",{attrs:{"auto-complete":"off",disabled:t.status},model:{value:t.listDialogform.rosterdesc,callback:function(e){t.$set(t.listDialogform,"rosterdesc",e)},expression:"listDialogform.rosterdesc"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"名单数据类型",prop:"datatype",data:"datatype"}},[a("el-select",{attrs:{disabled:t.status,clearable:t.clearable},model:{value:t.listDialogform.datatype,callback:function(e){t.$set(t.listDialogform,"datatype",e)},expression:"listDialogform.datatype"}},t._l(t.datatypeOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"名单类型",prop:"rostertype",data:"rostertype"}},[a("el-select",{attrs:{disabled:t.status,clearable:t.clearable},model:{value:t.listDialogform.rostertype,callback:function(e){t.$set(t.listDialogform,"rostertype",e)},expression:"listDialogform.rostertype"}},t._l(t.rostertypeOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"是否缓存",prop:"iscache",data:"iscache"}},[a("el-radio",{attrs:{label:"1"},model:{value:t.listDialogform.iscache,callback:function(e){t.$set(t.listDialogform,"iscache",e)},expression:"listDialogform.iscache"}},[t._v("是")]),t._v(" "),a("el-radio",{attrs:{label:"0"},model:{value:t.listDialogform.iscache,callback:function(e){t.$set(t.listDialogform,"iscache",e)},expression:"listDialogform.iscache"}},[t._v("否")])],1),t._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"remark",data:"remark"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.listDialogform.remark,callback:function(e){t.$set(t.listDialogform,"remark",e)},expression:"listDialogform.remark"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{data:"cancelBtn"},on:{click:function(e){t.listDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",data:"saveBtn"},on:{click:function(e){t.submitForm("listDialogform")}}},[t._v("保 存")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"名单管理导入",visible:t.importDialogVisible},on:{"update:visible":function(e){t.importDialogVisible=e}}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"/context/manager/mgr/import","on-preview":t.handlePreview,"on-remove":t.handleRemove,"file-list":t.fileList,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选取文件")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:t.submitUpload}},[t._v("上传到服务器")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("请上传XLS、XLSX、TXT或CSV格式的文件")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"选择导出名单格式",visible:t.exportDialogVisible},on:{"update:visible":function(e){t.exportDialogVisible=e}}},[a("el-button",{attrs:{type:"text"},on:{click:function(e){t.exportAction("txt")}}},[t._v("TXT")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(e){t.exportAction("csv")}}},[t._v("CSV")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(e){t.exportAction("xls")}}},[t._v("Excel2003及以下版本")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(e){t.exportAction("xlsx")}}},[t._v("Excel2007及以上版本")]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{data:"cancelBtn"},on:{click:function(e){t.listDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",data:"saveBtn"},on:{click:function(e){t.submitForm("listDialogform")}}},[t._v("保 存")])],1)],1)],1)},staticRenderFns:[]},ht=a("/Xao")(ft,pt,!1,null,null,null).exports,gt={created:function(){this.getList(this.sel)},methods:{handleSizeChange:function(t){this.sel({pageindex:this.pageindex,pagesize:t})},handleCurrentChange:function(t){this.sel({pageindex:t,pagesize:this.pagesize})},openDialog:function(t){if(this.flag=t,this.dialogTitle="名单值管理->"+this.title,"edit"===t){if(1!==this.multipleSelection.length)return void this.$message("请选择一行名单值信息。");this.valueListDialogform=B.extend({},this.multipleSelection[0])}else"add"===t&&(this.$refs.valueListDialogform?this.$refs.valueListDialogform.resetFields():this.valueListDialogform={rostervalue:"",enabletime:(new Date).format("yyyy-MM-dd hh:mm:ss"),disabletime:"",remark:""});this.valueListDialogVisible=!0},handleSelectionChange:function(t){this.multipleSelection=t,1===t.length?(this.btnStatus=!1,this.delBtnStatus=!1):t.length>1?(this.btnStatus=!0,this.delBtnStatus=!1):(this.btnStatus=!0,this.delBtnStatus=!0)},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;"add"===e.flag?e.add():"edit"===e.flag&&e.update()})},bindGridData:function(t){this.gridData=t.page.list,this.pageindex=t.page.index,this.pagesize=t.page.size,this.total=t.page.total},bindValueGridData:function(t){this.changeValueTableData=t.row},getList:function(t){self=this;var e={rosterid:this.$router.history.current.params.rosterid};M.post({url:"/mgr/get",param:e,success:function(e){self.listData=e.row,self.title=e.row.rosterdesc,t&&t()}})},add:function(){var t=this,e=B.extend({rosterid:this.listData.rosterid,datatype:this.listData.datatype,rosterdesc:this.listData.rosterdesc},this.valueListDialogform);M.post({url:"/mgr/valueadd",param:e,success:function(e){t.$message("创建成功。"),t.valueListDialogVisible=!1,t.sel()}})},del:function(){var t=this;M.post({url:"/mgr/valuedel",param:{postData:{del:this.multipleSelection}},success:function(e){t.$message("删除成功。"),t.sel()}})},sel:function(t){var e,a=this,i={pageindex:this.pageindex,pagesize:this.pagesize,rosterid:this.listData.rosterid,datatype:this.listData.datatype};e=t&&(t.pageindex||t.pagesize)?B.extend(i,this.valueListForm,t):B.extend(i,this.valueListForm),M.post({url:"/mgr/valuelist",param:e,success:function(t){t.page&&a.bindGridData(t)}})},update:function(){var t=this,e=B.extend({rosterid:this.listData.rosterid,datatype:this.listData.datatype,rosterdesc:this.listData.rosterdesc},this.valueListDialogform);M.post({url:"/mgr/valuemod",param:e,success:function(e){t.$message("更新成功。"),t.valueListDialogVisible=!1,t.sel()}})},changeValue:function(){var t=this;M.post({url:"/mgr/changevalueget",param:{rosterid:this.listData.rosterid,datatype:this.listData.datatype,rostertype:this.listData.rostertype},success:function(e){t.bindValueGridData(e),t.changeValueDialogVisible=!0}})},constrast:function(){var t=this.multipleSelection[0];M.post({url:"/mgr/changevalue",param:{rostervalueid:t.rostervalueid,rostervalue:t.rostervalue,rosterid:this.valuecurrentRow.rosterid+"||||"+this.valuecurrentRow.rosterdesc,rosteridold:this.listData.rosterid,rosterdescout:this.listData.rosterdesc},success:function(t){self.$message("值转换成功。"),self.changeValueDialogVisible=!1,self.sel()}})},handleCurrentChangeValueTable:function(t){this.valuecurrentRow=t},backList:function(){this.$router.push({name:"list"})}},data:function(){return{inline:!0,valueListForm:{rostervalue:""},listData:{rosterdesc:""},gridData:[],pageindex:1,pagesize:10,total:100,valueListDialogVisible:!1,valueListDialogform:{rostervalue:"",enabletime:(new Date).format("yyyy-MM-dd hh:mm:ss"),disabletime:"",remark:""},dialogTitle:"",title:"testdddd",formLabelWidth:"150px",rules:{rostervalue:[{required:!0,message:"请输入名单英文名",trigger:"blur"}],enabletime:[],disabletime:[],remark:[{max:512,message:"长度在512个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}]},multipleSelection:[],flag:"",changeValueDialogVisible:!1,changeValueTableData:[],valuecurrentRow:{},btnStatus:!0,delBtnStatus:!0}}},vt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h1",[t._v("名单值管理 -> "+t._s(t.title))]),t._v(" "),a("el-form",{staticStyle:{"text-align":"left"},attrs:{"label-position":"right","label-width":"100px",model:t.valueListForm,inline:t.inline}},[a("el-form-item",{attrs:{label:"名单值"}},[a("el-input",{model:{value:t.valueListForm.rostervalue,callback:function(e){t.$set(t.valueListForm,"rostervalue",e)},expression:"valueListForm.rostervalue"}})],1)],1),t._v(" "),a("div",{staticStyle:{"margin-bottom":"10px","text-align":"left"}},[a("el-button",{staticClass:"el-icon-search",attrs:{type:"primary"},on:{click:t.sel}},[t._v("查询")]),t._v(" "),a("el-button",{staticClass:"el-icon-plus",attrs:{plain:""},on:{click:function(e){t.openDialog("add")}}},[t._v("新建")]),t._v(" "),a("el-button",{staticClass:"el-icon-edit",attrs:{plain:"",disabled:t.btnStatus},on:{click:function(e){t.openDialog("edit")}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticClass:"el-icon-delete",attrs:{plain:"",disabled:t.delBtnStatus},on:{click:t.del}},[t._v("删除")]),t._v(" "),a("el-button",{staticClass:"el-icon-edit",attrs:{plain:"",disabled:t.btnStatus},on:{click:t.changeValue}},[t._v("值转换")]),t._v(" "),a("el-button",{staticClass:"el-icon-back",attrs:{plain:""},on:{click:t.backList}},[t._v("返回")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.gridData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rostervalue",label:"名单值",align:"left",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"enabletime",label:"开始时间",align:"left",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"disabletime",label:"结束时间",align:"left",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"createtime",label:"创建时间",align:"left",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"left",width:"300"}})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{"current-page":t.pageindex,"page-sizes":[10,25,50,100],"page-size":t.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.valueListDialogVisible},on:{"update:visible":function(e){t.valueListDialogVisible=e}}},[a("el-form",{ref:"valueListDialogform",staticStyle:{"text-align":"left"},attrs:{model:t.valueListDialogform,rules:t.rules,"label-width":t.formLabelWidth}},[a("el-form-item",{attrs:{label:"名单值",prop:"rostervalue"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.valueListDialogform.rostervalue,callback:function(e){t.$set(t.valueListDialogform,"rostervalue",e)},expression:"valueListDialogform.rostervalue"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开始时间",prop:"enabletime"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.valueListDialogform.enabletime,callback:function(e){t.$set(t.valueListDialogform,"enabletime",e)},expression:"valueListDialogform.enabletime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束时间",prop:"disabletime"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.valueListDialogform.disabletime,callback:function(e){t.$set(t.valueListDialogform,"disabletime",e)},expression:"valueListDialogform.disabletime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.valueListDialogform.remark,callback:function(e){t.$set(t.valueListDialogform,"remark",e)},expression:"valueListDialogform.remark"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.valueListDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("valueListDialogform")}}},[t._v("保 存")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"值转换",visible:t.changeValueDialogVisible},on:{"update:visible":function(e){t.changeValueDialogVisible=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.changeValueTableData,"highlight-current-row":""},on:{"current-change":t.handleCurrentChangeValueTable}},[a("el-table-column",{attrs:{prop:"rosterdesc",label:"名单名称",align:"left",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"datatype",label:"名单数据类型",align:"left",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rostertype",label:"名单类型",align:"left",width:"200"}})],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.changeValueDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.constrast}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]},bt=a("/Xao")(gt,vt,!1,null,null,null).exports,_t=a("kfHR"),yt=a.n(_t),Ft=a("zsLt"),Dt=a.n(Ft),wt={computed:{allPick:function(){var t=this.allDataList.map(function(t){return t.code_key}),e=new Dt.a(this.selectedRows);return 0===new Dt.a(t.filter(function(t){return!e.has(t)})).size},selectDisabled:function(){return this.disabled},selectCollapseTags:function(){return this.collapseTags}},data:function(){return{allDataList:[],selectedCached:[],selectedRows:[]}},props:{dataList:{type:Array,default:function(){return[]}},selectedList:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:!1},collapseTags:{type:Boolean,default:!0}},mounted:function(){this.$nextTick(function(){this.allDataList=this.dataList,this.selectedRows=this.selectedList})},watch:{selectedRows:function(){this.value=this.selectedRows;var t=this.selectedRows.filter(function(t){return"&ALLPICK&"!==t});this.$emit("dataChange",t)},selectedList:function(){this.selectedRows=this.selectedList},dataList:function(){this.allDataList=this.dataList}},methods:{setRows:function(t){this.selectedRows=t},selectChange:function(t){var e=new Dt.a(this.selectedCached),a=new Dt.a(this.selectedRows),i=new Dt.a(this.selectedCached.filter(function(t){return!a.has(t)}));i.size>0&&(i.has("&ALLPICK&")?this.selectedRows=[]:this.selectedRows=this.selectedRows.filter(function(t){return"&ALLPICK&"!==t})),(i=new Dt.a(this.selectedRows.filter(function(t){return!e.has(t)}))).size>0&&(i.has("&ALLPICK&")?(this.selectedRows=[],this.selectedRows=this.allDataList.map(function(t){return t.code_key}),this.selectedRows.push("&ALLPICK&")):this.allPick&&this.selectedRows.push("&ALLPICK&")),this.selectedCached=[];var l=new Dt.a(this.selectedRows),o=[];l.has("&ALLPICK&")&&(o.push("&ALLPICK&"),l.delete("&ALLPICK&"),o=o.concat(yt()(l)),this.selectedRows=o),k()(this.selectedCached,this.selectedRows)}}},xt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-select",{staticClass:"query-form-item",attrs:{placeholder:"请选择",multiple:"","collapse-tags":t.selectCollapseTags,disabled:t.selectDisabled},on:{change:t.selectChange},model:{value:t.selectedRows,callback:function(e){t.selectedRows=e},expression:"selectedRows"}},[a("el-option",{key:"&ALLPICK&",attrs:{label:"全选",value:"&ALLPICK&"}}),t._v(" "),t._l(t.allDataList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})})],2)},staticRenderFns:[]},St=a("/Xao")(wt,xt,!1,function(t){a("k2ED")},null,null).exports,Ct={create:function(){},computed:{selectedList:function(){var t=this.tranDefForm.tab_disposal;return t&&""!==t.trim()?t.split(","):[]},txnIdVisible:function(){return"1"!==this.tranDefForm.txn_type},channVisible:function(){var t=this.tranDefForm.par_chann;return!(null===t||""===t||void 0===t)},modelusedVisible:function(){return"add"===this.tranDefForm.op},formReadonly:function(){return"T"===this.tranDefForm.tab_name||""===this.tranDefForm.tab_name&&""===this.tranDefForm.op}},data:function(){var t=this;return{tabDisposalList:[],tabDisposalSelectedCached:[],modelUsedList:[{label:"不使用模型",value:"0"},{label:"模型学习期",value:"1"}],channelList:[{channelname:"全渠道",channelid:"0"}],tranDefForm:{parent_tab:"",tab_name:"",modelused_o:"",traindate:"",op:"",tab_desc:"",show_order:"",txn_type:"0",txnid:"",tab_disposal:"",chann:"",par_chann:"",txnffname:"",modelused:"",is_enable:"1"},formLabelWidth:"120px",rules:{txnid:[{max:20,message:"交易识别标识不能超过20个字符",trigger:"blur"},{validator:J.checkFormEnSpecialCharacter,trigger:"blur"},{validator:function(e,a,i){var l=t;if(""===a.trim()&&"1"===l.tranDefForm.txn_type)return i(new Error("当交易类型为交易时,交易识别标识不能为空"));i()},trigger:"blur"}],chann:[{validator:function(e,a,i){var l=t;if(""===a.trim()&&"1"===l.tranDefForm.txn_type)return i(new Error("当交易类型为交易时,渠道不能为空"));i()},trigger:"blur"}],disposal:[{required:!0,message:"请选择处置策略",trigger:"blur"}],tab_desc:[{required:!0,message:"请输入名称",trigger:"blur"},{max:32,message:"交易识别标识不能超过32个字符",trigger:"blur"},{validator:J.checkFormZhSpecialCharacter,trigger:"blur"}],show_order:[{required:!0,message:"请输入顺序",trigger:"blur"},{type:"number",max:9999,min:0,message:"顺序必须为小于5位数的正整数",trigger:"blur"}]}}},watch:{tranDefForm:{handler:function(t){"0"===t.txn_type&&(t.txnid="")},deep:!0}},methods:{addStatParamDataChange:function(t){this.tranDefForm.tab_disposal=t.join(",")}},components:{AllPickSelect:St}},kt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{ref:"tranDefForm",staticStyle:{"text-align":"left","padding-right":"5em"},attrs:{model:t.tranDefForm,rules:t.rules,"label-suffix":"：","label-width":t.formLabelWidth}},[a("el-form-item",{staticClass:"hidden",attrs:{label:"",prop:"parent_tab"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.tranDefForm.parent_tab,callback:function(e){t.$set(t.tranDefForm,"parent_tab",e)},expression:"tranDefForm.parent_tab"}})],1),t._v(" "),a("el-form-item",{staticClass:"hidden",attrs:{label:"",prop:"tab_name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.tranDefForm.tab_name,callback:function(e){t.$set(t.tranDefForm,"tab_name",e)},expression:"tranDefForm.tab_name"}})],1),t._v(" "),a("el-form-item",{staticClass:"hidden",attrs:{label:"",prop:"modelused_o"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.tranDefForm.modelused_o,callback:function(e){t.$set(t.tranDefForm,"modelused_o",e)},expression:"tranDefForm.modelused_o"}})],1),t._v(" "),a("el-form-item",{staticClass:"hidden",attrs:{label:"",prop:"traindate"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.tranDefForm.traindate,callback:function(e){t.$set(t.tranDefForm,"traindate",e)},expression:"tranDefForm.traindate"}})],1),t._v(" "),a("el-form-item",{staticClass:"hidden",attrs:{label:"",prop:"op"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:t.tranDefForm.op,callback:function(e){t.$set(t.tranDefForm,"op",e)},expression:"tranDefForm.op"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"名称",prop:"tab_desc"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:t.formReadonly},model:{value:t.tranDefForm.tab_desc,callback:function(e){t.$set(t.tranDefForm,"tab_desc",e)},expression:"tranDefForm.tab_desc"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"顺序",prop:"show_order"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:t.formReadonly},model:{value:t.tranDefForm.show_order,callback:function(e){t.$set(t.tranDefForm,"show_order",t._n(e))},expression:"tranDefForm.show_order"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"交易类型"}},[a("el-radio",{attrs:{label:"0",disabled:t.formReadonly},model:{value:t.tranDefForm.txn_type,callback:function(e){t.$set(t.tranDefForm,"txn_type",e)},expression:"tranDefForm.txn_type"}},[t._v("交易组")]),t._v(" "),a("el-radio",{attrs:{label:"1",disabled:t.formReadonly},model:{value:t.tranDefForm.txn_type,callback:function(e){t.$set(t.tranDefForm,"txn_type",e)},expression:"tranDefForm.txn_type"}},[t._v("交易")])],1),t._v(" "),a("el-form-item",{class:{hidden:t.txnIdVisible},attrs:{label:"交易识别标识",prop:"txnid"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:t.formReadonly},model:{value:t.tranDefForm.txnid,callback:function(e){t.$set(t.tranDefForm,"txnid",e)},expression:"tranDefForm.txnid"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"处置策略:","label-width":t.formLabelWidth,prop:"tab_disposal"}},[a("AllPickSelect",{attrs:{dataList:t.tabDisposalList,selectedList:t.selectedList,disabled:t.formReadonly},on:{dataChange:t.addStatParamDataChange}})],1),t._v(" "),a("el-form-item",{attrs:{label:"渠道名称",prop:"chann"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:t.formReadonly||t.channVisible},model:{value:t.tranDefForm.chann,callback:function(e){t.$set(t.tranDefForm,"chann",e)},expression:"tranDefForm.chann"}},t._l(t.channelList,function(t){return a("el-option",{key:t.channelid,attrs:{label:t.channelname,value:t.channelid}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"上级交易",prop:"txnffname"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:"readonly"},model:{value:t.tranDefForm.txnffname,callback:function(e){t.$set(t.tranDefForm,"txnffname",e)},expression:"tranDefForm.txnffname"}})],1),t._v(" "),a("el-form-item",{class:{hidden:t.modelusedVisible},attrs:{label:"模型状态",prop:"modelused"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:t.formReadonly},model:{value:t.tranDefForm.modelused,callback:function(e){t.$set(t.tranDefForm,"modelused",e)},expression:"tranDefForm.modelused"}},t._l(t.modelUsedList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"有效性"}},[a("el-radio",{attrs:{label:"1",disabled:t.formReadonly},model:{value:t.tranDefForm.is_enable,callback:function(e){t.$set(t.tranDefForm,"is_enable",e)},expression:"tranDefForm.is_enable"}},[t._v("启用")]),t._v(" "),a("el-radio",{attrs:{label:"0",disabled:t.formReadonly},model:{value:t.tranDefForm.is_enable,callback:function(e){t.$set(t.tranDefForm,"is_enable",e)},expression:"tranDefForm.is_enable"}},[t._v("停用")])],1)],1)],1)},staticRenderFns:[]},$t=null,Lt={create:function(){},computed:{txnIdParent:function(){return this.txnId},isVisibilityParent:function(){return this.isVisibility}},data:function(){return{formLabelWidth:"120px",editVisible:!0,addFormVisible:!1,rules:{a:""}}},props:["txnId","isVisibility"],mounted:function(){this.$nextTick(function(){$t=this})},watch:{txnId:{handler:function(t,e){!0===$t.isVisibilityParent&&$t.initForm()}},isVisibility:{handler:function(t,e){!0===$t.isVisibilityParent&&$t.initForm()}}},methods:{initForm:function(){var t=this;if(t.$refs.infoForm.$refs.tranDefForm.clearValidate(),""!==t.txnId){var e={url:"/trandef/edit_prepare",param:{tab_name:t.txnId},success:function(e){var a=e.infos;a.tab_name&&""!==a.tab_name&&"T"!==a.tab_name?t.editVisible=!1:t.editVisible=!0;var i="0";""!==a.txnid&&void 0!==a.txnid&&(i="1"),t.$refs.infoForm.tranDefForm={parent_tab:a.parent_tab,tab_name:a.tab_name,modelused_o:a.modelused,traindate:a.traindate,op:"mod",tab_desc:a.tab_desc,show_order:a.show_order,txn_type:i,txnid:a.txnid,tab_disposal:a.tab_disposal,chann:a.chann,par_chann:a.par_chann,txnffname:a.par_tab_desc,modelused:a.modelused,is_enable:a.is_enable+""},t.$refs.infoForm.channelList=e.channs,t.getDisposal(e.infos.parent_tab,"infoForm")}};M.post(e)}},resetValidate:function(){this.$refs.addForm.$refs.tranDefForm.clearValidate()},resetForm:function(){var t=this,e=t.$refs.infoForm.tranDefForm,a=window.setInterval(function(){if(t.$refs.addForm){window.clearInterval(a);var i=e.chann?e.chann:"";t.$refs.addForm.channelList=t.$refs.infoForm.channelList,t.getDisposal(e.tab_name,"addForm"),t.$refs.addForm.tranDefForm={parent_tab:e.tab_name,tab_name:"",modelused_o:"",traindate:"",op:"add",tab_desc:"",show_order:"0",txn_type:"0",txnid:"",tab_disposal:"",chann:i,par_chann:i,txnffname:e.tab_desc,modelused:"0",is_enable:"0"}}},100)},getDisposal:function(t,e){var a=this,i={url:"/rule/disposal",param:{txn_id:t},success:function(t){var i=[],l=t.row;for(var o in l){var r={code_key:l[o].dp_code,code_value:l[o].dp_name};i.push(r)}a.$refs[e].tabDisposalList=i}};M.post(i)},submitForm:function(t){var e=this,a={url:"/trandef/save",param:"add"===t?e.$refs.addForm.tranDefForm:e.$refs.infoForm.tranDefForm,success:function(a){a.success&&("add"===t?(e.$message("添加成功"),e.addFormVisible=!1):e.$message("修改成功"),e.reloadPage())}};M.post(a)},delInfo:function(t){var e=this,a=this;this.$confirm("确定要删除交易吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={url:"/trandef/save",param:t,success:function(t){t.success&&(a.$message("删除交易成功"),a.reloadPage())}};M.post(e)}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},reloadPage:function(){window.location.reload()}},components:{TrandefForm:a("/Xao")(Ct,kt,!1,function(t){a("rSw5")},null,null).exports}},It={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("trandefForm",{ref:"infoForm"}),t._v(" "),a("div",[a("el-button",{attrs:{type:"primary",disabled:t.editVisible},on:{click:function(e){t.submitForm("edit")}}},[t._v("保存")])],1),t._v(" "),a("el-dialog",{attrs:{title:"新建交易",visible:t.addFormVisible},on:{"update:visible":function(e){t.addFormVisible=e},open:t.resetForm,close:t.resetValidate}},[a("trandefForm",{ref:"addForm"}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("add")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]},Pt=a("/Xao")(Lt,It,!1,function(t){a("kirL")},null,null).exports,Vt=null,Tt={create:function(){},computed:{txnIdParent:function(){return this.txnId},isVisibilityParent:function(){return this.isVisibility},tableData:function(){var t=this.expendNodeKey,e=this.dataList,a=[];for(var i in e)for(var l in e[i])if(e[i][l].length>0){var o=l.split("____");if(o&&2===o.length){if(a.push({tab_name:o[0],name:o[1],group_type:"group"}),-1===t.indexOf(l))break;for(var r in e[i][l]){var n=e[i][l][r];n.group_type="item",a.push(n)}}}return a}},props:["txnId","isVisibility"],data:function(){return{toggleIcon:["el-icon-arrow-up","el-icon-arrow-down"],dataList:[],expendNodeKey:[]}},mounted:function(){this.$nextTick(function(){Vt=this})},watch:{txnId:{handler:function(t,e){!0===Vt.isVisibilityParent&&Vt.initForm()}},isVisibility:{handler:function(t,e){!0===Vt.isVisibilityParent&&Vt.initForm()}}},methods:{initForm:function(){var t=this,e={url:"/tranmdl/query",param:{tab_name:t.txnId},success:function(e){var a=e.txnfds;if(a){t.dataList=a;var i=[];for(var l in a)for(var o in a[l])i.push(o);t.expendNodeKey=i}}};M.post(e)},groupHandle:function(t){var e=t.row,a=(t.column,t.rowIndex,t.columnIndex);if("group"===e.group_type)switch(a){case 1:return[1,9];default:return[0,0]}},groupClassName:function(t){var e=t.row;t.rowIndex;return"group"===e.group_type?"groupStyle":""},groupIcon:function(t){if("group"!==t.group_type)return"";var e=this.expendNodeKey,a=t.tab_name+"____"+t.name;return e.indexOf(a)>-1?this.toggleIcon[0]:this.toggleIcon[1]},toggleListHandle:function(t,e){if("group"===t.group_type){var a=e.path,i=null;for(var l in a)"cell"===a[l].className&&(i=a[l]);var o=t.tab_name+"____"+t.name,r=this.expendNodeKey,n=i.getElementsByTagName("i");"el-icon-arrow-up"===n[0].getAttribute("class")?r.indexOf(o)>-1&&r.splice(r.indexOf(o),1):"el-icon-arrow-down"===n[0].getAttribute("class")&&r.push(o),this.expendNodeKey=r}}}},Rt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-container",[a("el-header",{staticStyle:{"text-align":"left","line-height":"2em"},attrs:{height:"30px"}},[a("div",[t._v("交易模型")])]),t._v(" "),a("el-main",[a("el-table",{ref:"formList",staticStyle:{width:"100%"},attrs:{data:t.tableData,"span-method":t.groupHandle,"row-class-name":t.groupClassName,"max-height":"430"},on:{"row-dblclick":t.toggleListHandle}},[a("el-table-column",{attrs:{type:"selection",width:"35",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{label:"属性名称",prop:"name"},scopedSlots:t._u([{key:"default",fn:function(e){return["group"===e.row.group_type?a("i",{class:t.groupIcon(e.row)}):t._e(),t._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"属性代码",prop:"ref_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"数据来源",prop:"src_id"}}),t._v(" "),a("el-table-column",{attrs:{label:"类型",prop:"type"}}),t._v(" "),a("el-table-column",{attrs:{label:"存储字段",prop:"fd_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"关联代码集",prop:"code"}}),t._v(" "),a("el-table-column",{attrs:{label:"默认值",prop:"src_default"}}),t._v(" "),a("el-table-column",{attrs:{label:"处理函数",prop:"genesisrul"}})],1)],1)],1)],1)},staticRenderFns:[]},zt=a("/Xao")(Tt,Rt,!1,function(t){a("9QEf")},null,null).exports,Nt=null,Et={computed:{txnIdParent:function(){return this.txnId}},data:function(){return{firstOpen:!0,statCondInDialogVisible:!1,formItemStyle:{width:"330px"},formItemContentStyle:{width:"200px"},textareaContentStyle:{width:"540px"},formLabelWidth:"120px",statFnDialogVisible:!1,selectArea:[0,0],statCondInDictDialogForm:this.initStatCondInDictDialogForm(),treeData:[],defaultProps:{children:"children",label:"text"},itemShow:{stat_datafd:!0,stat_fn:!0,date_func:!0,str_func:!0,oper_func:!0,roster_func:!0,diy_func:!0,rule_func:!0,ac_func:!0},expendKey:["T"],statDatafdList:[],dateFuncList:[],strFuncList:[],operFuncList:[],rosterFuncList:[],diyFuncList:[],ruleFuncList:[],acFuncList:[],allSelectData:new Dt.a}},props:{statCond:{type:String,default:""},statCondIn:{type:String,default:""},txnId:{type:String,default:""},hideItems:{type:Array,default:function(){return[]}}},watch:{txnIdParent:{handler:function(t,e){}},"statCondInDictDialogForm.stat_cond_value":{handler:function(t,e){Nt.searchCondName(t,1)}},"statCondInDictDialogForm.stat_cond_in":{handler:function(t,e){Nt.searchCondName(t,2)}}},mounted:function(){this.$nextTick(function(){Nt=this,this.statCondInDictDialogForm.stat_cond_value=this.statCond,this.statCondInDictDialogForm.stat_cond_in=this.statCondIn;var t=this.hideItems,e=!0,a=!1,i=void 0;try{for(var l,o=T()(t);!(e=(l=o.next()).done);e=!0){var r=l.value;this.itemShow[r]=!1}}catch(t){a=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(a)throw i}}})},methods:{getSelectedPostion:function(t){var e=[0,0],a=t;if("number"==typeof a.selectionStart)e=[a.selectionStart,a.selectionEnd];else if(document.selection){var i=0,l=0,o=document.selection.createRange();if(o.parentElement()==a){for((n=document.body.createTextRange()).moveToElementText(a),i=0;n.compareEndPoints("StartToStart",o)<0;i++)n.moveStart("character",1);for(var r=0;r<=i;r++)"\n"==a.value.charAt(r)&&i++;var n;for((n=document.body.createTextRange()).moveToElementText(a),l=0;n.compareEndPoints("StartToEnd",o)<0;l++)n.moveStart("character",1);for(var s=0;s<=l;s++)"\n"==a.value.charAt(s)&&l++}e=[i,l]}this.selectArea=e},selectChange:function(t){this.selectChangeCommon(t)},selectChangeAddBracket:function(t){this.selectChangeCommon(t+"()")},selectChangeCommon:function(t){var e=this,a=this.statCondInDictDialogForm.stat_cond_value,i=this.selectArea;console.log(i);var l=[a.substr(0,i[0]),t,a.substr(i[1])];this.statCondInDictDialogForm=this.initStatCondInDictDialogForm(),this.statCondInDictDialogForm.stat_cond_value=l.join(""),setTimeout(function(){var t=e.$refs.statCondValue.$refs.textarea;t.focus(),e.getSelectedPostion(t)},300)},initStatCondInDictDialogForm:function(){return{stat_datafd:"",stat_fn:"",date_func:"",str_func:"",oper_func:"",roster_func:"",diy_func:"",rule_func:"",ac_func:"",stat_cond_value:"",stat_cond_in:""}},initData:function(){this.selTree(),this.getStatDataFdSelectData(),this.getRuleFuncList(),this.getCodeData("operFuncList","tms.pub.func","3",!0),this.getCodeData("diyFuncList","tms.pub.func","1"),this.getCodeData("acFuncList","tms.pub.func","7"),this.getCodeData("dateFuncList","tms.pub.func","4"),this.getCodeData("strFuncList","tms.pub.func","5"),this.getCodeData("rosterFuncList","tms.pub.roster");var t=this;setTimeout(function(){t.searchCondName(t.statCondInDictDialogForm.stat_cond_value,1)},500)},reloadData:function(){this.getStatDataFdSelectData(),this.getRuleFuncList()},getStatDataFdSelectData:function(){var t=this;M.post({url:"/stat/txnFeature",param:{txn_id:this.txnIdParent},success:function(e){if(e.row){t.statDatafdList=[];var a=!0,i=!1,l=void 0;try{for(var o,r=T()(e.row);!(a=(o=r.next()).done);a=!0){var n=o.value;t.allSelectData.add({code_key:n.code_key,code_value:n.code_value}),n.code_value=n.code_value+"("+n.code_key+")",t.statDatafdList.push(n)}}catch(t){i=!0,l=t}finally{try{!a&&r.return&&r.return()}finally{if(i)throw l}}}}})},getRuleFuncList:function(){var t=this;M.post({url:"/stat/txnrulelist",param:{txn_id:this.txnIdParent},success:function(e){if(e.row){t.ruleFuncList=[];var a=!0,i=!1,l=void 0;try{for(var o,r=T()(e.row);!(a=(o=r.next()).done);a=!0){var n=o.value;t.allSelectData.add({code_key:n.code_key,code_value:n.code_value}),n.code_value=n.code_value+"("+n.code_key+")",t.ruleFuncList.push(n)}}catch(t){i=!0,l=t}finally{try{!a&&r.return&&r.return()}finally{if(i)throw l}}}}})},getCodeData:function(t,e,a,i){var l=this,o={};o.category_id=e,a&&(o.args=a),M.post({url:"/stat/code",param:o,success:function(e){if(e.row){l[t]=[];var a=!0,o=!1,r=void 0;try{for(var n,s=T()(e.row);!(a=(n=s.next()).done);a=!0){var c=n.value;i||l.allSelectData.add({code_key:c.code_key,code_value:c.code_value}),c.code_value=c.code_value+"("+c.code_key+")",l[t].push(c)}}catch(t){o=!0,r=t}finally{try{!a&&s.return&&s.return()}finally{if(o)throw r}}}}})},renderContent:function(t,e){var a=e.node;e.data,e.store;return 0===a.data.enable?t("span",{class:"el-tree-node__label disabledFlag"},[a.label]):t("span",{class:"el-tree-node__label"},[a.label])},selTree:function(){var t=this,e={url:"/stat/statfunc",success:function(e){if(e.row){t.treeList=e.row,t.treeData=t.formatTreeData(e.row);var a=!0,i=!1,l=void 0;try{for(var o,r=T()(e.row);!(a=(o=r.next()).done);a=!0){var n=o.value;2==n.ftype&&t.allSelectData.add({code_key:n.code_key,code_value:n.code_value})}}catch(t){i=!0,l=t}finally{try{!a&&r.return&&r.return()}finally{if(i)throw l}}}}};M.post(e)},formatTreeData:function(t,e){function a(t,e){var i=[];for(var l in t){var o=t[l];o.fid===e&&(o.children=a(t,o.id),i.push(o))}return i}var i=[];if(void 0===e||0===e.length){e=[];for(var l in t)t[l].text=t[l].code_value+"("+t[l].code_key+")",void 0!==t[l].fid&&null!==t[l].fid&&""!==t[l].fid||e.push(t[l])}0===e.length&&(console.error("根节点不存在，请确认树结构是否正确"),console.info("树结构的根节点是fid不存在（或为空）的节点，否则需手动添加指定得根节点（参数）"));for(var o in e){var r=e[o];r.children=a(t,r.id),i.push(r)}return i},searchCondName:function(t,e){if(""===t||null==t)return this.statCondInDictDialogForm.stat_cond_value="",void(this.statCondInDictDialogForm.stat_cond_in="");var a="code_key",i="code_value";2===e&&(i="code_key",a="code_value");var l=t,o=!0,r=!1,n=void 0;try{for(var s,c=T()(this.allSelectData);!(o=(s=c.next()).done);o=!0){var u=s.value;u[a]&&(l=l.replace(new RegExp(B.escapeExprSpecialWord(u[a]),"g"),u[i]))}}catch(t){r=!0,n=t}finally{try{!o&&c.return&&c.return()}finally{if(r)throw n}}2===e?this.statCondInDictDialogForm.stat_cond_value=l:this.statCondInDictDialogForm.stat_cond_in=l},handleNodeClick:function(t,e){e.isLeaf&&this.selectChangeCommon(t.code_key)},closeDialog:function(){this.statCondInDialogVisible=!1},callback:function(){var t={stat_cond_value:this.statCondInDictDialogForm.stat_cond_value,stat_cond_in:this.statCondInDictDialogForm.stat_cond_in};this.$emit("valueCallback",t),this.statCondInDialogVisible=!1},reset:function(){this.statCondInDictDialogForm.stat_cond_value="",this.statCondInDictDialogForm.stat_cond_in=""},setValue:function(t){this.statCondInDictDialogForm.stat_cond_value=t.stat_cond_value,this.statCondInDictDialogForm.stat_cond_in=t.stat_cond_in},open:function(){if(this.firstOpen){var t=this;this.initData(),setTimeout(function(){var e=t.$refs.statCondValue.$refs.textarea;e.addEventListener("keydown",function(){t.getSelectedPostion(e)}),e.addEventListener("keyup",function(){t.getSelectedPostion(e)}),e.addEventListener("mousedown",function(){t.getSelectedPostion(e)}),e.addEventListener("mouseup",function(){t.getSelectedPostion(e)}),e.addEventListener("focus",function(){t.getSelectedPostion(e)})},300)}this.firstOpen=!1,this.statCondInDialogVisible=!0}}},qt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{ref:"StatCondDialog",attrs:{title:"条件",visible:t.statCondInDialogVisible},on:{"update:visible":function(e){t.statCondInDialogVisible=e}}},[a("el-form",{ref:"statCondInDictDialogForm",staticStyle:{"text-align":"left"},attrs:{model:t.statCondInDictDialogForm,inline:!0}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.itemShow.stat_datafd,expression:"itemShow.stat_datafd"}],style:t.formItemStyle,attrs:{label:"交易属性:","label-width":t.formLabelWidth,prop:"stat_datafd"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",clearable:""},on:{change:t.selectChange},model:{value:t.statCondInDictDialogForm.stat_datafd,callback:function(e){t.$set(t.statCondInDictDialogForm,"stat_datafd",e)},expression:"statCondInDictDialogForm.stat_datafd"}},t._l(t.statDatafdList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})}))],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.itemShow.stat_fn,expression:"itemShow.stat_fn"}],style:t.formItemStyle,attrs:{label:"交易统计:","label-width":t.formLabelWidth,prop:"stat_fn"}},[a("div",{on:{dblclick:function(e){t.statFnDialogVisible=!0}}},[a("el-input",{style:t.formItemContentStyle,attrs:{"auto-complete":"off",readonly:""},model:{value:t.statCondInDictDialogForm.stat_fn,callback:function(e){t.$set(t.statCondInDictDialogForm,"stat_fn",e)},expression:"statCondInDictDialogForm.stat_fn"}})],1)]),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.itemShow.date_func,expression:"itemShow.date_func"}],style:t.formItemStyle,attrs:{label:"日期函数:","label-width":t.formLabelWidth,prop:"date_func"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",clearable:""},on:{change:t.selectChangeAddBracket},model:{value:t.statCondInDictDialogForm.date_func,callback:function(e){t.$set(t.statCondInDictDialogForm,"date_func",e)},expression:"statCondInDictDialogForm.date_func"}},t._l(t.dateFuncList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})}))],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.itemShow.str_func,expression:"itemShow.str_func"}],style:t.formItemStyle,attrs:{label:"字符函数:","label-width":t.formLabelWidth,prop:"str_func"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",clearable:""},on:{change:t.selectChangeAddBracket},model:{value:t.statCondInDictDialogForm.str_func,callback:function(e){t.$set(t.statCondInDictDialogForm,"str_func",e)},expression:"statCondInDictDialogForm.str_func"}},t._l(t.strFuncList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})}))],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.itemShow.oper_func,expression:"itemShow.oper_func"}],style:t.formItemStyle,attrs:{label:"字符函数:","label-width":t.formLabelWidth,prop:"oper_func"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",clearable:""},on:{change:t.selectChange},model:{value:t.statCondInDictDialogForm.oper_func,callback:function(e){t.$set(t.statCondInDictDialogForm,"oper_func",e)},expression:"statCondInDictDialogForm.oper_func"}},t._l(t.operFuncList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})}))],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.itemShow.roster_func,expression:"itemShow.roster_func"}],style:t.formItemStyle,attrs:{label:"名单:","label-width":t.formLabelWidth,prop:"roster_func"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",clearable:""},on:{change:t.selectChange},model:{value:t.statCondInDictDialogForm.roster_func,callback:function(e){t.$set(t.statCondInDictDialogForm,"roster_func",e)},expression:"statCondInDictDialogForm.roster_func"}},t._l(t.rosterFuncList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})}))],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.itemShow.diy_func,expression:"itemShow.diy_func"}],style:t.formItemStyle,attrs:{label:"自定义函数:","label-width":t.formLabelWidth,prop:"diy_func"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",clearable:""},on:{change:t.selectChangeAddBracket},model:{value:t.statCondInDictDialogForm.diy_func,callback:function(e){t.$set(t.statCondInDictDialogForm,"diy_func",e)},expression:"statCondInDictDialogForm.diy_func"}},t._l(t.diyFuncList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})}))],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.itemShow.rule_func,expression:"itemShow.rule_func"}],style:t.formItemStyle,attrs:{label:"交易规则:","label-width":t.formLabelWidth,prop:"rule_func"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",clearable:""},on:{change:t.selectChange},model:{value:t.statCondInDictDialogForm.rule_func,callback:function(e){t.$set(t.statCondInDictDialogForm,"rule_func",e)},expression:"statCondInDictDialogForm.rule_func"}},t._l(t.ruleFuncList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})}))],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.itemShow.ac_func,expression:"itemShow.ac_func"}],style:t.formItemStyle,attrs:{label:"动作函数:","label-width":t.formLabelWidth,prop:"ac_func"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",clearable:""},on:{change:t.selectChangeAddBracket},model:{value:t.statCondInDictDialogForm.ac_func,callback:function(e){t.$set(t.statCondInDictDialogForm,"ac_func",e)},expression:"statCondInDictDialogForm.ac_func"}},t._l(t.acFuncList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})}))],1),t._v(" "),a("div",[a("el-form-item",{attrs:{label:"条件表达式:","label-width":t.formLabelWidth,prop:"stat_cond_value"}},[a("el-input",{ref:"statCondValue",style:t.textareaContentStyle,attrs:{type:"textarea"},model:{value:t.statCondInDictDialogForm.stat_cond_value,callback:function(e){t.$set(t.statCondInDictDialogForm,"stat_cond_value",e)},expression:"statCondInDictDialogForm.stat_cond_value"}})],1)],1),t._v(" "),a("div",[a("el-form-item",{attrs:{label:"解释:","label-width":t.formLabelWidth,prop:"stat_cond_in"}},[a("el-input",{ref:"statCondIn",style:t.textareaContentStyle,attrs:{type:"textarea"},model:{value:t.statCondInDictDialogForm.stat_cond_in,callback:function(e){t.$set(t.statCondInDictDialogForm,"stat_cond_in",e)},expression:"statCondInDictDialogForm.stat_cond_in"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"stat-cond-form-footer"},[a("el-button",{on:{click:t.closeDialog}},[t._v("取 消")]),t._v(" "),a("el-button",{on:{click:t.reset}},[t._v("重 置")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.callback}},[t._v("确 定")])],1),t._v(" "),a("el-dialog",{attrs:{title:"交易统计",visible:t.statFnDialogVisible,width:"400px","append-to-body":""},on:{"update:visible":function(e){t.statFnDialogVisible=e}}},[a("el-tree",{ref:"tree",staticStyle:{"overflow-y":"auto"},attrs:{data:t.treeData,"node-key":"id",props:t.defaultProps,"highlight-current":!0,"default-expanded-keys":t.expendKey,"expand-on-click-node":!1,"render-content":t.renderContent},on:{"node-click":t.handleNodeClick}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.statFnDialogVisible=!1}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]},At={computed:{defalutTimeValue:function(){var t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),[t,t]}},data:function(){return{formItemContentStyle:{width:"180px"},dialogVisible:!1,paramsType:"",paramTypeReal:"",dateDataList:[],numDataList:[]}},props:{},mounted:function(){this.$nextTick(function(){})},watch:{},methods:{open:function(t,e){if(this.dialogVisible=!0,this.paramTypeReal=e,void 0===e||"datetime"!==e&&"time"!==e)if(this.paramsType="number",this.numDataList=[],t&&""!==t){var a=t.split("|"),i=!0,l=!1,o=void 0;try{for(var r,n=T()(a);!(i=(r=n.next()).done);i=!0){var s=r.value.split(",");this.numDataList.push(this.genNumberObj(s[0],s[1]))}}catch(t){l=!0,o=t}finally{try{!i&&n.return&&n.return()}finally{if(l)throw o}}}else this.numDataList.push(this.genNumberObj(null,null));else if(this.paramsType="date",this.dateDataList=[],t&&""!==t){var c=t.split("|"),u=!0,d=!1,m=void 0;try{for(var f,p=T()(c);!(u=(f=p.next()).done);u=!0){var h=f.value.split(","),g=this.str2Date(h[0]),v=this.str2Date(h[1]);this.dateDataList.push(this.genDateObj(g,v))}}catch(t){d=!0,m=t}finally{try{!u&&p.return&&p.return()}finally{if(d)throw m}}}else this.dateDataList.push(this.genDateObj(null,null))},callback:function(){if("date"===this.paramsType){for(var t=0;t<this.dateDataList.length;t++){var e=this.dateDataList[t];if(null!=e.dateArray){var a=e.dateArray[0],i=e.dateArray[1];if(a>=i)return void this.$message("第"+(t+1)+"行，开始时间必须小于结束时间");for(var l=0;l<t;l++){var o=this.dateDataList[l];if(null!=o.dateArray){var r=o.dateArray[0],n=o.dateArray[1];if(console.log(r.toLocaleString(),n.toLocaleString(),a.toLocaleString(),i.toLocaleString()),!(r<=a&&n<=a||r>=i&&n>=i))return void this.$message("第"+(t+1)+"行，时间区间与第"+(l+1)+"重复")}}}}for(var s=[],c=0;c<this.dateDataList.length;c++){var u=this.dateDataList[c];if(null!=u.dateArray){var d=this.formatDate(u.dateArray[0]),m=this.formatDate(u.dateArray[1]);s.push(d+","+m)}}this.$emit("valueCallback",s.join("|")),this.dialogVisible=!1}else{for(var f=0;f<this.numDataList.length;f++){var p=this.numDataList[f];if(null!=p.numberArray){var h=p.numberArray[0],g=p.numberArray[1],v=this.checkNum(h,f,!0);if(""!==v)return void this.$message(v);var b=this.checkNum(g,f,!1);if(""!==b)return void this.$message(b);var _=""===h?0:parseFloat(h);if(_>=(""===g?0:parseFloat(g)))return void this.$message("第("+(parseInt(f)+1)+")行：结束值必须大于开始值");if(f>0){var y=this.numDataList[f-1];if(null!=y.numberArray){var F=y.numberArray[1];if(_<(""===F?0:parseFloat(F)))return void this.$message("第("+(parseInt(f)+1)+")行：开始值不能小于上一行的结束值")}}}}for(var D=[],w=0;w<this.numDataList.length;w++){var x=this.numDataList[w];if(null!=x.numberArray){var S=x.numberArray[0],C=x.numberArray[1];D.push(S+","+C)}}this.$emit("valueCallback",D.join("|")),this.dialogVisible=!1}},str2Date:function(t){var e=t.split(":"),a=new Date;return a.setHours(e[0]),a.setMinutes(e[1]),a.setSeconds(e[2]),a},genDateObj:function(t,e){var a=Math.round(1e8*Math.random());return null!=t&&null!=e?{dateArray:[t,e],id:a}:{dateArray:null,id:a}},genNumberObj:function(t,e){var a=Math.round(1e8*Math.random());return null!=t&&null!=e?{numberArray:[t,e],id:a}:{numberArray:["",""],id:a}},delRow:function(t){"date"===this.paramsType?this.dateDataList.splice(this.dateDataList.findIndex(function(e){return e.id===t.id}),1):this.numDataList.splice(this.numDataList.findIndex(function(e){return e.id===t.id}),1)},addRow:function(){"date"===this.paramsType?this.dateDataList.push(this.genDateObj(null,null)):this.numDataList.push(this.genNumberObj(null,null))},formatDate:function(t){return t.getHours().toString()+":"+t.getMinutes().toString()+":"+t.getSeconds().toString()},checkNum:function(t,e,a){if(""===t&&(t="0"),"double"===this.paramTypeReal||"money"===this.paramTypeReal){if(""!==t&&!B.isNumber(t,"+",2))return"第("+(parseInt(e)+1)+")行："+(a?"开始值":"结束值")+"请输入非负小数（保留两位小数）或非负整数";if(t.length>15)return"第("+(parseInt(e)+1)+")行："+(a?"开始值":"结束值")+"不能超过15个字符"}else if("long"===this.paramTypeReal){if(""!==t&&!B.isNumber(t,"+","0"))return"第("+(parseInt(e)+1)+")行："+(a?"开始值":"结束值")+"请输入非负整数";if(t.length>15)return"第("+(parseInt(e)+1)+")行："+(a?"开始值":"结束值")+"不能超过15个字符"}return""}}},Bt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{ref:"StatCondDialog",attrs:{title:"参数配置",visible:t.dialogVisible,width:"500px"},on:{"update:visible":function(e){t.dialogVisible=e}}},["date"===t.paramsType?a("div",t._l(t.dateDataList,function(e,i){return a("div",{staticClass:"fn-param-item"},[a("el-time-picker",{attrs:{"is-range":"","default-value":t.defalutTimeValue,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",placeholder:"选择时间范围"},model:{value:e.dateArray,callback:function(a){t.$set(e,"dateArray",a)},expression:"item.dateArray"}}),t._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:function(a){t.delRow(e)}}},[t._v("删 除")])],1)})):t._e(),t._v(" "),"number"===t.paramsType?a("div",["number"===t.paramsType?a("div",{staticClass:"fn-param-item"},[a("el-form",{staticStyle:{"text-align":"left"},attrs:{inline:!0}},t._l(t.numDataList,function(e,i){return a("div",{staticClass:"fn-param-item"},[a("el-input",{style:t.formItemContentStyle,attrs:{"auto-complete":"off"},model:{value:e.numberArray[0],callback:function(a){t.$set(e.numberArray,0,a)},expression:"item.numberArray[0]"}}),t._v("\n          -\n          "),a("el-input",{style:t.formItemContentStyle,attrs:{"auto-complete":"off"},model:{value:e.numberArray[1],callback:function(a){t.$set(e.numberArray,1,a)},expression:"item.numberArray[1]"}}),t._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:function(a){t.delRow(e)}}},[t._v("删 除")])],1)}))],1):t._e()]):t._e(),t._v(" "),a("div",{staticClass:"stat-cond-form-footer"},[a("el-button",{on:{click:t.addRow}},[t._v("增 加")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.callback}},[t._v("确 定")])],1)])],1)},staticRenderFns:[]},Ot=null,Wt=[{recap:"long",type:["long","time","datetime"]},{recap:"double",type:["double","money"]},{recap:"string",type:["string","devid","ip","userid","acc","code","object"]}],jt={computed:{txnIdParent:function(){return console.log("stat txnId change"),this.txnId},isVisibilityParent:function(){return this.isVisibility},notSelectOne:function(){return 1!==this.selectedRows.length},formStatCondInName:function(){return"calculat_expressions"===this.dialogForm.stat_fn?"表达式:":"统计条件:"},StatCondInRequired:function(){return"calculat_expressions"===this.dialogForm.stat_fn},tableDataShow:function(){var t=this.queryShowForm.stat_name,e=this.queryShowForm.stat_desc,a=this.queryShowForm.stat_param,i=this.queryShowForm.stat_datafd,l=this.queryShowForm.stat_fn,o=this.queryShowForm.stat_valid;return this.tableData.filter(function(r){if(""!==t&&!r.stat_name.includes(t))return console.log("stat_name"),!1;if(""!==e&&!r.stat_desc.includes(e))return console.log("stat_desc"),!1;if(null!=a&&a.length>0){for(var n=!1,s=0;s<a.length;s++)if(r.stat_param===a[s]){n=!0;break}if(!n)return console.log("containStatParam"),!1}return(null==i||""===i||r.stat_datafd===i)&&((null==l||""===l||r.stat_fn===l)&&(null==o||""===o||r.stat_valid==o))})}},data:function(){return{modelName:"",isExpand:!1,tableData:[],allStoreFd:[],enableStoreFd:[],dialogTitle:"",dialogType:"",dialogVisible:!1,statCondInDialogVisible:!1,formLabelWidth:"120px",formItemStyle:{width:"400px"},formItemContentStyle:{width:"250px"},queryFormShow:!1,queryShowForm:{stat_name:"",stat_desc:"",stat_param:"",stat_datafd:"",stat_fn:"",stat_valid:""},statParamInitList:[],dialogForm:this.initDialogForm(),allPickCollapse:!1,statCondInDictDialogForm:{},statParamList:[],statDataFdList:[],statFnList:[],coununitList:[],statValidList:[],resultCondList:[],datatypeCodeList:[],storecolumnCodeList:[],formStatDescShow:!0,formStatParamShow:!0,formStatFnShow:!0,formStatCondInShow:!0,formStatDatafdShow:!0,formFnParamShow:!0,formCoununitShow:!0,formCountroundShow:!0,formResultCondShow:!0,formDatatypeShow:!0,formStoreColumnShow:!0,formContinuesShow:!0,formStatUnresultShow:!0,formStatValidShow:!0,modDisabled:!1,viewDisabled:!1,dialogFormRules:{stat_desc:[{required:!0,message:"统计描述不能为空",trigger:"blur"},{max:200,message:"长度在200个字符以内",trigger:"blur"},{validator:J.checkFormZhSpecialCharacter,trigger:"blur"}],stat_cond:[{validator:this.checkStatCond,trigger:"blur"}],stat_fn:[{required:!0,message:"统计函数不能为空",trigger:"change"}],stat_param:[{validator:this.checkStatParam,trigger:"blur"}],stat_datafd:[{validator:this.checkStatDataFd,trigger:"change"}],fn_param:[{validator:this.checkFnParam,trigger:"change"}],coununit:[{validator:this.checkCoununit,trigger:"change"}],countround:[{validator:this.checkCountround,trigger:"blur"}],result_cond:[{validator:this.checkResultCond,trigger:"change"}],datatype:[{validator:this.checkDatatype,trigger:"change"}],stat_valid:[{validator:this.checkStatValid,trigger:"change"}]},currentPage:1,pageSize:10,total:0,selectedRows:[]}},props:["txnId","isVisibility"],mounted:function(){this.$nextTick(function(){Ot=this})},watch:{txnId:{handler:function(t,e){!0===Ot.isVisibilityParent&&Ot.reloadData()}},isVisibility:{handler:function(t,e){!0===Ot.isVisibilityParent&&Ot.reloadData()}},"dialogForm.stat_fn":{handler:function(t,e){Ot.fnChangeEvent(),Ot.countroundChangeEvent()}},"dialogForm.coununit":{handler:function(t,e){Ot.countroundChangeEvent()}},"dialogForm.stat_datafd":{handler:function(t,e){Ot.datafdChangeEvent()}}},filters:{renderDateTime:function(t){return B.renderDateTime(t)},renderStatValidFilter:function(t){return rt.rendCode("tms.mgr.rulestatus",t)},statParamFilter:function(t){if(null===t||""===t)return"";var e=[],a=t.split(","),i=!0,l=!1,o=void 0;try{for(var r,n=T()(a);!(i=(r=n.next()).done);i=!0)for(var s=r.value,c=0;c<Ot.statParamList.length;c++){var u=Ot.statParamList[c];if(""!==s&&s===u.code_key){e.push(u.code_value);break}}}catch(t){l=!0,o=t}finally{try{!i&&n.return&&n.return()}finally{if(l)throw o}}return e.join(",")},statDataFdFilter:function(t){if(null===t||""===t)return"";var e=[],a=t.split(","),i=!0,l=!1,o=void 0;try{for(var r,n=T()(a);!(i=(r=n.next()).done);i=!0)for(var s=r.value,c=0;c<Ot.statDataFdList.length;c++){var u=Ot.statDataFdList[c];if(""!==s&&s===u.code_key){e.push(u.code_value);break}}}catch(t){l=!0,o=t}finally{try{!i&&n.return&&n.return()}finally{if(l)throw o}}return e.join(",")},statFnFilter:function(t){if(null===t||""===t)return"";var e=[],a=t.split(","),i=!0,l=!1,o=void 0;try{for(var r,n=T()(a);!(i=(r=n.next()).done);i=!0)for(var s=r.value,c=0;c<Ot.statFnList.length;c++){var u=Ot.statFnList[c];if(""!==s&&s===u.code_key){e.push(u.code_value);break}}}catch(t){l=!0,o=t}finally{try{!i&&n.return&&n.return()}finally{if(l)throw o}}return e.join(",")}},methods:{initDialogForm:function(){return{stat_desc:"",stat_param:"",stat_param_list:"",stat_fn:"",stat_cond:"",stat_cond_in:"",fn_param:"",stat_datafd:"",coununit:"",countround:"",result_cond:"",datatype:"",storecolumn:"",continues:0,stat_unresult:0,stat_valid:0}},handleSelectionChange:function(t){this.selectedRows=t},reloadData:function(){this.getStatParamSelectData(),this.statValidList=rt.getCodeItems("tms.mgr.rulestatus"),this.resultCondList=rt.getCodeItems("tms.stat.txnstatus"),this.datatypeCodeList=rt.getCodeItems("tms.stat.datatype"),this.coununitList=rt.getCodeItems("tms.stat.condunit")},getData:function(){var t=this,e={txnId:this.txnIdParent};M.post({url:"/stat/list",param:e,success:function(e){e.row&&(t.tableData=e.row,t.allStoreFd=e.allstorefd,t.enableStoreFd=e.enablestorefd)}})},getStatParamSelectData:function(){var t=this;M.post({url:"/stat/txnFeature",param:{txn_id:this.txnIdParent},success:function(e){if(e.row){t.statParamList=[],t.statDataFdList=[];var a=!0,i=!1,l=void 0;try{for(var o,r=T()(e.row);!(a=(o=r.next()).done);a=!0){var n=o.value;t.statParamList.push(n),t.statDataFdList.push(n)}}catch(t){i=!0,l=t}finally{try{!a&&r.return&&r.return()}finally{if(i)throw l}}M.post({url:"/stat/code",model:M.model.manager,param:{category_id:"tms.pub.func",args:2},success:function(e){if(e.row){t.statFnList=[];var a=!0,i=!1,l=void 0;try{for(var o,r=T()(e.row);!(a=(o=r.next()).done);a=!0){var n=o.value;t.statFnList.push(n)}}catch(t){i=!0,l=t}finally{try{!a&&r.return&&r.return()}finally{if(i)throw l}}t.getData()}}})}}})},rowSelectable:function(){return!this.isExpand},dialogOpenHandle:function(){this.formDatatypeShow=!1,this.fnChangeEventCommon(),this.countroundChangeEvent(),this.dialogType},delData:function(t){var e=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a={};a.del=[t];var i={};i.postData=a,i.txnId=e.txnIdParent;var l=e;M.post({url:"/stat/save",param:i,success:function(t){l.getData(),l.$message("删除成功")}})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},statValidChange:function(t){var e={};e["valid-y"]=[t];var a={};a.postData=e,a.txnId=this.txnIdParent;var i=this,l="编辑成功";l=1===t.stat_valid?"已启用":"已停用",M.post({url:"/stat/save",param:a,success:function(t){i.$message(l)}})},openDialog:function(t,e){this.dialogType=t;var a=this;if("edit"===t)this.allPickCollapse=!0,this.dialogTitle="编辑交易统计",this.modDisabled=!0,this.viewDisabled=!1,k()(this.dialogForm,this.selectRowNum2Str(e)),setTimeout(function(){""!==a.dialogForm.stat_param&&(a.statParamInitList=e.stat_param.split(",")),a.dialogForm.fn_param=e.fn_param},300);else if("add"===t)this.allPickCollapse=!0,this.dialogTitle="新建交易统计",this.modDisabled=!1,this.viewDisabled=!1,this.dialogForm=this.initDialogForm(),this.statParamInitList=[];else if("view"===t){this.allPickCollapse=!1,this.dialogTitle="查看交易统计";if(1!==this.selectedRows.length)return void this.$message("请选择一行交易统计信息。");this.viewDisabled=!0,this.modDisabled=!1,setTimeout(function(){""!==a.dialogForm.stat_param&&(a.statParamInitList=a.selectedRows[0].stat_param.split(",")),a.dialogForm.fn_param=a.selectedRows[0].fn_param},300),k()(this.dialogForm,this.selectRowNum2Str(this.selectedRows[0]))}this.dialogVisible=!0,this.dialogOpenHandle(),setTimeout(function(){a.$refs.dialogForm&&a.$refs.dialogForm.clearValidate()},100)},selectRowNum2Str:function(t){var e={};k()(e,t);for(var a in e)"number"==typeof e[a]&&(e[a]=e[a].toString());return e},submitForm:function(t){var e=this;console.log(t),this.$refs[t].validate(function(t){if(t){var a=e;console.log(e.dialogForm);var i={};k()(i,e.dialogForm),i.stat_txn=e.txnIdParent,i.continues="1"==i.continues?"1":"0",i.stat_unresult="1"==i.stat_unresult?"1":"0",null!==i.stat_param&&i.stat_param.length>0&&(i.stat_param=i.stat_param.join(","));var l={},o="提交成功";"add"===e.dialogType?(l.add=[i],o="新建成功"):(l.mod=[i],o="编辑成功");var r={};r.postData=l,r.txnId=e.txnIdParent,M.post({url:"/stat/save",param:r,success:function(t){a.getData(),a.$message(o),a.dialogVisible=!1}})}})},getStatDataFnSelectData:function(){},fnParamPopup:function(){if(!this.viewDisabled){var t=this.dialogForm.stat_fn,e=this.dialogForm.stat_datafd;if("rang_bin_dist"===t){var a=this.dialogForm.fn_param,i="",l=this.queryTxnFeature(e);l&&(i=l.type),this.$refs.FuncParamPickerDialog.open(a,i)}}},statCondInPopup:function(){this.viewDisabled||(this.$refs.StatCondDialog.open(),this.$refs.StatCondDialog.setValue({stat_cond_value:this.dialogForm.stat_cond,stat_cond_in:this.dialogForm.stat_cond_in}),this.statCondInDialogVisible=!0)},closeStatCondInDialog:function(){this.statCondInDialogVisible=!1},statParamDataChange:function(t){this.queryShowForm.stat_param=t},addStatParamDataChange:function(t){this.dialogForm.stat_param=t,this.$refs.dialogForm.validateField("stat_param",function(t){})},statCondInValueCallBack:function(t){this.dialogForm.stat_cond=t.stat_cond_value,this.dialogForm.stat_cond_in=t.stat_cond_in},funcParamValueCallBack:function(t){this.dialogForm.fn_param=t},queryTxnFeature:function(t){var e=!0,a=!1,i=void 0;try{for(var l,o=T()(this.statDataFdList);!(e=(l=o.next()).done);e=!0){var r=l.value;if(r.code_key===t)return r}}catch(t){a=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(a)throw i}}return null},changeFeatureTypeToDataType:function(t){var e=t,a=!0,i=!1,l=void 0;try{for(var o,r=T()(Wt);!(a=(o=r.next()).done);a=!0){var n=o.value;if(n.type.includes(t)){e=n.recap;break}}}catch(t){i=!0,l=t}finally{try{!a&&r.return&&r.return()}finally{if(i)throw l}}return e},getStorageFdByfdName:function(t,e){var a=null;if(t&&e){var i=!0,l=!1,o=void 0;try{for(var r,n=T()(t);!(i=(r=n.next()).done);i=!0){var s=r.value;if(s.fd_name===e){a=s;break}}}catch(t){l=!0,o=t}finally{try{!i&&n.return&&n.return()}finally{if(l)throw o}}}return a},getCanUseStorageFdByDataType:function(t,e){var a=[],i=this.enableStoreFd;if(!e){var l=this.selectedRows;if(l&&l.length>0){var o=l[0];if(o&&o.storecolumn){var r=this.allStoreFd,n=this.getStorageFdByfdName(r,o.storecolumn);n&&i.splice(0,0,n)}}}return a=a.concat(this.getEnableStorageFdByDataType(t,i))},getEnableStorageFdByDataType:function(t,e){var a=[];if(t&&e){var i=!0,l=!1,o=void 0;try{for(var r,n=T()(e);!(i=(r=n.next()).done);i=!0){var s=r.value,c=!0,u=!1,d=void 0;try{for(var m,f=T()(Wt);!(c=(m=f.next()).done);c=!0){var p=m.value;p.type.includes(t)&&("long"===p.recap||"double"===p.recap?("double"!==t&&s.type===t&&a.push({code_value:s.fd_name,code_key:s.fd_name}),"double"===s.type&&a.push({code_value:s.fd_name,code_key:s.fd_name})):"string"===p.recap&&"string"!==t&&s.type===t&&a.push({code_value:s.fd_name,code_key:s.fd_name}),"string"===s.type&&a.push({code_value:s.fd_name,code_key:s.fd_name}))}}catch(t){u=!0,d=t}finally{try{!c&&f.return&&f.return()}finally{if(u)throw d}}}}catch(t){l=!0,o=t}finally{try{!i&&n.return&&n.return()}finally{if(l)throw o}}}return a},changeDialogForm:function(t){switch(t){case"calculat_expressions":this.dialogForm.stat_param="",this.dialogForm.stat_datafd="",this.dialogForm.coununit="",this.dialogForm.countround="",this.dialogForm.fn_param="",this.dialogForm.result_cond="",this.dialogForm.continues="",this.dialogForm.stat_unresult="",this.formStatParamShow=!1,this.formStatDatafdShow=!1,this.formCoununitShow=!1,this.formCountroundShow=!1,this.formFnParamShow=!1,this.formResultCondShow=!1,this.formContinuesShow=!1,this.formStatUnresultShow=!1;break;default:this.formStatParamShow=!0,this.formStatDatafdShow=!0,this.formCoununitShow=!0,this.formCountroundShow=!0,this.formFnParamShow=!0,this.formResultCondShow=!0,this.formContinuesShow=!0,this.formStatUnresultShow=!0}},fnChangeEventCommon:function(){var t=this.dialogForm;if("calculat_expressions"===t.stat_fn)this.changeDialogForm("calculat_expressions"),this.formDatatypeShow=!0;else if(this.changeDialogForm(),"rang_bin_dist"===t.stat_fn){var e=t.stat_datafd,a="";if(void 0!=e&&""!==e){var i=Ot.queryTxnFeature(e);i&&(a=i.type),"datetime"===a||"time"===a||"double"===a||"money"===a||"long"===a?this.formFnParamShow=!0:(this.dialogForm.fn_param="",this.formFnParamShow=!1)}else this.dialogForm.fn_param="",this.formFnParamShow=!1}else"count"===t.stat_fn||"status"===t.stat_fn?(this.dialogForm.stat_datafd="",this.formStatDatafdShow=!1):this.formStatDatafdShow=!0,this.dialogForm.fn_param="",this.formFnParamShow=!1},fnChangeEvent:function(){var t=this.dialogForm;t.storecolumn="",this.fnChangeEventCommon();var e="";if("snapshot"===t.stat_fn){var a=t.stat_datafd,i=this.queryTxnFeature(a);i&&(e=this.changeFeatureTypeToDataType(i.type))}else{var l=!0,o=!1,r=void 0;try{for(var n,s=T()(this.statFnList);!(l=(n=s.next()).done);l=!0){var c=n.value;c.code_key===t.stat_fn&&(e=c.func_type)}}catch(t){o=!0,r=t}finally{try{!l&&s.return&&s.return()}finally{if(o)throw r}}}"object"===e&&"calculat_expressions"===t.stat_fn?(t.datatype="",t.storecolumn="",t.datatype="",t.storecolumn="",this.formDatatypeShow=!0,e=""):(t.datatype=e,this.formDatatypeShow=!1,this.storecolumnCodeList=this.getCanUseStorageFdByDataType(e,!0))},countroundChangeEvent:function(){var t=this.dialogForm;"7"===t.coununit||"9"===t.coununit||"calculat_expressions"===t.stat_fn?(this.dialogForm.countround="",this.formCountroundShow=!1):this.formCountroundShow=!0},datafdChangeEvent:function(){var t=this.dialogForm;t.storecolumn="";var e=t.stat_fn,a=t.stat_datafd,i="",l=this.queryTxnFeature(a);if(l&&(i=l.type),"snapshot"===e){var o=this.changeFeatureTypeToDataType(i);t.datatype=o,this.storecolumnCodeList=this.getCanUseStorageFdByDataType(o,!0)}"rang_bin_dist"===e?"datetime"===i||"time"===i||"double"===i||"money"===i||"long"===i?(t.fn_param="",this.formFnParamShow=!0):(""!==a&&(this.$message("非时间类型、日期时间类型和非数值类型的统计目标，不能使用区间分布函数"),t.stat_datafd=""),t.stat_datafd="",t.fn_param="",this.formFnParamShow=!1):(t.fn_param="",this.formFnParamShow=!1)},checkStatCond:function(t,e,a){var i=this.dialogForm.stat_cond,l=this.formStatCondInName.replace(":","");return"calculat_expressions"===this.dialogForm.stat_fn&&""===i?a(new Error(l+"不能为空")):""!==i&&i.length>512?a(new Error(l+"不能超过512个字符")):void a()},checkStatDataFd:function(t,e,a){var i=this.dialogForm.stat_fn;if(!("calculat_expressions"===this.dialogForm.stat_fn)&&"count"!==i&&"status"!==i&&""===this.dialogForm.stat_datafd)return a(new Error("统计目标不能为空"));a()},checkStatParam:function(t,e,a){var i=this.dialogForm.stat_param,l=this.dialogForm.coununit;if(!("calculat_expressions"===this.dialogForm.stat_fn||0!==i.length&&""!==i))return a(new Error("统计引用对象不能为空"));if(i.length>6)return a(new Error("统计引用对象最多选择6个"));if("9"===l){var o=!1,r=!0,n=!1,s=void 0;try{for(var c,u=T()(i);!(r=(c=u.next()).done);r=!0){if("SESSIONID"===c.value.toUpperCase()){o=!0;break}}}catch(t){n=!0,s=t}finally{try{!r&&u.return&&u.return()}finally{if(n)throw s}}if(!o)return a(new Error('单位为会话，必须包含"会话标识"'))}a()},checkFnParam:function(t,e,a){var i=this.dialogForm.stat_fn,l=this.dialogForm.fn_param;if("rang_bin_dist"===i){if(void 0===l||""===l)return a(new Error("函数参数不能为空"));if(l.length>512)return a(new Error("函数参数不能超过512个字符"))}a()},checkCoununit:function(t,e,a){var i=this.dialogForm.coununit;if(!("calculat_expressions"===this.dialogForm.stat_fn)&&""===i)return a(new Error("单位不能为空"));a()},checkCountround:function(t,e,a){var i=this.dialogForm.coununit,l=this.dialogForm.countround;if(!("calculat_expressions"===this.dialogForm.stat_fn)&&("7"!==i||"9"!==i)){if(""===B.trim(l))return a(new Error("周期不能为空"));if(!B.isNumber(l,"+","0")||parseInt(l)<1||parseInt(l)>100)return a(new Error("周期只能输入1-100的正整数"))}a()},checkResultCond:function(t,e,a){var i=this.dialogForm.result_cond;if(!("calculat_expressions"===this.dialogForm.stat_fn)&&""===B.trim(i))return a(new Error("交易结果不能为空"));a()},checkDatatype:function(t,e,a){var i=this.dialogForm.datatype;if("calculat_expressions"===this.dialogForm.stat_fn&&""===B.trim(i))return a(new Error("数据类型不能为空"));a()},checkStatValid:function(t,e,a){var i=this.dialogForm.stat_valid;if(!("calculat_expressions"===this.dialogForm.stat_fn)&&""===B.trim(i))return a(new Error("有效性不能为空"));a()}},components:{AllPickSelect:St,StatCondPicker:a("/Xao")(Et,qt,!1,function(t){a("GGDo")},null,null).exports,FuncParamPicker:a("/Xao")(At,Bt,!1,function(t){a("OqD3")},null,null).exports}},Mt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("transition",{attrs:{name:"fade"}},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.queryFormShow,expression:"queryFormShow"}],ref:"queryShowForm",staticStyle:{"text-align":"left"},attrs:{"label-position":"right","label-width":"120px",model:t.queryShowForm,inline:!0}},[a("el-form-item",{attrs:{label:"统计名称:",prop:"stat_name"}},[a("el-input",{staticClass:"query-form-item",attrs:{"auto-complete":"off",maxlength:50},model:{value:t.queryShowForm.stat_name,callback:function(e){t.$set(t.queryShowForm,"stat_name",e)},expression:"queryShowForm.stat_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"统计描述:",prop:"stat_desc"}},[a("el-input",{staticClass:"query-form-item",attrs:{"auto-complete":"off",maxlength:50},model:{value:t.queryShowForm.stat_desc,callback:function(e){t.$set(t.queryShowForm,"stat_desc",e)},expression:"queryShowForm.stat_desc"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"统计引用对象:",prop:"stat_param"}},[a("AllPickSelect",{attrs:{dataList:t.statParamList},on:{dataChange:t.statParamDataChange}})],1),t._v(" "),a("el-form-item",{attrs:{label:"统计目标:",prop:"stat_datafd"}},[a("el-select",{staticClass:"query-form-item",attrs:{placeholder:"请选择",clearable:""},model:{value:t.queryShowForm.stat_datafd,callback:function(e){t.$set(t.queryShowForm,"stat_datafd",e)},expression:"queryShowForm.stat_datafd"}},t._l(t.statDataFdList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"统计函数:",prop:"stat_fn"}},[a("el-select",{staticClass:"query-form-item",attrs:{placeholder:"请选择",clearable:""},model:{value:t.queryShowForm.stat_fn,callback:function(e){t.$set(t.queryShowForm,"stat_fn",e)},expression:"queryShowForm.stat_fn"}},t._l(t.statFnList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"有效性:",prop:"stat_valid"}},[a("el-select",{staticClass:"query-form-item",attrs:{placeholder:"请选择",clearable:""},model:{value:t.queryShowForm.stat_valid,callback:function(e){t.$set(t.queryShowForm,"stat_valid",e)},expression:"queryShowForm.stat_valid"}},t._l(t.statValidList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1)],1),t._v(" "),a("div",{staticStyle:{"margin-bottom":"10px","text-align":"left"}},[a("el-button",{staticClass:"el-icon-view",attrs:{type:"primary"},on:{click:function(e){t.queryFormShow=!t.queryFormShow}}},[t._v("查询")]),t._v(" "),a("el-button",{staticClass:"el-icon-plus",attrs:{plain:"",disabled:t.isExpand},on:{click:function(e){t.openDialog("add")}}},[t._v("新建")])],1),t._v(" "),a("div",{staticClass:"stat-expand-table-box"},[a("el-table",{ref:"dataTable",staticStyle:{width:"100%"},attrs:{data:t.tableDataShow,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{fixed:"left",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.openDialog("edit",e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.delData(e.row)}}},[t._v("删除")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"}},[t._v("引用点")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"stat_name",label:"统计名称",align:"left",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"stat_name",label:"统计名称",align:"left",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"stat_desc",label:"统计描述",align:"left",width:"250"}}),t._v(" "),a("el-table-column",{attrs:{label:"统计引用对象",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("statParamFilter")(e.row.stat_param)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"stat_datafd",label:"统计目标",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("statDataFdFilter")(e.row.stat_datafd)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"统计函数",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("statFnFilter")(e.row.stat_fn)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"storecolumn",label:"存储字段",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{label:"有效性",align:"left",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0},on:{change:function(a){t.statValidChange(e.row)}},model:{value:e.row.stat_valid,callback:function(a){t.$set(e.row,"stat_valid",a)},expression:"scope.row.stat_valid"}})]}}])})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogVisible,width:"900px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"dialogForm",staticStyle:{"text-align":"left"},attrs:{model:t.dialogForm,inline:!0,rules:t.dialogFormRules}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formStatDescShow,expression:"formStatDescShow"}],style:t.formItemStyle,attrs:{label:"统计描述:","label-width":t.formLabelWidth,prop:"stat_desc"}},[a("el-input",{style:t.formItemContentStyle,attrs:{"auto-complete":"off",maxlength:200,disabled:t.viewDisabled},model:{value:t.dialogForm.stat_desc,callback:function(e){t.$set(t.dialogForm,"stat_desc",e)},expression:"dialogForm.stat_desc"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formStatParamShow,expression:"formStatParamShow"}],staticClass:"is-required",style:t.formItemStyle,attrs:{label:"统计引用对象:","label-width":t.formLabelWidth,prop:"stat_param"}},[a("AllPickSelect",{style:t.formItemContentStyle,attrs:{collapseTags:t.allPickCollapse,selectedList:t.statParamInitList,dataList:t.statParamList,disabled:t.modDisabled||t.viewDisabled},on:{dataChange:t.addStatParamDataChange}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formStatFnShow,expression:"formStatFnShow"}],style:t.formItemStyle,attrs:{label:"统计函数:","label-width":t.formLabelWidth,prop:"stat_fn"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",disabled:t.modDisabled||t.viewDisabled,clearable:""},model:{value:t.dialogForm.stat_fn,callback:function(e){t.$set(t.dialogForm,"stat_fn",e)},expression:"dialogForm.stat_fn"}},t._l(t.statFnList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})}))],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formStatCondInShow,expression:"formStatCondInShow"}],class:{"is-required":t.StatCondInRequired},style:t.formItemStyle,attrs:{label:t.formStatCondInName,"label-width":t.formLabelWidth,prop:"stat_cond"}},[a("div",{attrs:{disabled:t.viewDisabled},on:{dblclick:t.statCondInPopup}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],style:t.formItemContentStyle,attrs:{"auto-complete":"off",readonly:"",disabled:t.viewDisabled},model:{value:t.dialogForm.stat_cond,callback:function(e){t.$set(t.dialogForm,"stat_cond",e)},expression:"dialogForm.stat_cond"}}),t._v(" "),a("el-input",{style:t.formItemContentStyle,attrs:{"auto-complete":"off",readonly:"",disabled:t.viewDisabled},model:{value:t.dialogForm.stat_cond_in,callback:function(e){t.$set(t.dialogForm,"stat_cond_in",e)},expression:"dialogForm.stat_cond_in"}})],1)]),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formStatDatafdShow,expression:"formStatDatafdShow"}],staticClass:"is-required",style:t.formItemStyle,attrs:{label:"统计目标:","label-width":t.formLabelWidth,prop:"stat_datafd"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",disabled:t.modDisabled||t.viewDisabled,clearable:""},model:{value:t.dialogForm.stat_datafd,callback:function(e){t.$set(t.dialogForm,"stat_datafd",e)},expression:"dialogForm.stat_datafd"}},t._l(t.statDataFdList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})}))],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formFnParamShow,expression:"formFnParamShow"}],staticClass:"is-required",style:t.formItemStyle,attrs:{label:"函数参数:","label-width":t.formLabelWidth,prop:"fn_param"}},[a("div",{on:{dblclick:t.fnParamPopup}},[a("el-input",{style:t.formItemContentStyle,attrs:{"auto-complete":"off",readonly:"",disabled:t.viewDisabled},model:{value:t.dialogForm.fn_param,callback:function(e){t.$set(t.dialogForm,"fn_param",e)},expression:"dialogForm.fn_param"}})],1)]),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formCoununitShow,expression:"formCoununitShow"}],staticClass:"is-required",style:t.formItemStyle,attrs:{label:"单位:","label-width":t.formLabelWidth,prop:"coununit"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",disabled:t.modDisabled||t.viewDisabled,clearable:""},model:{value:t.dialogForm.coununit,callback:function(e){t.$set(t.dialogForm,"coununit",e)},expression:"dialogForm.coununit"}},t._l(t.coununitList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formCountroundShow,expression:"formCountroundShow"}],staticClass:"is-required",style:t.formItemStyle,attrs:{label:"周期:","label-width":t.formLabelWidth,prop:"countround"}},[a("el-input",{style:t.formItemContentStyle,attrs:{"auto-complete":"off",disabled:t.viewDisabled},model:{value:t.dialogForm.countround,callback:function(e){t.$set(t.dialogForm,"countround",e)},expression:"dialogForm.countround"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formResultCondShow,expression:"formResultCondShow"}],staticClass:"is-required",style:t.formItemStyle,attrs:{label:"交易结果:","label-width":t.formLabelWidth,prop:"result_cond"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",disabled:t.viewDisabled,clearable:""},model:{value:t.dialogForm.result_cond,callback:function(e){t.$set(t.dialogForm,"result_cond",e)},expression:"dialogForm.result_cond"}},t._l(t.resultCondList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formDatatypeShow,expression:"formDatatypeShow"}],staticClass:"is-required",style:t.formItemStyle,attrs:{label:"数据类型:","label-width":t.formLabelWidth,prop:"datatype"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",disabled:t.viewDisabled,clearable:""},model:{value:t.dialogForm.datatype,callback:function(e){t.$set(t.dialogForm,"datatype",e)},expression:"dialogForm.datatype"}},t._l(t.datatypeCodeList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formStoreColumnShow,expression:"formStoreColumnShow"}],style:t.formItemStyle,attrs:{label:"存储字段:","label-width":t.formLabelWidth,prop:"storecolumn"}},[a("el-select",{style:t.formItemContentStyle,attrs:{placeholder:"请选择",disabled:t.viewDisabled,clearable:""},model:{value:t.dialogForm.storecolumn,callback:function(e){t.$set(t.dialogForm,"storecolumn",e)},expression:"dialogForm.storecolumn"}},t._l(t.storecolumnCodeList,function(t){return a("el-option",{key:t.code_key,attrs:{label:t.code_value,value:t.code_key}})}))],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formContinuesShow,expression:"formContinuesShow"}],style:t.formItemStyle,attrs:{label:"连续:","label-width":t.formLabelWidth,prop:"continues"}},[a("el-switch",{attrs:{disabled:t.viewDisabled,"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:t.dialogForm.continues,callback:function(e){t.$set(t.dialogForm,"continues",e)},expression:"dialogForm.continues"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formStatUnresultShow,expression:"formStatUnresultShow"}],style:t.formItemStyle,attrs:{label:"事中:","label-width":t.formLabelWidth,prop:"stat_unresult"}},[a("el-switch",{attrs:{disabled:t.viewDisabled,"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:t.dialogForm.stat_unresult,callback:function(e){t.$set(t.dialogForm,"stat_unresult",e)},expression:"dialogForm.stat_unresult"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.formStatValidShow,expression:"formStatValidShow"}],style:t.formItemStyle,attrs:{label:"有效性:","label-width":t.formLabelWidth,prop:"stat_valid"}},[a("el-switch",{attrs:{disabled:t.viewDisabled,"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:t.dialogForm.stat_valid,callback:function(e){t.$set(t.dialogForm,"stat_valid",e)},expression:"dialogForm.stat_valid"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.viewDisabled,expression:"!viewDisabled"}],on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.viewDisabled,expression:"!viewDisabled"}],attrs:{type:"primary"},on:{click:function(e){t.submitForm("dialogForm")}}},[t._v("保 存")])],1)],1),t._v(" "),a("StatCondPicker",{ref:"StatCondDialog",attrs:{statCond:t.dialogForm.stat_cond,statCondIn:t.dialogForm.stat_cond_in,txnId:t.txnId,hideItems:["rule_func","ac_func"]},on:{closeDialog:t.closeStatCondInDialog,valueCallback:t.statCondInValueCallBack}}),t._v(" "),a("FuncParamPicker",{ref:"FuncParamPickerDialog",on:{valueCallback:t.funcParamValueCallBack}})],1)},staticRenderFns:[]},Ut={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h1",[this._v("交易规则")])])}]},Xt={created:function(){this.selTree()},data:function(){return{toolBtn:{addBtn:!0,delBtn:!0},txnId:"T",tabVisibility:{trandefVisibility:!0,tranmdlVisibility:!1,statVisibility:!1,ruleVisibility:!1},treeList:[],treeData:[],expendKey:["T"],defaultProps:{children:"children",label:"text"},breadcrumbData:[],activeName:"trandef"}},methods:{renderContent:function(t,e){var a=e.node;e.data,e.store;return 0===a.data.enable?t("span",{class:"el-tree-node__label disabledFlag"},[a.label]):t("span",{class:"el-tree-node__label"},[a.label])},selTree:function(){var t=this,e={url:"/trandef/query",success:function(e){e.list&&(t.treeList=e.list,t.treeData=t.formatTreeData(e.list))}};M.post(e)},formatTreeData:function(t,e){function a(t,e){var i=[];for(var l in t){var o=t[l];o.fid===e&&(o.children=a(t,o.id),i.push(o))}return i}var i=[];if(void 0===e||0===e.length){e=[];for(var l in t)void 0!==t[l].fid&&null!==t[l].fid&&""!==t[l].fid||e.push(t[l])}0===e.length&&(console.error("根节点不存在，请确认树结构是否正确"),console.info("树结构的根节点是fid不存在（或为空）的节点，否则需手动添加指定得根节点（参数）"));for(var o in e){var r=e[o];r.children=a(t,r.id),i.push(r)}return i},expendNodesByLevel:function(t){for(var e=[],a=this.treeData[0],i=1;i<=t;)e.push(a.id),a=a.children[0],i++;this.expendKey=e},handleNodeClick:function(t,e){this.txnId!==t.id&&(this.showToolBtn(),this.txnId=t.id,this.activeName="trandef",this.tabVisibility={trandefVisibility:!0,tranmdlVisibility:!1,statVisibility:!1,ruleVisibility:!1},this.syncBreadcrumb(e))},showToolBtn:function(t){if(t||(t=this.$refs.tab.value),"trandef"===t){var e=this.$refs.tree.getCurrentNode();e&&(this.toolBtn.addBtn=!(void 0===e.txnid||null===e.txnid||""===e.txnid.trim()),this.toolBtn.delBtn="T"===e.id)}else this.toolBtn.addBtn=!0,this.toolBtn.delBtn=!0},syncBreadcrumb:function(t){for(var e=[];null!==t.parent;)e.unshift({text:t.data.text}),t=t.parent;e[0].text="交易模型："+e[0].text,this.breadcrumbData=e},handleClick:function(t,e){switch(this.tabVisibility.trandefVisibility=!1,this.tabVisibility.tranmdlVisibility=!1,this.tabVisibility.statVisibility=!1,this.tabVisibility.ruleVisibility=!1,t.name){case"trandef":this.tabVisibility.trandefVisibility=!0;break;case"tranmdl":this.tabVisibility.tranmdlVisibility=!0;break;case"stat":this.tabVisibility.statVisibility=!0;break;case"rule":this.tabVisibility.ruleVisibility=!0}this.showToolBtn(t.name)},addFunc:function(){this.$refs.trandef.addFormVisible=!0},delFunc:function(){var t=this.$refs.tree.getCurrentNode(),e={tab_name:t.id,op:"del",tab_desc:t.tab_desc};this.$refs.trandef.delInfo(e)}},components:{Trandef:Pt,Tranmdl:zt,Stat:a("/Xao")(jt,Mt,!1,function(t){a("fVoO")},null,null).exports,Rule:a("/Xao")({},Ut,!1,function(t){a("tjRK")},null,null).exports}},Gt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{staticStyle:{height:"100%",border:"1px solid #eee"}},[a("el-header",{staticStyle:{"background-color":"white"},attrs:{height:"38px"}},[a("el-breadcrumb",{staticStyle:{padding:"13px 0px"},attrs:{"separator-class":"el-icon-arrow-right"}},t._l(t.breadcrumbData,function(e){return a("el-breadcrumb-item",{key:e.text},[t._v(t._s(e.text))])}))],1),t._v(" "),a("el-container",{staticClass:"wrapper",staticStyle:{height:"100%","border-top":"1px solid #eee"}},[a("el-aside",{staticStyle:{"min-height":"400px",border:"0","border-right":"1px solid #eee"},attrs:{width:"200px"}},[a("div",{staticStyle:{height:"38px","margin-top":"5px","text-align":"left","border-bottom":"1px solid #eee"}},[a("el-button",{staticClass:"el-icon-plus",staticStyle:{"margin-left":"5px"},attrs:{plain:"",disabled:t.toolBtn.addBtn},on:{click:t.addFunc}},[t._v("新建\n        ")]),t._v(" "),a("el-button",{staticClass:"el-icon-delete",staticStyle:{"margin-left":"0px"},attrs:{plain:"",disabled:t.toolBtn.delBtn},on:{click:t.delFunc}},[t._v("删除\n        ")])],1),t._v(" "),a("el-tree",{ref:"tree",staticStyle:{"overflow-y":"auto"},attrs:{data:t.treeData,"node-key":"id",props:t.defaultProps,"highlight-current":!0,"default-expanded-keys":t.expendKey,"expand-on-click-node":!1,"render-content":t.renderContent},on:{"node-click":t.handleNodeClick}})],1),t._v(" "),a("el-main",{staticStyle:{padding:"5px"}},[a("el-tabs",{ref:"tab",on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{staticStyle:{"padding-left":"10px"},attrs:{label:"交易定义",name:"trandef"}},[a("trandef",{ref:"trandef",attrs:{txnId:t.txnId,isVisibility:t.tabVisibility.trandefVisibility}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"交易模型定义",name:"tranmdl"}},[a("tranmdl",{attrs:{txnId:t.txnId,isVisibility:t.tabVisibility.tranmdlVisibility}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"交易统计",name:"stat"}},[a("stat",{attrs:{txnId:t.txnId,isVisibility:t.tabVisibility.statVisibility}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"交易规则",name:"rule"}},[a("rule")],1)],1)],1)],1)],1)},staticRenderFns:[]},Kt=a("/Xao")(Xt,Gt,!1,function(t){a("RjNk")},null,null).exports,Ht={computed:{notSelectOne:function(){return 1!==this.selectedRows.length}},mounted:function(){this.$nextTick(function(){this.getData()})},data:function(){return{tableData:[]}},methods:{getData:function(){var t=this;M.post({url:"/auth/modelList",param:{},success:function(e){e.page&&(t.tableData=e.page.list)}})},showData:function(t){this.$router.push({name:"AuthDataList",query:{modelname:t}})}}},Qt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:""}},[a("el-table-column",{attrs:{label:"模块名称",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(a){t.showData(e.row.modelname)}}},[t._v(t._s(e.row.modelname))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"count",label:"待授权信息数",align:"left"}})],1)],1)},staticRenderFns:[]},Jt=a("/Xao")(Ht,Qt,!1,function(t){a("W6kQ")},null,null).exports,Zt={computed:{notSelectOne:function(){return 1!==this.selectedRows.length},txnnameRowShow:function(){return"名单管理"!==this.modelName},subOperateNumShow:function(){return"名单管理"===this.modelName||"交易配置"===this.modelName},datavalueLink:function(){return!("名单管理"===this.modelName||"交易配置"===this.modelName)}},data:function(){return{modelName:"",tableData:[],dialogTitle:"授权意见",dictDialogVisible:!1,dialogForm:this.initDialogForm(),rules:{auth_status:[{required:!0,message:"请选择是否通过授权",trigger:"blur"}],auth_msg:[{required:!0,message:"请输入授权说明",trigger:"blur"},{max:2048,message:"长度在2048个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}]},formLabelWidth:"130px",dialogType:"",currentPage:1,pageSize:10,total:0,selectedRows:[]}},mounted:function(){this.$nextTick(function(){this.modelName=this.$route.query.modelname,this.getData()})},filters:{renderDateTime:function(t){return B.renderDateTime(t)}},methods:{initDialogForm:function(){return{auth_status:"1",auth_msg:""}},handleSizeChange:function(t){this.currentPage=1,this.pageSize=t,this.getData()},handleCurrentChange:function(t){this.currentPage=t,this.getData()},handleSelectionChange:function(t){this.selectedRows=t},bindGridData:function(t){this.tableData=t.page.list,this.currentPage=t.page.index,this.pageSize=t.page.size,this.total=t.page.total},toCompare:function(t){var e={operate_name:t.orig_operatename,table_name:t.query_table_name,table_pk:t.query_table_pk,table_pkvalue:t.query_pkvalue,auth_id:t.auth_id,modelName:this.modelName,flag:1};this.$router.push({name:"AuthDataCompare",query:e}),console.log(t)},addData:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;var a=e,i=void 0,l=void 0,o=void 0,r="",n="",s=e.selectedRows[0];i=s.auth_id,l=s.funcname,o=s.operatedata_value;var c=s.txnname;void 0!==c&&""!==c&&(r=c);var u=s.operatename;void 0!==u&&""!==u&&(n=u);var d={AUTH_IDS:i,FUNCNAME:l,TXNNAME:r,OPERATENAME:n,OPERATEDATA_VALUE:o,AUTH_STATUS:e.dialogForm.auth_status,AUTH_MSG:e.dialogForm.auth_msg};M.post({url:"/auth/modAuth",param:d,success:function(t){a.getData(),a.$message("授权成功"),a.dictDialogVisible=!1}})})},getData:function(){var t=this,e={modelName:this.modelName,pageindex:this.currentPage,pagesize:this.pageSize};M.post({url:"/auth/authList",param:e,success:function(e){e.page&&t.bindGridData(e)}})},showSub:function(){if(1===this.selectedRows.length){var t={authId:this.selectedRows[0].auth_id,modelName:this.modelName};this.$router.push({name:"AuthSubDataList",query:t})}else this.$message("请选择一行授权信息。")},showLog:function(){if(1===this.selectedRows.length){var t={authId:this.selectedRows[0].auth_id,modelName:this.modelName};this.$router.push({name:"AuthLogList",query:t})}else this.$message("请选择一行授权信息。")},auth:function(){this.dialogForm=this.initDialogForm(),this.dictDialogVisible=!0},submitForm:function(t){this.addData(t)},back:function(){this.$router.go(-1)}}},Yt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{"margin-bottom":"10px","text-align":"left"}},[a("el-button",{staticClass:"el-icon-back",attrs:{type:"primary"},on:{click:function(e){t.back()}}},[t._v("返回")]),t._v(" "),a("el-button",{staticClass:"el-icon-tickets",attrs:{plain:"",disabled:t.notSelectOne},on:{click:t.auth}},[t._v("授权")]),t._v(" "),a("el-button",{staticClass:"el-icon-view",attrs:{plain:"",disabled:t.notSelectOne},on:{click:t.showSub}},[t._v("查看子操作")]),t._v(" "),a("el-button",{staticClass:"el-icon-view",attrs:{plain:"",disabled:t.notSelectOne},on:{click:function(e){t.showLog()}}},[t._v("查看日志")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作数据",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.datavalueLink?a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(a){t.toCompare(e.row)}}},[t._v(t._s(e.row.datavalue))]):a("span",[t._v(t._s(e.row.datavalue))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"auth_id",label:"授权编号",align:"left"}}),t._v(" "),t.txnnameRowShow?a("el-table-column",{attrs:{prop:"txnname",label:"所属交易",align:"left"}}):t._e(),t._v(" "),a("el-table-column",{attrs:{prop:"operatename",label:"操作名称",align:"left"}}),t._v(" "),t.subOperateNumShow?a("el-table-column",{attrs:{prop:"sub_operate_num",label:"子操作个数",align:"left"}}):t._e(),t._v(" "),a("el-table-column",{attrs:{prop:"real_name",label:"提交授权人",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{label:"提交授权时间",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("renderDateTime")(e.row.proposer_time)))])]}}])})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{"current-page":t.currentPage,"page-sizes":[10,25,50,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dictDialogVisible},on:{"update:visible":function(e){t.dictDialogVisible=e}}},[a("el-form",{ref:"dialogForm",staticStyle:{"text-align":"left"},attrs:{model:t.dialogForm,rules:t.rules}},[a("el-form-item",{attrs:{label:"是否通过授权:","label-width":t.formLabelWidth,prop:"auth_status"}},[a("el-radio",{attrs:{label:"1"},model:{value:t.dialogForm.auth_status,callback:function(e){t.$set(t.dialogForm,"auth_status",e)},expression:"dialogForm.auth_status"}},[t._v("是")]),t._v(" "),a("el-radio",{attrs:{label:"2"},model:{value:t.dialogForm.auth_status,callback:function(e){t.$set(t.dialogForm,"auth_status",e)},expression:"dialogForm.auth_status"}},[t._v("否")])],1),t._v(" "),a("el-form-item",{attrs:{label:"授权说明:","label-width":t.formLabelWidth,prop:"auth_msg"}},[a("el-input",{attrs:{type:"textarea",maxlength:2048},model:{value:t.dialogForm.auth_msg,callback:function(e){t.$set(t.dialogForm,"auth_msg",e)},expression:"dialogForm.auth_msg"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dictDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("dialogForm")}}},[t._v("保 存")])],1)],1)],1)},staticRenderFns:[]},te=a("/Xao")(Zt,Yt,!1,function(t){a("4gtQ")},null,null).exports,ee={computed:{notSelectOne:function(){return 1!==this.selectedRows.length},txnnameRowShow:function(){return"名单管理"!==this.modelName},subOperateNumShow:function(){return"名单管理"===this.modelName||"交易配置"===this.modelName},datavalueLink:function(){return!("名单管理"===this.modelName||"交易配置"===this.modelName)}},data:function(){return{authId:"",modelName:"",tableData:[],dialogTitle:"",dictDialogVisible:!1,formLabelWidth:"130px",dialogType:"",currentPage:1,pageSize:10,total:0,selectedRows:[]}},mounted:function(){this.$nextTick(function(){this.modelName=this.$route.query.modelName,this.authId=this.$route.query.authId,this.getData()})},filters:{renderDateTime:function(t){return B.renderDateTime(t)}},methods:{handleSizeChange:function(t){this.currentPage=1,this.pageSize=t,this.getData()},handleCurrentChange:function(t){this.currentPage=t,this.getData()},handleSelectionChange:function(t){this.selectedRows=t},bindGridData:function(t){this.tableData=t.page.list,this.currentPage=t.page.index,this.pageSize=t.page.size,this.total=t.page.total},getData:function(){var t=this,e={authId:this.authId,pageindex:this.currentPage,pagesize:this.pageSize};M.post({url:"/auth/toLog",param:e,success:function(e){e.page&&t.bindGridData(e)}})},back:function(){this.$router.go(-1)}}},ae={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{"margin-bottom":"10px","text-align":"left"}},[a("el-button",{staticClass:"el-icon-back",attrs:{type:"primary"},on:{click:function(e){t.back()}}},[t._v("返回")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"real_name",label:"操作员",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"login_name",label:"用户名",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作时间",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("renderDateTime")(e.row.operate_time)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"func_name",label:"所属功能",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"operate_result",label:"操作结果",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"operate_data",label:"操作数据",align:"left"}})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{"current-page":t.currentPage,"page-sizes":[10,25,50,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)},staticRenderFns:[]},ie=a("/Xao")(ee,ae,!1,function(t){a("G2V6")},null,null).exports,le={computed:{notSelectOne:function(){return 1!==this.selectedRows.length}},data:function(){return{modelName:"",authId:"",tableData:[],dialogTitle:"",dictDialogVisible:!1,formLabelWidth:"130px",dialogType:"",currentPage:1,pageSize:10,total:0,selectedRows:[]}},mounted:function(){this.$nextTick(function(){this.modelName=this.$route.query.modelName,this.authId=this.$route.query.authId,this.getData()})},filters:{renderDateTime:function(t){return B.renderDateTime(t)}},methods:{handleSizeChange:function(t){this.currentPage=1,this.pageSize=t,this.getData()},handleCurrentChange:function(t){this.currentPage=t,this.getData()},handleSelectionChange:function(t){this.selectedRows=t},bindGridData:function(t){console.log(t.page.list),this.tableData=t.page.list,this.currentPage=t.page.index,this.pageSize=t.page.size,this.total=t.page.total},datavalueLink:function(t){return"TMS_COM_MTRAIN"!==t.table_name},toCompare:function(t){var e={operate_name:t.orig_operatename,table_name:t.query_table_name,table_pk:t.query_table_pk,table_pkvalue:t.query_pkvalue,auth_id:t.auth_id,modelName:this.modelName,flag:1};this.$router.push({name:"AuthDataCompare",query:e}),console.log(t)},getData:function(){var t=this,e={authId:this.authId,pageindex:this.currentPage,pagesize:this.pageSize};M.post({url:"/auth/listSubOperate",param:e,success:function(e){e.page&&t.bindGridData(e)}})},back:function(){this.$router.go(-1)}}},oe={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{"margin-bottom":"10px","text-align":"left"}},[a("el-button",{staticClass:"el-icon-back",attrs:{type:"primary"},on:{click:function(e){t.back()}}},[t._v("返回")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作数据",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.datavalueLink(e.row)?a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(a){t.toCompare(e.row)}}},[t._v(t._s(e.row.operatedata_value))]):a("span",[t._v(t._s(e.row.operatedata_value))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"is_main",label:"是否为初始操作",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"operate_name",label:"子操作名称",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"real_name",label:"操作人",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作时间",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("renderDateTime")(e.row.operate_time)))])]}}])})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{"current-page":t.currentPage,"page-sizes":[10,25,50,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)},staticRenderFns:[]},re=a("/Xao")(le,oe,!1,function(t){a("UFWd")},null,null).exports,ne={mounted:function(){this.$nextTick(function(){this.modelName=this.$route.query.modelName,this.tableName=this.$route.query.table_name,this.tablePk=this.$route.query.table_pk,this.tablePkvalue=this.$route.query.table_pkvalue,this.getData()})},filters:{renderDateTime:function(t){return B.renderDateTime(t)},renderDate:function(t){return B.renderDate(t)}},data:function(){return{modelName:"",tableName:"",tablePk:"",tablePkvalue:"",tableData:[]}},methods:{getData:function(){var t=this,e={table_name:this.tableName,table_pk:this.tablePk,table_pkvalue:this.tablePkvalue};M.post({url:"/auth/dataCompare",param:e,success:function(e){e.page&&(t.tableData=e.page.list)}})},back:function(){console.log(123231),this.$router.go(-1)}}},se={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{"margin-bottom":"10px","text-align":"left"}},[a("el-button",{staticClass:"el-icon-back",attrs:{type:"primary"},on:{click:function(e){t.back()}}},[t._v("返回")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"col_num",label:"序号",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"field_name",label:"属性名称",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{label:"新值",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:{"red-span":e.row.new_value!==e.row.old_value}},["date"===e.row.type?a("span",[t._v(t._s(t._f("renderDate")(e.row.new_value)))]):"datetime"===e.row.type?a("span",[t._v(t._s(t._f("renderDateTime")(e.row.new_value)))]):a("span",[t._v(t._s(e.row.new_value))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"旧值",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:{"green-span":e.row.new_value!==e.row.old_value}},["date"===e.row.type?a("span",[t._v(t._s(t._f("renderDate")(e.row.old_value)))]):"datetime"===e.row.type?a("span",[t._v(t._s(t._f("renderDateTime")(e.row.old_value)))]):a("span",[t._v(t._s(e.row.old_value))])])]}}])})],1)],1)},staticRenderFns:[]},ce=a("/Xao")(ne,se,!1,function(t){a("9TkA")},null,null).exports,ue={computed:{categoryIdReadonly:function(){return"edit"===this.dialogType},notSelectOne:function(){return 1!==this.selectedRows.length}},data:function(){var t=this;return{inline:!0,dialogTitle:"",dictDialogVisible:!1,formLabelWidth:"130px",dialogType:"",currentPage:1,pageSize:10,total:0,queryShowForm:{category_id:"",category_name:""},queryForm:{category_id:"",category_name:""},dictData:[],selectedRows:[],dictDialogForm:this.initDialogForm(),queryRules:{category_id:[{max:50,message:"长度在50个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}],category_name:[{max:50,message:"长度在50个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}]},rules:{category_id:[{required:!0,message:"请输入代码类别key",trigger:"blur"},{max:50,message:"长度在50个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"},{validator:function(e,a,i){"edit"===t.dialogType&&t.selectedRows[0].category_id===a?i():M.post({url:"/codedict/check/categoryId",param:{categoryId:a},success:function(t){if(!1===t.checkresult)return i(new Error("该代码类别key已存在"));i()}})},trigger:"blur"}],category_name:[{required:!0,message:"请输入代码类别value",trigger:"blur"},{max:50,message:"长度在50个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}],category_sql:[{max:50,message:"长度在50个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}],info:[{max:200,message:"长度在200个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}]}}},mounted:function(){this.$nextTick(function(){this.getData()})},methods:{initDialogForm:function(){return{category_id:"",category_name:"",category_sql:"",info:""}},searchData:function(t){var e=this;this.$refs[t].validate(function(t){t&&(k()(e.queryForm,e.queryShowForm),e.getData())})},getData:function(){var t=this,e={pageindex:this.currentPage,pagesize:this.pageSize},a=B.toggleObjKey(this.queryForm,"upper");k()(e,a),M.post({url:"/codedict/category/list",param:e,success:function(e){e.page&&t.bindGridData(e)}})},addData:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;var a=e,i=e.dictDialogForm;M.post({url:"/codedict/category/add",param:i,success:function(t){a.getData(),a.$message("添加成功"),a.dictDialogVisible=!1}})})},delData:function(){var t=this,e=this,a=this.selectedRows[0];1===this.selectedRows.length?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){M.post({url:"/codedict/category/del",param:{categoryId:a.category_id},success:function(t){e.$message("删除成功"),e.getData()}})}).catch(function(){t.$message({type:"info",message:"已取消删除"})}):this.$message("请选择一行代码类别信息。")},updData:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;var a=e,i=e.dictDialogForm;M.post({url:"/codedict/category/update",param:i,success:function(t){a.getData(),a.$message("编辑成功"),a.dictDialogVisible=!1}})})},showData:function(){1===this.selectedRows.length?this.$router.push({name:"codeDictInfo",query:{category_id:this.selectedRows[0].category_id}}):this.$message("请选择一行代码类别信息。")},submitForm:function(t){"add"===this.dialogType?this.addData(t):"edit"===this.dialogType&&this.updData(t)},bindGridData:function(t){this.dictData=t.page.list,this.currentPage=t.page.index,this.pageSize=t.page.size,this.total=t.page.total},handleSizeChange:function(t){this.currentPage=1,this.pageSize=t,this.getData()},handleCurrentChange:function(t){this.currentPage=t,this.getData()},handleSelectionChange:function(t){this.selectedRows=t},openDialog:function(t){if(this.dialogType=t,"edit"===t){this.dialogTitle="编辑代码类别";if(1!==this.selectedRows.length)return void this.$message("请选择一行代码类别信息。");k()(this.dictDialogForm,this.selectedRows[0])}else"add"===t&&(this.dialogTitle="新建代码类别",this.dictDialogForm=this.initDialogForm());this.dictDialogVisible=!0,this.$refs.dictDialogForm&&this.$refs.dictDialogForm.clearValidate()}}},de={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{ref:"queryShowForm",staticStyle:{"text-align":"left"},attrs:{"label-position":"right","label-width":"120px",model:t.queryShowForm,rules:t.queryRules,inline:t.inline}},[a("el-form-item",{attrs:{label:"代码类别key:",prop:"category_id"}},[a("el-input",{attrs:{"auto-complete":"off",maxlength:50},model:{value:t.queryShowForm.category_id,callback:function(e){t.$set(t.queryShowForm,"category_id",e)},expression:"queryShowForm.category_id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"代码类别value:",prop:"category_name"}},[a("el-input",{attrs:{"auto-complete":"off",maxlength:50},model:{value:t.queryShowForm.category_name,callback:function(e){t.$set(t.queryShowForm,"category_name",e)},expression:"queryShowForm.category_name"}})],1)],1),t._v(" "),a("div",{staticStyle:{"margin-bottom":"10px","text-align":"left"}},[a("el-button",{staticClass:"el-icon-search",attrs:{type:"primary"},on:{click:function(e){t.searchData("queryShowForm")}}},[t._v("查询")]),t._v(" "),a("el-button",{staticClass:"el-icon-plus",attrs:{plain:""},on:{click:function(e){t.openDialog("add")}}},[t._v("新建")]),t._v(" "),a("el-button",{staticClass:"el-icon-edit",attrs:{plain:"",disabled:t.notSelectOne},on:{click:function(e){t.openDialog("edit")}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticClass:"el-icon-delete",attrs:{plain:"",disabled:t.notSelectOne},on:{click:function(e){t.delData()}}},[t._v("删除")]),t._v(" "),a("el-button",{staticClass:"el-icon-view",attrs:{plain:"",disabled:t.notSelectOne},on:{click:function(e){t.showData()}}},[t._v("查看")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.dictData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"category_id",label:"代码类别key",align:"left",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"category_name",label:"代码类别value",align:"left",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"category_sql",label:"代码类别sql",align:"left"}})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{"current-page":t.currentPage,"page-sizes":[10,25,50,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dictDialogVisible},on:{"update:visible":function(e){t.dictDialogVisible=e}}},[a("el-form",{ref:"dictDialogForm",attrs:{model:t.dictDialogForm,rules:t.rules}},[a("el-form-item",{attrs:{label:"代码类别key:","label-width":t.formLabelWidth,prop:"category_id"}},[a("el-input",{attrs:{"auto-complete":"off",disabled:t.categoryIdReadonly,maxlength:50},model:{value:t.dictDialogForm.category_id,callback:function(e){t.$set(t.dictDialogForm,"category_id",e)},expression:"dictDialogForm.category_id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"代码类别value:","label-width":t.formLabelWidth,prop:"category_name"}},[a("el-input",{attrs:{"auto-complete":"off",maxlength:50},model:{value:t.dictDialogForm.category_name,callback:function(e){t.$set(t.dictDialogForm,"category_name",e)},expression:"dictDialogForm.category_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"代码类别sql:","label-width":t.formLabelWidth,prop:"category_sql"}},[a("el-input",{attrs:{"auto-complete":"off",maxlength:50},model:{value:t.dictDialogForm.category_sql,callback:function(e){t.$set(t.dictDialogForm,"category_sql",e)},expression:"dictDialogForm.category_sql"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"描述信息:","label-width":t.formLabelWidth,prop:"info"}},[a("el-input",{attrs:{type:"textarea",maxlength:200},model:{value:t.dictDialogForm.info,callback:function(e){t.$set(t.dictDialogForm,"info",e)},expression:"dictDialogForm.info"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dictDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("dictDialogForm")}}},[t._v("保 存")])],1)],1)],1)},staticRenderFns:[]},me=a("/Xao")(ue,de,!1,function(t){a("xUBz")},null,null).exports,fe={computed:{notSelectOne:function(){return 1!==this.selectedRows.length}},data:function(){return{tableData:[],dialogTitle:"",dictDialogVisible:!1,formLabelWidth:"130px",dialogType:"",currentPage:1,pageSize:10,total:0,selectedRows:[],categoryId:"",dictDialogForm:{code_id:"",category_id:"",code_key:"",code_value:"",onum:"",info:""},rules:{category_id:[{required:!0,message:"请输入代码类别key",trigger:"blur"},{max:50,message:"长度在50个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}],code_key:[{required:!0,message:"请输入代码key",trigger:"blur"},{max:50,message:"长度在50个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}],code_value:[{required:!0,message:"请输入代码value",trigger:"blur"},{max:50,message:"长度在50个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}],onum:[{pattern:/^[1-9]\d{0,2}$/,message:"顺序最多只能输入3位数字"}],info:[{max:200,message:"长度在200个字符以内",trigger:"blur"},{validator:J.checkFormSpecialCode,trigger:"blur"}]}}},mounted:function(){this.$nextTick(function(){this.categoryId=this.$route.query.category_id,this.getData()})},methods:{handleSizeChange:function(t){this.currentPage=1,this.pageSize=t,this.getData()},handleCurrentChange:function(t){this.currentPage=t,this.getData()},handleSelectionChange:function(t){this.selectedRows=t},bindGridData:function(t){this.tableData=t.page.list,this.currentPage=t.page.index,this.pageSize=t.page.size,this.total=t.page.total},initDialogForm:function(){return{category_id:"",code_key:"",code_value:"",onum:"",info:""}},openDialog:function(t){if(this.dialogType=t,"edit"===t){this.dialogTitle="编辑字典信息";if(1!==this.selectedRows.length)return void this.$message("请选择一行字典信息。");k()(this.dictDialogForm,this.selectedRows[0])}else"add"===t&&(this.dialogTitle="新建字典信息",this.dictDialogForm=this.initDialogForm(),this.dictDialogForm.category_id=this.categoryId);this.dictDialogVisible=!0,this.$refs.dictDialogForm&&this.$refs.dictDialogForm.clearValidate()},submitForm:function(t){"add"===this.dialogType?this.addData(t):"edit"===this.dialogType&&this.updData(t)},addData:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;var a=e,i=e.dictDialogForm;M.post({url:"/codedict/code/add",param:i,success:function(t){a.getData(),a.$message("添加成功"),a.dictDialogVisible=!1}})})},getData:function(){var t=this,e={categoryId:this.categoryId,pageindex:this.currentPage,pagesize:this.pageSize};M.post({url:"/codedict/category/codelist",param:e,success:function(e){e.page&&t.bindGridData(e)}})},delData:function(){var t=this,e=this,a=this.selectedRows[0];1===this.selectedRows.length?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){M.post({url:"/codedict/code/del",param:{codeId:a.code_id},success:function(t){e.$message("删除成功"),e.getData()}})}).catch(function(){t.$message({type:"info",message:"已取消删除"})}):this.$message("请选择一行字典信息。")},updData:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;var a=e,i=e.dictDialogForm;M.post({url:"/codedict/code/update",param:i,success:function(t){a.getData(),a.$message("编辑成功"),a.dictDialogVisible=!1}})})},back:function(){this.$router.push({name:"codedict"})}}},pe={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{"margin-bottom":"10px","text-align":"left"}},[a("el-button",{staticClass:"el-icon-back",attrs:{type:"primary"},on:{click:function(e){t.back()}}},[t._v("返回")]),t._v(" "),a("el-button",{staticClass:"el-icon-plus",attrs:{plain:""},on:{click:function(e){t.openDialog("add")}}},[t._v("新建")]),t._v(" "),a("el-button",{staticClass:"el-icon-edit",attrs:{plain:"",disabled:t.notSelectOne},on:{click:function(e){t.openDialog("edit")}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticClass:"el-icon-delete",attrs:{plain:"",disabled:t.notSelectOne},on:{click:function(e){t.delData()}}},[t._v("删除")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"category_id",label:"类别代码",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"category_name",label:"类别名称",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"code_key",label:"代码key",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"code_value",label:"代码value",align:"left"}})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{"current-page":t.currentPage,"page-sizes":[10,25,50,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dictDialogVisible},on:{"update:visible":function(e){t.dictDialogVisible=e}}},[a("el-form",{ref:"dictDialogForm",attrs:{model:t.dictDialogForm,rules:t.rules}},[a("el-form-item",{attrs:{label:"代码类别key:","label-width":t.formLabelWidth,prop:"category_id"}},[a("el-input",{attrs:{"auto-complete":"off",disabled:!0,maxlength:50},model:{value:t.dictDialogForm.category_id,callback:function(e){t.$set(t.dictDialogForm,"category_id",e)},expression:"dictDialogForm.category_id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"代码key:","label-width":t.formLabelWidth,prop:"code_key"}},[a("el-input",{attrs:{"auto-complete":"off",maxlength:50},model:{value:t.dictDialogForm.code_key,callback:function(e){t.$set(t.dictDialogForm,"code_key",e)},expression:"dictDialogForm.code_key"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"代码value:","label-width":t.formLabelWidth,prop:"code_value"}},[a("el-input",{attrs:{"auto-complete":"off",maxlength:50},model:{value:t.dictDialogForm.code_value,callback:function(e){t.$set(t.dictDialogForm,"code_value",e)},expression:"dictDialogForm.code_value"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"顺序:","label-width":t.formLabelWidth,prop:"onum"}},[a("el-input",{attrs:{"auto-complete":"off",maxlength:3},model:{value:t.dictDialogForm.onum,callback:function(e){t.$set(t.dictDialogForm,"onum",e)},expression:"dictDialogForm.onum"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"描述信息:","label-width":t.formLabelWidth,prop:"info"}},[a("el-input",{attrs:{type:"textarea",maxlength:200},model:{value:t.dictDialogForm.info,callback:function(e){t.$set(t.dictDialogForm,"info",e)},expression:"dictDialogForm.info"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dictDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("dictDialogForm")}}},[t._v("保 存")])],1)],1)],1)},staticRenderFns:[]},he=a("/Xao")(fe,pe,!1,function(t){a("bXdE")},null,null).exports,ge=null,ve={computed:{timeCountShow:function(){return 0!==this.timeCount},timeCountStr:function(){var t=0,e=0,a=0;return(t=parseInt(this.timeCount/60/60))<10&&(t="0"+t),(e=parseInt(this.timeCount/60%60))<10&&(e="0"+e),(a=parseInt(this.timeCount%60))<10&&(a="0"+a),t+":"+e+":"+a},IPProgressStatus:function(){return 100===this.IPProgress?"success":""},cityProgressStatus:function(){return 100===this.cityProgress?"success":""},cardProgressStatus:function(){return 100===this.cardProgress?"success":""},mobileProgressStatus:function(){return 100===this.mobileProgress?"success":""}},data:function(){return{timeCount:0,IPProgressShow:!1,cityProgressShow:!1,cardProgressShow:!1,mobileProgressShow:!1,IPProgress:0,cityProgress:0,cardProgress:0,mobileProgress:0,upload_url:"higitech",uploadForm:new FormData,rules:{}}},methods:{submitForm:function(){this.uploadForm=new FormData;var t=!1,e=!1,a=!1,i=!1,l="",o="",r="",n="";try{var s=this.$refs.importIPFile.$data.uploadFiles,c=this.$refs.importCityFile.$data.uploadFiles,u=this.$refs.importCardFile.$data.uploadFiles,d=this.$refs.importMobileFile.$data.uploadFiles;s&&s[0]&&(t=!0,l=s[0].name),c&&c[0]&&(e=!0,o=c[0].name),u&&u[0]&&(a=!0,r=u[0].name),d&&d[0]&&(i=!0,n=d[0].name)}catch(t){console.log(t)}if(t)if(e)if(a)if(i)if(l.endsWith(".csv"))if(o.endsWith(".csv"))if(r.endsWith(".csv"))if(n.endsWith(".csv")){this.$refs.importIPFile.submit(),this.$refs.importCityFile.submit(),this.$refs.importCardFile.submit(),this.$refs.importMobileFile.submit();var m=this;this.progressReset(),this.timeCount=0;try{window.clearInterval(ge)}catch(t){}t&&(this.IPProgressShow=!0),e&&(this.cityProgressShow=!0),a&&(this.cardProgressShow=!0),i&&(this.mobileProgressShow=!0),M.post({url:"/ip/import",param:m.uploadForm,success:function(t){m.uploadForm=new FormData,M.post({url:"/ip/recordImpInfo",param:{},success:function(){ge=window.setInterval(m.getImportProgress,1e3)}})},error:function(t){m.uploadForm=new FormData,m.$message(t.error),m.progressReset();try{window.clearInterval(ge)}catch(t){}},fail:function(t){m.uploadForm=new FormData,m.$message("导入文件发生错误"),console.log(t),m.progressReset();try{window.clearInterval(ge)}catch(t){}}})}else this.$message("手机号段文件必须为csv文件");else this.$message("身份证号段文件必须为csv文件");else this.$message("城市代码文件必须为csv文件");else this.$message("IP地址文件必须为csv文件");else this.$message("请选择手机号段文件");else this.$message("请选择身份证号段文件");else this.$message("请选择城市代码文件");else this.$message("请选择IP地址文件")},getImportProgress:function(){var t=this;M.post({url:"/ip/getProgress",param:{},success:function(e){var a=e.errorinfo,i=e.ipprogress,l=e.cityprogress,o=e.cardprogress,r=e.mobileprogress;if(console.log(i+"-"+l+"-"+o+"-"+r),t.IPProgress=i,t.cityProgress=l,t.cardProgress=o,t.mobileProgress=r,B.isEmpty(a)||(t.$message(a),console.log("clear timer"),window.clearInterval(ge)),t.timeCount++,30===t.timeCount&&0===i&&0===l&&0===o&&0===r&&(t.$message("导入文件发生错误"),window.clearInterval(ge)),!B.isEmpty(a)||!(i<100||l<100||o<100||r<100))try{console.log("clear timer"),window.clearInterval(ge)}catch(t){console.log(t)}}})},progressReset:function(){this.IPProgress=0,this.cityProgress=0,this.cardProgress=0,this.mobileProgress=0,this.IPProgressShow=!1,this.cityProgressShow=!1,this.cardProgressShow=!1,this.mobileProgressShow=!1},importIPFile:function(t){return this.uploadForm.append("importIPFile",t),this.$refs.importIPFile.abort(),!1},importCityFile:function(t){return this.uploadForm.append("importCityFile",t),this.$refs.importIPFile.abort(),!1},importCardFile:function(t){return this.uploadForm.append("importCardFile",t),this.$refs.importIPFile.abort(),!1},importMobileFile:function(t){return this.uploadForm.append("importMobileFile",t),this.$refs.importIPFile.abort(),!1},importIPFileFinish:function(){return!1},importCityFileFinish:function(){return!1},importCardFileFinish:function(){return!1},importMobileFileFinish:function(){return!1}}},be={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h1",[t._v("IP地址维护")]),t._v(" "),a("el-row",{staticClass:"ip-content-box"},[t.timeCountShow?a("el-alert",{staticClass:"time-tip",attrs:{title:t.timeCountStr,type:"success",closable:!1,center:""}}):t._e(),t._v(" "),a("el-col",{attrs:{span:6}},[t.IPProgressShow?a("el-progress",{staticClass:"progress-box",attrs:{"text-inside":!0,"stroke-width":18,percentage:t.IPProgress,status:t.IPProgressStatus}}):t._e(),t._v(" "),a("el-container",[a("el-main",[a("el-upload",{ref:"importIPFile",staticClass:"ip-file-upload ipaddr-fie-upload",attrs:{accept:".csv",name:"importIPFileInput",drag:"",action:t.upload_url,limit:1,multiple:!1,"auto-upload":!1,"before-upload":t.importIPFile,"on-success":t.importIPFileFinish,"on-error":t.importIPFileFinish}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[a("em",[t._v("IP地址文件")])]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("请导入csv文件")])])],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[t.cityProgressShow?a("el-progress",{staticClass:"progress-box",attrs:{"text-inside":!0,"stroke-width":18,percentage:t.cityProgress,status:t.cityProgressStatus}}):t._e(),t._v(" "),a("el-container",[a("el-main",[a("el-upload",{ref:"importCityFile",staticClass:"ip-file-upload ipaddr-fie-upload",attrs:{accept:".csv",name:"importCityFileInput",drag:"",action:t.upload_url,limit:1,multiple:!1,"auto-upload":!1,"before-upload":t.importCityFile,"on-success":t.importCityFileFinish,"on-error":t.importCityFileFinish}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[a("em",[t._v("城市代码文件")])]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("请导入csv文件")])])],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[t.cardProgressShow?a("el-progress",{staticClass:"progress-box",attrs:{"text-inside":!0,"stroke-width":18,percentage:t.cardProgress,status:t.cardProgressStatus}}):t._e(),t._v(" "),a("el-container",[a("el-main",[a("el-upload",{ref:"importCardFile",staticClass:"ip-file-upload ipaddr-fie-upload",attrs:{accept:".csv",name:"importCardFileInput",drag:"",action:t.upload_url,limit:1,multiple:!1,"auto-upload":!1,"before-upload":t.importCardFile,"on-success":t.importCardFileFinish,"on-error":t.importCardFileFinish}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[a("em",[t._v("身份证号段文件")])]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("请导入csv文件")])])],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[t.mobileProgressShow?a("el-progress",{staticClass:"progress-box",attrs:{"text-inside":!0,"stroke-width":18,percentage:t.mobileProgress,status:t.mobileProgressStatus}}):t._e(),t._v(" "),a("el-container",[a("el-main",[a("el-upload",{ref:"importMobileFile",staticClass:"ip-file-upload ipaddr-fie-upload",attrs:{accept:".csv",name:"importMobileFileInput",drag:"",action:t.upload_url,limit:1,multiple:!1,"auto-upload":!1,"before-upload":t.importMobileFile,"on-success":t.importMobileFileFinish,"on-error":t.importMobileFileFinish}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[a("em",[t._v("手机号段文件")])]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("请导入csv文件")])])],1)],1)],1)],1),t._v(" "),a("div",{staticStyle:{"margin-top":"50px"}},[a("el-button",{staticClass:"submit-btn",attrs:{type:"success"},on:{click:function(e){t.submitForm()}}},[t._v("确定")])],1),t._v(" "),a("el-row")],1)},staticRenderFns:[]},_e=a("/Xao")(ve,be,!1,function(t){a("2WvI")},null,null).exports,ye={created:function(){this.selLog(),this.selFunc()},methods:{handleSizeChange:function(t){console.log("每页 "+t+" 条")},handleCurrentChange:function(t){console.log("当前页: "+t)},handleSelectionChange:function(t){this.multipleSelection=t},bindGridData:function(t){this.roleData=t.page.list,this.currentPage=t.page.index,this.pagesize=t.page.size,this.total=t.page.total},selFunc:function(){var t=this,e={url:"/func/getAll",success:function(e){t.funcList=e.row}};M.post(e)},selLog:function(){var t=this,e="",a="";null!==t.value6&&t.value6.length>0&&(e=t.value6[0],a=t.value6[1]);var i={url:"/log/list",param:{operator_name:t.logForm.operator_name,operate_func:t.logForm.operate_func,operate_time:e,end_time:a,pageindex:1,pagesize:10},success:function(e){e.page&&t.bindGridData(e)}};M.post(i)},formatterDate:function(t,e){return B.renderDateTime(t.operate_time)}},data:function(){return{inline:!0,value6:[],funcList:[],logForm:{operator_name:"",operate_func:"",operate_time:"",end_time:""},roleData:[{operate_time:1513130185e3,func_name:"用户登录",operate_data:"用户名称:admin;",split_rows_num:1,log_mac:"530BB7696F839F0606CC375A201CBF74",operate_result:"1",log_id:"77564A9B988A40359DADCBE08D49D40A",real_name:"系统管理员",login_name:"admin"}],currentPage:4,pagesize:10,total:100,formLabelWidth:"100px",multipleSelection:[],flag:""}}},Fe={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{staticStyle:{"text-align":"left"},attrs:{"label-position":"right","label-width":"80px",model:t.logForm,inline:t.inline}},[a("el-form-item",{attrs:{label:"操作员",prop:"operator_name"}},[a("el-input",{model:{value:t.logForm.operator_name,callback:function(e){t.$set(t.logForm,"operator_name",e)},expression:"logForm.operator_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"所属功能",prop:"operate_func"}},[a("el-select",{attrs:{placeholder:"所属功能"},model:{value:t.logForm.operate_func,callback:function(e){t.$set(t.logForm,"operate_func",e)},expression:"logForm.operate_func"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),t._l(t.funcList,function(t){return a("el-option",{key:t.func_id,attrs:{label:t.func_name,value:t.func_id}})})],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"操作时间",prop:"real_name"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"到","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.value6,callback:function(e){t.value6=e},expression:"value6"}})],1)],1),t._v(" "),a("div",{staticStyle:{"margin-bottom":"10px","text-align":"left"}},[a("el-button",{staticClass:"el-icon-search",attrs:{type:"primary"},on:{click:t.selLog}},[t._v("查询")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.roleData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"35",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"real_name",label:"操作员",align:"left",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"login_name",label:"用户名",align:"left",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"operate_time",label:"操作时间",align:"left",width:"100",formatter:t.formatterDate}}),t._v(" "),a("el-table-column",{attrs:{prop:"func_name",label:"所属功能",align:"left",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"operate_result",label:"操作结果",align:"left",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"operate_data",label:"操作数据",align:"left"}})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{"current-page":t.currentPage,"page-sizes":[10,25,50,100],"page-size":t.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)},staticRenderFns:[]},De=a("/Xao")(ye,Fe,!1,function(t){a("TPNC")},null,null).exports,we={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h1",[this._v("交易事件查询")])])}]},xe=a("/Xao")({},we,!1,function(t){a("tqU+")},null,null).exports,Se={data:function(){return{value10:(new Date).format("yyyy-MM-dd hh:mm:ss"),defaultValue:new Date}}},Ce={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h1",[t._v("预警事件查询")]),t._v(" "),a("h2",[t._v("选择时间： "+t._s(t.value10))]),t._v(" "),a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss","default-value":t.defaultValue},model:{value:t.value10,callback:function(e){t.value10=e},expression:"value10"}})],1)},staticRenderFns:[]},ke=a("/Xao")(Se,Ce,!1,function(t){a("2/Do")},null,null).exports,$e={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h1",[this._v("404")]),this._v(" "),e("h2",[this._v("找不到该页面")])])}]},Le=a("/Xao")({},$e,!1,function(t){a("0XQa")},null,null).exports;D.default.use(S.a);var Ie=new S.a({mode:"history",base:B.getWebRootPath(),linkActiveClass:"active",routes:[{path:"/login_vue",name:"login",component:G},{path:"/",name:"main",component:H,meta:{requireAuth:!0},children:[{path:"user_vue",name:"user",component:at},{path:"role_vue",name:"role",component:ct},{path:"func_vue",name:"func",component:mt},{path:"valuelist_vue",name:"valuelist",component:bt},{path:"list_vue",name:"list",component:ht},{path:"txn_vue",name:"txn",component:Kt},{path:"authCenter_vue",name:"authCenter",component:Jt},{path:"authDataCompare_vue",name:"authDataCompare",component:ce},{path:"authDataList_vue",name:"authDataList",component:te},{path:"authLogList_vue",name:"authLogList",component:ie},{path:"authSubDataList_vue",name:"authSubDataList",component:re},{path:"codedict_vue",name:"codedict",component:me},{path:"codeDictInfo_vue",name:"codeDictInfo",component:he},{path:"ipaddr_vue",name:"ipaddr",component:_e},{path:"log_vue",name:"log",component:De},{path:"txnEventQuery_vue",name:"txnEventQuery",component:xe},{path:"alarmEventQuery_vue",name:"alarmEventQuery",component:ke}]},{path:"*",name:"notFound",component:Le}]}),Pe=a("FDFR"),Ve=a.n(Pe);a("Uo1D");D.default.use(Ve.a,{size:"small"}),D.default.prototype.$axios=L.a,D.default.config.productionTip=!1,rt.getCodeData(),new D.default({el:"#app",router:Ie,template:"<App/>",components:{App:x}})},OqD3:function(t,e){},Pfk1:function(t,e){},RjNk:function(t,e){},TPNC:function(t,e){},"U/hr":function(t,e){},UFWd:function(t,e){},Uo1D:function(t,e){},W6kQ:function(t,e){},bXdE:function(t,e){},fVoO:function(t,e){},j6g3:function(t,e){},k2ED:function(t,e){},kirL:function(t,e){},mU65:function(t,e){},rSw5:function(t,e){},tjRK:function(t,e){},"tqU+":function(t,e){},xUBz:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.f68445a8731ba6e3703a.js.map