<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>#springMessage("view.tms.mgr.nameviewlist.edit.title")</title>
<link href="$rc.contextPath/s/common/css/page.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="$rc.contextPath/s/common/js/jquery.min.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/js/browser.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/js/jcl.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/env/env.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/env/message.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/js/jquery.url.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/tms/js/commoncheck.js"></script>
<script type="text/javascript">
$(document).ready(function(){
	
	var rosterId = "rosterId="+jQuery.url.param("rosterId");
	var qtype = jQuery.url.param("qtype");
	
	var box = new jcl.ui.Box({
		title: '#springMessage("view.tms.mgr.nameviewlist.edit.title")',
		id:'editNameListFormBox'
	});
	box.addDom('dataForm');
	
	var dialog = jcl.ui.Dialog({
		title:'#springMessage("view.tms.pub.dialog.title")'
	});
	dialog.addDom('succesInfo');
	
	// 名单数据类型下拉列表
	jcl.postJSON('/tms/mgr/getDataTypeList', "", function(data){
		$.each(data.row, function(i,row){
			$("select[name=datatype]").append("<option value='" + row['DATATYPE'] + "'>" + row['DATATYPENAME'] + "</option>");  
		}); 
	});
	
	// 名单类型下拉列表
	jcl.code.selector('rostertype','tms.mgr.rostertype',{text:'--请选择--',value:''});
	
	
	var geturl = "/tms/mgrView/get";
	if(qtype=='new'){
		geturl = "/tms/mgr/get";
	}
	// 初始化页面数据
	jcl.postJSON(''+geturl, rosterId, function(data){
			$('#rosterId').val(data.row.ROSTERID);
			$('#rosterdesc').val(data.row.ROSTERDESC);
			$('#rostername').val(data.row.ROSTERNAME);
			$('#rosterName').val(data.row.ROSTERNAME);
			
			//radio设置value的值的项目为当前选中项
			$("input[@name=iscache][value=" + data.row.ISCACHE + "]").attr("checked",true);
			
			//select设置value的值的项目为当前选中项
			$("#rostertype").attr("value",data.row.ROSTERTYPE);
			$("#datatype").attr("value",data.row.DATATYPE);
	});
	
	
	// 取消
	$('#cancelBtn').click(function(){
		window.close();
	//	jcl.go('/tms/mgr/list');
	});
	
	// 返回
	$('#backBtn').click(function(){
		window.close();
//		jcl.go('/tms/mgr/list');
	});
	// 数据类型修改事件
	$('#datatype').change(function(){
		var datatype=$('select[name=datatype]').val();
		// 名单数据类型的是否允许统计
		jcl.postJSON('/tms/mgr/getDataTypeList', "datatype="+datatype, function(data){
			
			$.each(data.row, function(i,row){
				isstat = row['ISSTAT'];  
			}); 
			if(isstat == 1){
				$('#rostertype').removeAttr("disabled");
				$('#fontid_type').text("*");
			}else{
				$('#rostertype').attr("value","");
				$('#rostertype').attr("disabled","true");
				$('#fontid_type').text("");
			}
		});
	});
	
});

</script>

</head>
<body>
<div id="succesInfo">
	<div>#springMessage("view.cmc.pub.edit.success")</div>
	<div class="button-box">
		<input type="button" value='#springMessage("view.cmc.pub.btn.sure")' class="btn" id="backBtn"/>
	</div>
</div>

<form name="dataForm" id="dataForm" method="post">
<ul class="list-box">
	<li class="list-box-item">
		<label class="list-box-item-label">#springMessage("view.tms.mgr.namelist.rostername")：</label> 
		<span class="list-box-item-content">
		<input name="rostername" id = 'rostername' type="text" class="itext" disabled  = 'disabled'/>
		</span>
	</li>
	<li class="list-box-item">
		<label class="list-box-item-label">#springMessage("view.tms.mgr.namelist.datatype")：</label> 
		<span class="list-box-item-content"> 
		<select name="datatype" id = 'datatype' disabled = 'disabled'>
                     <option value="">--请选择--</option>
               </select>
		</span>
	</li>
	<li class="list-box-item">
		<label class="list-box-item-label">#springMessage("view.tms.mgr.namelist.rostertype")：</label> 
		<span class="list-box-item-content"> <select name="rostertype" id = 'rostertype' disabled = 'disabled'>
                     <option value="">--请选择--</option>
               </select>
		</span>
	</li>
	<li class="list-box-item">
		<label class="list-box-item-label">#springMessage("view.tms.mgr.namelist.iscache")：</label> 
		<span class="list-box-item-content">
			<input type="radio" name="iscache" value="1"  disabled= 'disabled'/> 是
			<input type="radio" name="iscache" value="0" disabled= 'disabled' /> 否
 		</span>
	</li>
	<li class="list-box-item">
		<label class="list-box-item-label">#springMessage("view.tms.mgr.namelist.rosterdesc")：</label> 
		<span class="list-box-item-content">
		<textarea  name="rosterdesc"  maxlength="512" id='rosterdesc' rows="3"cols="20" class="ttext" disabled='disabled' ></textarea>
		</span>
	</li>
	<!-- 页面只有一个text，需要加一个空input标签防止回车提交-->
	 <input   style= "display:none; "/>
</ul>
<div class="button-box">
	<input type="button" value='#springMessage("view.tms.pub.btn.close")' class='btn' id='cancelBtn'/>
	<input name="rosterId" id="rosterId" type="hidden" class="itext" />
	<input name="rosterName" id="rosterName" type="hidden" class="itext" />
</div>
</form>

</body>
</html>
