<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>#springMessage("view.tms.traffic.editinfo")</title>
<link href="$rc.contextPath/s/common/css/page.css" rel="stylesheet" type="text/css" />
<link href="$rc.contextPath/s/common/css/tree.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="$rc.contextPath/s/common/js/jquery.min.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/js/browser.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/js/jcl.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/env/env.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/env/message.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/js/jquery.url.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/tms/js/commoncheck.js"></script>

<script type="text/javascript">
$(document).ready(function(){
	
	var txnId = jQuery.url.param("txnId");
	var qtype = jQuery.url.param("qtype");
	var url = '/tms/dp/txnView/get';
	if(qtype=='new'){
		url = '/tms/dp/txn/get';
	}
	
	var title = "";
	var box = new jcl.ui.Box({
		title: title,
		id:'addRoleFormBox',
		minWidth:490
	});
	box.addDom('dataForm');
	
	jcl.code.selector('txntype','tms.common.txntype',{text:'--请选择--',value:''});
	var param = "txnId="+txnId;
	
	jcl.postJSON(url, param, function(data){
			
		$('#txnffid').val(data.row.TXNGROUPID);
		$('#txnchannelid').val(data.row.CHANNELID);
		
		$('#txnfname').val(data.row.TXNNAME);
		$('#txninfo').val(data.row.TXNDESC);
		$('#txnffname').val(data.row.PARENTNAME);
		$('#WEIGHT').val(data.row.WEIGHT);
		$('#ORDERBY').val(data.row.ORDERBY);
		
		$('#txntype').val(data.row.TXNTYPE);
		
		
		$('input:radio[name=status]').each(function(){
		if (data.row.STATUS == '0'){
			$('#status1').attr('checked', true);
		}else{
			$('#status2').attr('checked', true);
		}
		});
					
		$('#config1').text(data.row.CONFIG1);
		$('#config2').text(data.row.CONFIG2);
		 
		var versionlist = data.versionlist;
				
		
		var htmlStr ='';
		for(var i=0;versionlist!=null&&i<versionlist.length;i++){ 
			if(data.row.VERSIONID==versionlist[i]['VERSIONID']){
				htmlStr+='<input name="txnversion" type="hidden" value="'+versionlist[i]['VERSIONID']+'" id="txnversion" />';
				htmlStr+=versionlist[i]['VERSIONNAME'];
			}
		}
		$('#spanversion').html(htmlStr);		
			
	});
	
	$('#txncancelButton').click(function(){
		if(qtype!=null && qtype!=''){//如果是授权模块的查看，点击取消直接关闭对话框
			window.close();
		}else{
			window.parent.document.getElementById("ifram-box").style.display="none";
		}
	});
	$('#backBtn').click(function(){
		window.parent.location.href=window.parent.location.href;
	});
	
	if(qtype==null || qtype==''){
		$('#viewConfig').hide();
	}
	
	$('#viewConfig').click(function(){
		var txnIdStr = 'txnId='+txnId;
		var params = txnIdStr+'&qtype='+qtype;
		window.open("$rc.contextPath/tms/dp/txnView/config?"+params,'交易特征配置','height=700,width=1200,top=50,left=100,toolbar=no,menubar=no,scrollbars=yes, resizable=yes,location=no, status=no') ;//新页面打开
	});
	
});

function mark(){
	var weight=$('#WEIGHT').val();
	if(weight==0){
		$('#mark').show();
	}else{
		$('#mark').hide();
	}
}

</script>

</head>
<body>



<div id="form-txn-box" style="width:480px;">
	<form name="dataForm" id="dataForm" method="post">
	<ul class="list-box">
		<li>#springMessage("view.tms.traffic.info")</li>
	</ul>
	<hr />
	<input name="txnfid" type="hidden" id="txnfid" />
	<input name="parent_id" type="hidden" id="txnffid" />
	<input name="channelid" type="hidden" id="txnchannelid" />
	<!-- 用于复制交易时使用 -->
	<input name="copyTxnId" type="hidden" id="copyTxnId" />
	
	<ul class="list-box">
		<li class="list-box-item">
			<label class="list-box-item-label" for="txnfname">#springMessage("view.tms.traffic.name")：</label> 
			<span class="list-box-item-content">
			<input name="txn_name" type="text" class="itext" id="txnfname" disabled="disabled"/>
			</span></li>
		<li class="list-box-item">
			<label class="list-box-item-label" for="info">#springMessage("view.tms.traffic.groupdesc")：</label> 
			<span class="list-box-item-content">
			<textarea name="txninfo" class="ttext" id="txninfo"  disabled="disabled"></textarea></span></li>
							
		<li class="list-box-item">
			<label class="list-box-item-label" for="txnffname">#springMessage("view.tms.traffic.groupparent")：</label> 
			<span class="list-box-item-content">
				<input name="ffname" type="text" class="itext" id="txnffname" disabled="disabled"/>
			</span></li>
			
		<li class="list-box-item">
			<label class="list-box-item-label" for="txnversion">#springMessage("view.tms.traffic.version")：</label> 
			 
			<span class="list-box-item-content" id="spanversion"> </span>
		</li>
		<li class="list-box-item">
			<label class="list-box-item-label" for="onum">#springMessage("view.tms.traffic.weight")：</label> 
			<span class="list-box-item-content">
			<input name="WEIGHT" type="text"  class="itext short" id="WEIGHT" disabled="disabled" />%
			<label id="mark" style="display: none;color: red;" >#springMessage("view.tms.traffic.weightMark")</label>
			</span>
		</li>				
		<li class="list-box-item">
			<label class="list-box-item-label" for="onum">#springMessage("view.tms.traffic.grouporder")：</label> 
			<span class="list-box-item-content">
			<input name="ORDERBY" type="text" class="itext short" id="ORDERBY"  disabled="disabled"/></span>
		</li>
		
		<li class="list-box-item" id="item-menu">
			<label class="list-box-item-label" for="txntype">#springMessage("view.tms.traffic.fundstraffic")：</label> 
			<span class="list-box-item-content">
				<select name="txntype" id="txntype" style="width: 100px"  disabled="disabled">
				</select>
			</span>
		</li>
		<li class="list-box-item" id="item-menu">
			<label class="list-box-item-label" for="txnstatus">#springMessage("view.tms.pub.btn.isused")：</label> 
			<span class="list-box-item-content">
				<input type="radio" name="status" value="0" id="status1" disabled="disabled" /> #springMessage("view.tms.pub.flag.false")
				<input type="radio" name="status" value="1" id="status2" disabled="disabled" /> #springMessage("view.tms.pub.flag.true")
			</span>
		</li>
	</ul>
       
	<div class="button-box">
		<input type="button" value='#springMessage("view.tms.pub.btn.close")' class="btn" id="txncancelButton"/>
		<input type="button" value='#springMessage("view.tms.discern.viewconfiginfo")' class="btn" id="viewConfig" />
	</div>
	
	<div id="confinfo"  >
	<ul class="list-box">
		<li>#springMessage("view.tms.traffic.configinfo")</li>
	</ul>
	<hr />
	
	<table width="100%"   id="conftab" border="1" align="center" style="border-collapse: collapse;">
		<tr >
			<td width="15%" valign="middle" colspan="3" align="center">
				#springMessage("view.tms.traffic.featureConfig")：
			</td>
			<td width="80%" valign="top"   align="left" id="config1">
			</td>
		</tr>
		<tr  bgcolor="#EDEDED">
			<td width="15%" valign="middle" colspan="3" align="center">
				#springMessage("view.tms.traffic.tranConfig")：
			</td>
			<td width="80%" valign="top"   align="left" id="config2">
			</td>
		</tr>
	</table>
	
	</div>
	</form>
	
</div>

</body>
</html>
