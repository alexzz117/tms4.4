<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>#springMessage("view.tms.monitor.center.alarm")</title>
<link href="$rc.contextPath/s/common/css/page.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="$rc.contextPath/s/tms/css/Style.css" type="text/css" />
<script type="text/javascript" src="$rc.contextPath/s/common/js/jquery.min.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/js/browser.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/js/jcl.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/env/env.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/env/message.js"></script>
<script type="text/javascript" src="$rc.contextPath/s/common/js/jquery.url.js"></script>

<script type="text/javascript">
$(document).ready(function(){
	trafficid = jQuery.url.param("trafficid");
	
	var box = new jcl.ui.Box({
		title: '#springMessage("view.tms.monitor.center.transactiontraffic.matchstatistic.detail")',
		id:'editNameListFormBox'
	});
	box.addDom('dataForm');
	
	var box2 = new jcl.ui.Box({
		title: '#springMessage("view.tms.monitor.center.alertnumst")',
		id:'fffformBox'
	});
	box2.addDom('dataForm1');
	jcl.postJSON('/tms/monitor/alarm/get_transactiontrafficlist_detail?trafficid='+trafficid, "", function(data){
		
		//data = {"TRAFFICID":"A6485C4E15FBDDBCE040080A42017B39","SESSIONID":"A5DFBE4FAB5AB713E040080A420126ECA5DFBE4FAB5BB713E040080A420126EC","USERID":"USER904625195","TXNID":"EEDBDD9B92B648D9BABD957168125029","TXNCODE":null,"CURDAY":22,"CURHOUR":16,"CURMINUTE":1,"TXNTIME":"2011-06-22 16:01:45","TXNSTATUS":"1","DEVICEID":"1","IPADDR":"22","IPADDRLONG":1,"COUNTRYCODE":"000000","REGIONCODE":"460000","CITYCODE":"370900","ISPCODE":"1","ISLOGIN":"0","ISRISK":"0","TEXT1":"1","TEXT2":"1","TEXT3":"1","TEXT4":"1","TEXT5":"1","TEXT6":"1","TEXT7":"1","TEXT8":"1","TEXT9":"1","TEXT10":"1","TEXT11":"1","TEXT12":"1","TEXT13":"1","TEXT14":"1","TEXT15":"1","NUM1":1,"NUM2":1,"NUM3":1,"NUM4":1,"NUM5":1,"NUM6":1,"NUM7":1,"NUM8":1,"NUM9":1,"NUM10":1,"NUM11":1,"NUM12":1,"NUM13":1,"NUM14":1,"NUM15":1,"FINISHTIME":"2011-06-22 16:12:32","EXECTIMES":271,"TXNTYPE":"1","用户标识":"USER904625195","交易时间":"2011-06-22 16:01:45","交易状态":"1","设备ID":"1","城市代码":"370900","地区代码":"460000","交易类型":"1","ISP代码":"1","Session标识":"A5DFBE4FAB5AB713E040080A420126ECA5DFBE4FAB5BB713E040080A420126EC","客户端Ip地址":"22","交易流水号":null,"国家代码":"000000","111":"1","222":1};
		var divData = "<ul class=\"list-box\">";
		var li_begin = "<li class=\"list-box-item\">";
		var label_begin = "<label class=\"list-box-item-label\">";
		var label_end = "</label>";
		var span_begin = "<span class=\"list-box-item-content\">";
		var div_begin = "<div style=\"font-weight: bold\">";
		var div_end = "</div>";
		var span_end = "</span>";
		var li_end = "</li>";
		$.each(data.jsonlist, function(i, entry){
		
			divData += li_begin;
			divData += label_begin;
			divData += entry.key;//key
			divData += ":";
			divData += label_end;
			divData += span_begin;
			divData += div_begin;
			
			entry.value = entry.value == null || entry.value == "null" ? '' : entry.value;
			if(entry.dic == null || entry.dic == ""){
				divData += entry.value;
			} else {
				divData += jcl.code.get(entry.dic, entry.value);
			}
			
			divData += div_end;
			divData += span_end;
			divData += li_end;
		});
		divData += "</ul>";
		$('#dataForm').append(divData);
	});
	
	jcl.postJSON('/tms/monitor/alarm/get_transactiontrafficlist_alarm?trafficid='+trafficid, "", function(data){
		if(data.row != null	&&	data.row.length > 0){
			
			var alertlist = data.row;
			var tHtml='';
			for(var i=0;i<alertlist.length;i++){
				tHtml+='<tr  style="font-size: 12px" >';
				tHtml+='<td valign="top"  align="center">';
				tHtml+=alertlist[i]["ALERTID"];
				tHtml+='</td>';
				
				tHtml+='<td   valign="top" align="center">';
				tHtml+=alertlist[i]["HITRULENUM"];
				tHtml+='</td>';
				
				tHtml+='<td   valign="top" align="center">';
				tHtml+=alertlist[i]["TRIGRULENUM"];
				tHtml+='</td>';
				
				tHtml+='<td   valign="top" align="center">';
				tHtml+=alertlist[i]["RISKLEVEL"];
				tHtml+='</td>';
				
				tHtml+='<td   valign="top" align="center">';
				tHtml+=alertlist[i]["SCORE"];
				tHtml+='</td>';
				
				tHtml+='<td   valign="top" align="center">';
				tHtml+=jcl.code.get("tms.rule.disposal", alertlist[i]["DISPOSAL"]);
				tHtml+='</td>';
				tHtml+='</tr>';
			}		
			$('#alertlist').html(tHtml);

		} else {
			$('#dataForm1').hide();
		}
	});
	
	$('#backBtn').click(function(){
		jcl.go('/tms/monitor/alarm/get_transactiontrafficlist');
	});
});
</script>

</head>
  <body>
	  <div name="dataForm" id="dataForm">
	  	
	  </div>
	  <div name="dataForm1" id="dataForm1">
	
			<table width="100%"   id="conftab" border="1" style="border-collapse: collapse;">
				<tr style="font-weight: bold;font-size: 15px">
					<td width="20%" valign="top"  align="center">
						#springMessage("view.tms.monitor.center.alarm.alertid")
					</td>
					<td width="25%" valign="top" align="center">
						#springMessage("view.tms.monitor.center.alarm.hitrulenum")
					</td>
					<td width="25%" valign="top" align="center">
						#springMessage("view.tms.monitor.center.alarm.trigrulenum")
					</td>
					<td width="10%" valign="top"   align="center">
						#springMessage("view.tms.monitor.center.alarm.risklevel")
					</td>
					<td width="10%" valign="top" align="center">
						#springMessage("view.tms.monitor.center.alarm.score")
					</td>
					<td width="10%" valign="top"   align="center">
						#springMessage("view.tms.monitor.center.alarm.disposal")
					</td>
				</tr>
				<tbody id="alertlist">
					
				</tbody>
				
			</table>	  
	  </div>
	  <div class="button-box">
		<input type="button" value="#springMessage("view.tms.pub.btn.banck")" class="btn" id="backBtn"/>
	  </div>
  </body>
</html>
